<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Test on one or two mean vectors | Multivariate and Categorical Statistics</title>
  <meta name="description" content="This is a book meant to me read along side the book Multivariate Methods." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Test on one or two mean vectors | Multivariate and Categorical Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book meant to me read along side the book Multivariate Methods." />
  <meta name="github-repo" content="https://github.com/C1587S/EMV-ejercicios" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Test on one or two mean vectors | Multivariate and Categorical Statistics" />
  
  <meta name="twitter:description" content="This is a book meant to me read along side the book Multivariate Methods." />
  

<meta name="author" content="Daniela Pinto Veizaga &amp; Sebastián Cadavid Sánchez" />


<meta name="date" content="2020-04-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="methods.html"/>
<link rel="next" href="chapter6.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Multivariate and Categorical Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>3</b> Literature</a></li>
<li class="chapter" data-level="4" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>4</b> Methods</a></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Test on one or two mean vectors</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#multivariate-versus-univariate-tests"><i class="fa fa-check"></i><b>5.1</b> Multivariate Versus Univariate Tests</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#test-on-mu-with-sigma-known"><i class="fa fa-check"></i><b>5.2</b> Test on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\Sigma\)</span> Known</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="chapter5.html"><a href="chapter5.html#example-5.2.2"><i class="fa fa-check"></i><b>5.2.1</b> Example 5.2.2</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#tests-on-mu-when-sigma-is-unknown"><i class="fa fa-check"></i><b>5.3</b> Tests on <span class="math inline">\(\mu\)</span> when <span class="math inline">\(\Sigma\)</span> is unknown</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter5.html"><a href="chapter5.html#example-5.3.2."><i class="fa fa-check"></i><b>5.3.1</b> Example 5.3.2.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#comparing-two-mean-vectors"><i class="fa fa-check"></i><b>5.4</b> Comparing two mean vectors</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chapter5.html"><a href="chapter5.html#example-5.4.2"><i class="fa fa-check"></i><b>5.4.1</b> Example 5.4.2</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#tests-on-individual-variables-conditional-on-rejection-of-h_0-by-the-t2-test."><i class="fa fa-check"></i><b>5.5</b> Tests on individual variables conditional on rejection of <span class="math inline">\(H_{0}\)</span> by the <span class="math inline">\(T^2\)</span>-test.</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chapter5.html"><a href="chapter5.html#example-5.5"><i class="fa fa-check"></i><b>5.5.1</b> Example 5.5</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#computation-of-t2"><i class="fa fa-check"></i><b>5.6</b> Computation of <span class="math inline">\(T^2\)</span></a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chapter5.html"><a href="chapter5.html#example-5.6.2"><i class="fa fa-check"></i><b>5.6.1</b> Example: 5.6.2</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#paired-observation-test"><i class="fa fa-check"></i><b>5.7</b> Paired Observation Test</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="chapter5.html"><a href="chapter5.html#example-5.7.2"><i class="fa fa-check"></i><b>5.7.1</b> Example 5.7.2</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="chapter5.html"><a href="chapter5.html#test-for-aditional-information"><i class="fa fa-check"></i><b>5.8</b> Test for Aditional Information</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="chapter5.html"><a href="chapter5.html#example-5.8"><i class="fa fa-check"></i><b>5.8.1</b> Example 5.8</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="chapter5.html"><a href="chapter5.html#profile-analysis"><i class="fa fa-check"></i><b>5.9</b> Profile Analysis</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="chapter5.html"><a href="chapter5.html#example-5.9.2"><i class="fa fa-check"></i><b>5.9.1</b> Example 5.9.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> Multivariate Analysis of Variance Vectors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#one-way-models"><i class="fa fa-check"></i><b>6.1</b> One Way Models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter6.html"><a href="chapter6.html#example-6.1.7"><i class="fa fa-check"></i><b>6.1.1</b> Example 6.1.7</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter6.html"><a href="chapter6.html#example-6.1.8"><i class="fa fa-check"></i><b>6.1.2</b> Example 6.1.8</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#comparison-of-the-four-manova-test-statistics-comparison-ot-the-four-manova-test-statistics"><i class="fa fa-check"></i><b>6.2</b> Comparison of the four MANOVA test statistics comparison ot the four MANOVA test statistics</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="chapter6.html"><a href="chapter6.html#example-6.2"><i class="fa fa-check"></i><b>6.2.1</b> Example 6.2</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#constrasts"><i class="fa fa-check"></i><b>6.3</b> Constrasts</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter6.html"><a href="chapter6.html#example-6.3.2"><i class="fa fa-check"></i><b>6.3.1</b> Example 6.3.2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#tests-on-individual-variables-following-rejection-of-h_0-by-the-overall-manova-test"><i class="fa fa-check"></i><b>6.4</b> Tests on individual variables following rejection of <span class="math inline">\(H_0\)</span> by the overall MANOVA test</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="chapter6.html"><a href="chapter6.html#example-6.4"><i class="fa fa-check"></i><b>6.4.1</b> Example 6.4</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="chapter6.html"><a href="chapter6.html#two-way-classification"><i class="fa fa-check"></i><b>6.5</b> Two-way Classification</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="chapter6.html"><a href="chapter6.html#example-6.5.2"><i class="fa fa-check"></i><b>6.5.1</b> Example 6.5.2</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="chapter6.html"><a href="chapter6.html#other-models"><i class="fa fa-check"></i><b>6.6</b> Other Models</a></li>
<li class="chapter" data-level="6.7" data-path="chapter6.html"><a href="chapter6.html#checking-on-assumptions"><i class="fa fa-check"></i><b>6.7</b> Checking on Assumptions</a></li>
<li class="chapter" data-level="6.8" data-path="chapter6.html"><a href="chapter6.html#profile-analysis-1"><i class="fa fa-check"></i><b>6.8</b> Profile Analysis</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="chapter6.html"><a href="chapter6.html#example-6.8"><i class="fa fa-check"></i><b>6.8.1</b> Example 6.8</a></li>
<li class="chapter" data-level="6.8.2" data-path="chapter6.html"><a href="chapter6.html#example-6.9.2"><i class="fa fa-check"></i><b>6.8.2</b> Example 6.9.2</a></li>
<li class="chapter" data-level="6.8.3" data-path="chapter6.html"><a href="chapter6.html#example-6.9.5"><i class="fa fa-check"></i><b>6.8.3</b> Example 6.9.5</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="chapter6.html"><a href="chapter6.html#growth-curves"><i class="fa fa-check"></i><b>6.9</b> Growth Curves</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="chapter6.html"><a href="chapter6.html#example-6.10.1"><i class="fa fa-check"></i><b>6.9.1</b> Example 6.10.1</a></li>
<li class="chapter" data-level="6.9.2" data-path="chapter6.html"><a href="chapter6.html#example-6.10.2"><i class="fa fa-check"></i><b>6.9.2</b> Example 6.10.2</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="chapter6.html"><a href="chapter6.html#tests-on-a-subvector"><i class="fa fa-check"></i><b>6.10</b> Tests on a Subvector</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="chapter6.html"><a href="chapter6.html#example-6.11.1"><i class="fa fa-check"></i><b>6.10.1</b> Example 6.11.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> Tests in covariance matrices</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#testing-a-specified-pattern-for-sigma"><i class="fa fa-check"></i><b>7.2</b> Testing a specified pattern for <span class="math inline">\(\Sigma\)</span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="chapter7.html"><a href="chapter7.html#example-7.2.2"><i class="fa fa-check"></i><b>7.2.1</b> Example 7.2.2</a></li>
<li class="chapter" data-level="7.2.2" data-path="chapter7.html"><a href="chapter7.html#example-7.2.3"><i class="fa fa-check"></i><b>7.2.2</b> Example 7.2.3</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#tests-comparing-covariance-matrices"><i class="fa fa-check"></i><b>7.3</b> Tests comparing covariance matrices</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chapter7.html"><a href="chapter7.html#example-7.3.2"><i class="fa fa-check"></i><b>7.3.1</b> Example 7.3.2</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#tests-of-independence"><i class="fa fa-check"></i><b>7.4</b> Tests of independence</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="chapter7.html"><a href="chapter7.html#example-7.4.1"><i class="fa fa-check"></i><b>7.4.1</b> Example 7.4.1</a></li>
<li class="chapter" data-level="7.4.2" data-path="chapter7.html"><a href="chapter7.html#example-7.4.2"><i class="fa fa-check"></i><b>7.4.2</b> Example 7.4.2</a></li>
<li class="chapter" data-level="7.4.3" data-path="chapter7.html"><a href="chapter7.html#example-7.4.3"><i class="fa fa-check"></i><b>7.4.3</b> Example 7.4.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> Discriminant Analysis: description of group separation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#discriminant-function-for-two-vectors"><i class="fa fa-check"></i><b>8.2</b> Discriminant Function for Two Vectors</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="chapter8.html"><a href="chapter8.html#example-8.2"><i class="fa fa-check"></i><b>8.2.1</b> Example 8.2</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#relantionship-between-two-group-discriminant-analysis-and-multiple-regression"><i class="fa fa-check"></i><b>8.3</b> Relantionship Between Two Group Discriminant Analysis and Multiple Regression</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chapter8.html"><a href="chapter8.html#example-8.3."><i class="fa fa-check"></i><b>8.3.1</b> Example 8.3.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chapter8.html"><a href="chapter8.html#discriminant-analysis-for-several-groups"><i class="fa fa-check"></i><b>8.4</b> Discriminant Analysis For Several Groups</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="chapter8.html"><a href="chapter8.html#example-8.4.1."><i class="fa fa-check"></i><b>8.4.1</b> Example 8.4.1.</a></li>
<li class="chapter" data-level="8.4.2" data-path="chapter8.html"><a href="chapter8.html#example-8.4.2."><i class="fa fa-check"></i><b>8.4.2</b> Example 8.4.2.</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="chapter8.html"><a href="chapter8.html#standarized-discriminant-functions"><i class="fa fa-check"></i><b>8.5</b> Standarized Discriminant Functions</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="chapter8.html"><a href="chapter8.html#example-8.5."><i class="fa fa-check"></i><b>8.5.1</b> Example 8.5.</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="chapter8.html"><a href="chapter8.html#test-of-significance"><i class="fa fa-check"></i><b>8.6</b> Test of Significance</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="chapter8.html"><a href="chapter8.html#example-8.6.2"><i class="fa fa-check"></i><b>8.6.1</b> Example 8.6.2</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="chapter8.html"><a href="chapter8.html#interpretation-of-discriminant-functions"><i class="fa fa-check"></i><b>8.7</b> Interpretation of Discriminant Functions</a></li>
<li class="chapter" data-level="8.8" data-path="chapter8.html"><a href="chapter8.html#scatter-plots"><i class="fa fa-check"></i><b>8.8</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="chapter8.html"><a href="chapter8.html#example-8.8."><i class="fa fa-check"></i><b>8.8.1</b> Example 8.8.</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="chapter8.html"><a href="chapter8.html#stepwise-selection-of-variables"><i class="fa fa-check"></i><b>8.9</b> Stepwise Selection of Variables</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="chapter8.html"><a href="chapter8.html#example-8.9."><i class="fa fa-check"></i><b>8.9.1</b> Example 8.9.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> Classification Analysis: Allocation of Observartion Groups</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#introduction-2"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#classification-into-two-groups"><i class="fa fa-check"></i><b>9.2</b> Classification into Two Groups</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter9.html"><a href="chapter9.html#example-9.2."><i class="fa fa-check"></i><b>9.2.1</b> Example 9.2.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#classification-into-several-groups"><i class="fa fa-check"></i><b>9.3</b> Classification into Several Groups</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter9.html"><a href="chapter9.html#example-9.3"><i class="fa fa-check"></i><b>9.3.1</b> Example 9.3</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#estimating-misclassification-rates"><i class="fa fa-check"></i><b>9.4</b> Estimating Misclassification Rates</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter9.html"><a href="chapter9.html#example-9.4.a."><i class="fa fa-check"></i><b>9.4.1</b> Example <span class="math inline">\(9.4.(a).\)</span></a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter9.html"><a href="chapter9.html#example-9.4.b"><i class="fa fa-check"></i><b>9.4.2</b> Example <span class="math inline">\(9.4.(b)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="chapter9.html"><a href="chapter9.html#improved-estimates-of-error-rates"><i class="fa fa-check"></i><b>9.5</b> Improved Estimates of Error Rates</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="chapter9.html"><a href="chapter9.html#example-9.5.2"><i class="fa fa-check"></i><b>9.5.1</b> Example <span class="math inline">\(9.5.2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="chapter9.html"><a href="chapter9.html#subset-selection"><i class="fa fa-check"></i><b>9.6</b> Subset Selection</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="chapter9.html"><a href="chapter9.html#example-9.6.a."><i class="fa fa-check"></i><b>9.6.1</b> Example 9.6.(a).</a></li>
<li class="chapter" data-level="9.6.2" data-path="chapter9.html"><a href="chapter9.html#example-9.6.b."><i class="fa fa-check"></i><b>9.6.2</b> Example 9.6.(b).</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="chapter9.html"><a href="chapter9.html#nonparametric-procedures"><i class="fa fa-check"></i><b>9.7</b> Nonparametric Procedures</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="chapter9.html"><a href="chapter9.html#example-9.7.2."><i class="fa fa-check"></i><b>9.7.1</b> Example 9.7.2.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter11.html"><a href="chapter11.html"><i class="fa fa-check"></i><b>10</b> Canonical Correlation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter11.html"><a href="chapter11.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="chapter11.html"><a href="chapter11.html#canonical-correlations-and-canonical-variates"><i class="fa fa-check"></i><b>10.2</b> Canonical Correlations and Canonical Variates</a></li>
<li class="chapter" data-level="10.3" data-path="chapter11.html"><a href="chapter11.html#properties-of-canonical-correlations"><i class="fa fa-check"></i><b>10.3</b> Properties of Canonical Correlations</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="chapter11.html"><a href="chapter11.html#example-11.3"><i class="fa fa-check"></i><b>10.3.1</b> Example 11.3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="chapter11.html"><a href="chapter11.html#tests-of-significance"><i class="fa fa-check"></i><b>10.4</b> Tests of Significance</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="chapter11.html"><a href="chapter11.html#example-11.4.1."><i class="fa fa-check"></i><b>10.4.1</b> Example 11.4.1.</a></li>
<li class="chapter" data-level="10.4.2" data-path="chapter11.html"><a href="chapter11.html#example-11.4.2."><i class="fa fa-check"></i><b>10.4.2</b> Example 11.4.2.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chapter11.html"><a href="chapter11.html#interpretation"><i class="fa fa-check"></i><b>10.5</b> Interpretation</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chapter11.html"><a href="chapter11.html#example-11.5.1."><i class="fa fa-check"></i><b>10.5.1</b> Example 11.5.1.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="chapter11.html"><a href="chapter11.html#relationships-of-canonical-correlation-analysis-to-other-multivariate-techniques"><i class="fa fa-check"></i><b>10.6</b> Relationships of Canonical Correlation Analysis to Other Multivariate Techniques</a></li>
<li class="chapter" data-level="10.7" data-path="chapter11.html"><a href="chapter11.html#references"><i class="fa fa-check"></i><b>10.7</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate and Categorical Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter5" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Test on one or two mean vectors</h1>
<div id="multivariate-versus-univariate-tests" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Multivariate Versus Univariate Tests</h2>
</div>
<div id="test-on-mu-with-sigma-known" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Test on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\Sigma\)</span> Known</h2>
<p><strong>Multivariate Test for <span class="math inline">\(H_{0}:\mu=\mu_{0}\)</span> with <span class="math inline">\(\Sigma\)</span> known</strong></p>
<p>Test on One or Two Mean Vectors</p>
<p><em>Why we prefer to do multivariate testing?</em></p>
<ul>
<li><p>The use of p univariate tests inflates the Type I error rate, a, whereas the multivariate test preserves the exact a level. For example, if we do p = 10 separate univariate tests at the .05 level, the probability of at least one false rejection is greater than .05. If the variables were independent (they rarely are), we would have (under Ho)</p></li>
<li><p>The univariate tests completely ignore the correlations among the variables, whereas the multivariate tests make direct use of the correlations.</p></li>
<li><p>The multivariate test is more powerful in many cases. The power of a test is the probability of rejecting HQ when it is false. In some cases, all p of the univariate tests fail to reach significance, but the multivariate test is significant because small effects on some of the variables combine to jointly indicate significance. However, for a given sample size, there is a limit to the number of variables a multivariate test can handle without losing power. This is discussed further in Section 5.3.2.</p></li>
<li><p>Many multivariate tests involving means have as a by-product the construction of a linear combination of variables that reveals more about how the variables unite to reject the hypothesis.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter5.html#cb3-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<p><span class="math display">\[
H_{0}:\left(\begin{array}{c}
\mu_{1}\\
\mu_{2}\\
\vdots\\
\mu_{p}
\end{array}\right)=\left(\begin{array}{c}
\mu_{01}\\
\mu_{02}\\
\vdots\\
\mu_{0p}
\end{array}\right),\qquad H_{0}:\left(\begin{array}{c}
\mu_{1}\\
\mu_{2}\\
\vdots\\
\mu_{p}
\end{array}\right)\neq\left(\begin{array}{c}
\mu_{01}\\
\mu_{02}\\
\vdots\\
\mu_{0p}
\end{array}\right)
\]</span>
To test <span class="math inline">\(H_{0}\)</span>, we use a random sample of n observation vectors <span class="math inline">\(y_{1}, y_{2}, ...,y_{n}\)</span> from <span class="math inline">\(Ν_{p}(\mu, \Sigma)\)</span>, with <span class="math inline">\(\Sigma\)</span> known, and calculate <span class="math inline">\(\bar{y}=\sum_{i=1}^{n}y_{i}/n\)</span>. The test statistic is:</p>
<p><span class="math display">\[
Z^{2}=n\left(\bar{y}-\mu_{0}\right)^{&#39;}\Sigma^{-1}\left(\bar{y}-\mu_{0}\right)
\]</span></p>
<p>If <span class="math inline">\(H_{0}\)</span> is true, <span class="math inline">\(Z\)</span> is distributed as <span class="math inline">\(\chi_{p}^{2}\)</span>, and we therefore reject <span class="math inline">\(H_{0}\)</span> if <span class="math inline">\(Z &gt;\chi_{\alpha}^{2}\)</span>.</p>
<div id="example-5.2.2" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Example 5.2.2</h3>
<p>In Table 3.1, height and weight were given for a sample of 20 colleage males. Let us assume that this sample originated from the bivariate normal <span class="math inline">\(N_{2}\left(\mu,\Sigma\right)\)</span> where</p>
<p><span class="math display">\[
\Sigma=\left(\begin{array}{cc}
20 &amp; 100\\
100 &amp; 1000
\end{array}\right)
\]</span></p>
<p>Suppose we wish to test <span class="math inline">\(H_{0}: \mu = (70, 170)&#39;\)</span>.</p>
<p>Recovering dataset from table 3.1.: 20 college-age males, data for weight and height anc computing <span class="math inline">\(\mu_{0}\)</span> and <span class="math inline">\(\Sigma\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="chapter5.html#cb4-1"></a>height &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">69</span>, <span class="dv">74</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">72</span>, <span class="dv">67</span>, <span class="dv">66</span>, <span class="dv">70</span>, <span class="dv">76</span>, <span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">79</span>, <span class="dv">74</span>, <span class="dv">67</span>, <span class="dv">66</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">75</span>, <span class="dv">75</span>, <span class="dv">76</span>) </span>
<span id="cb4-2"><a href="chapter5.html#cb4-2"></a>weight &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">153</span>, <span class="dv">175</span>, <span class="dv">155</span>, <span class="dv">135</span>, <span class="dv">172</span>, <span class="dv">150</span>, <span class="dv">115</span>, <span class="dv">137</span>, <span class="dv">200</span>, <span class="dv">130</span>, <span class="dv">140</span>, <span class="dv">265</span>, <span class="dv">185</span>, <span class="dv">112</span>, <span class="dv">140</span>, <span class="dv">150</span>, <span class="dv">165</span>, <span class="dv">185</span>, <span class="dv">210</span>, <span class="dv">220</span>)</span>
<span id="cb4-3"><a href="chapter5.html#cb4-3"></a></span>
<span id="cb4-4"><a href="chapter5.html#cb4-4"></a>data522 &lt;-<span class="st"> </span><span class="kw">cbind</span>(height, weight) <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame </span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapter5.html#cb5-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb5-2"><a href="chapter5.html#cb5-2"></a>  data522, <span class="dt">caption =</span> <span class="st">&#39;Colleage Males, Exercise 5.22&#39;</span>,</span>
<span id="cb5-3"><a href="chapter5.html#cb5-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb5-4"><a href="chapter5.html#cb5-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-3">Table 5.1: </span>Colleage Males, Exercise 5.22</caption>
<thead>
<tr class="header">
<th align="right">height</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">69</td>
<td align="right">153</td>
</tr>
<tr class="even">
<td align="right">74</td>
<td align="right">175</td>
</tr>
<tr class="odd">
<td align="right">68</td>
<td align="right">155</td>
</tr>
<tr class="even">
<td align="right">70</td>
<td align="right">135</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">172</td>
</tr>
<tr class="even">
<td align="right">67</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">115</td>
</tr>
<tr class="even">
<td align="right">70</td>
<td align="right">137</td>
</tr>
<tr class="odd">
<td align="right">76</td>
<td align="right">200</td>
</tr>
<tr class="even">
<td align="right">68</td>
<td align="right">130</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">140</td>
</tr>
<tr class="even">
<td align="right">79</td>
<td align="right">265</td>
</tr>
<tr class="odd">
<td align="right">74</td>
<td align="right">185</td>
</tr>
<tr class="even">
<td align="right">67</td>
<td align="right">112</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">140</td>
</tr>
<tr class="even">
<td align="right">71</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="right">74</td>
<td align="right">165</td>
</tr>
<tr class="even">
<td align="right">75</td>
<td align="right">185</td>
</tr>
<tr class="odd">
<td align="right">75</td>
<td align="right">210</td>
</tr>
<tr class="even">
<td align="right">76</td>
<td align="right">220</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chapter5.html#cb6-1"></a><span class="co"># </span></span>
<span id="cb6-2"><a href="chapter5.html#cb6-2"></a>mu522 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">170</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="chapter5.html#cb6-3"></a>mu522</span></code></pre></div>
<pre><code>##      [,1]
## [1,]   70
## [2,]  170</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chapter5.html#cb8-1"></a>sigma522 &lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">1000</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb8-2"><a href="chapter5.html#cb8-2"></a>sigma522</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]   20  100
## [2,]  100 1000</code></pre>
<p><strong>Solution:</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapter5.html#cb10-1"></a>test_mu_sigKnown &lt;-<span class="st"> </span><span class="cf">function</span>(db, mu0, sigma, alpha){</span>
<span id="cb10-2"><a href="chapter5.html#cb10-2"></a>  <span class="st">&quot;</span></span>
<span id="cb10-3"><a href="chapter5.html#cb10-3"></a><span class="st">  This function computes $Z^{2}$ (eq. 5.2).</span></span>
<span id="cb10-4"><a href="chapter5.html#cb10-4"></a><span class="st">  Parameters:</span></span>
<span id="cb10-5"><a href="chapter5.html#cb10-5"></a><span class="st">  db: database containing columns of variables</span></span>
<span id="cb10-6"><a href="chapter5.html#cb10-6"></a><span class="st">  mu0: vector of means in H0</span></span>
<span id="cb10-7"><a href="chapter5.html#cb10-7"></a><span class="st">  sigma: known covariance matrix</span></span>
<span id="cb10-8"><a href="chapter5.html#cb10-8"></a><span class="st">  alpha: significance level</span></span>
<span id="cb10-9"><a href="chapter5.html#cb10-9"></a><span class="st">  &quot;</span></span>
<span id="cb10-10"><a href="chapter5.html#cb10-10"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(db) </span>
<span id="cb10-11"><a href="chapter5.html#cb10-11"></a>  p &lt;-<span class="st"> </span><span class="kw">ncol</span>(db)</span>
<span id="cb10-12"><a href="chapter5.html#cb10-12"></a>  y_hat &lt;&lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">apply</span>(db, <span class="dt">MARGIN=</span><span class="dv">2</span>, mean)) <span class="co"># sample mean for each column</span></span>
<span id="cb10-13"><a href="chapter5.html#cb10-13"></a>  Z2 &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">t</span>(y_hat <span class="op">-</span><span class="st"> </span>mu0) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(sigma)  <span class="op">%*%</span><span class="st"> </span>(y_hat <span class="op">-</span><span class="st"> </span>mu0)</span>
<span id="cb10-14"><a href="chapter5.html#cb10-14"></a>  <span class="co"># performing the test</span></span>
<span id="cb10-15"><a href="chapter5.html#cb10-15"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Z2 value:&quot;</span>, <span class="kw">round</span>(Z2, <span class="dv">5</span>), <span class="dt">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb10-16"><a href="chapter5.html#cb10-16"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;chi2:&quot;</span>, <span class="kw">round</span>(<span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">df=</span>p), <span class="dv">5</span>) , <span class="st">&quot;with p =&quot;</span>, p, <span class="st">&quot;degrees of freedom&quot;</span>, <span class="dt">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb10-17"><a href="chapter5.html#cb10-17"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;reject H0:&quot;</span>, Z2 <span class="op">&gt;</span><span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">df=</span>p)))</span>
<span id="cb10-18"><a href="chapter5.html#cb10-18"></a>  </span>
<span id="cb10-19"><a href="chapter5.html#cb10-19"></a>}</span></code></pre></div>
<p>using <span class="math inline">\(\alpha=0.05\)</span>, and knowing <span class="math inline">\(p=2\)</span> (because we have two variables height and weight), then we have <span class="math inline">\(\chi_{\alpha, p}^{2}\)</span>. Now we can compute the test:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="chapter5.html#cb11-1"></a><span class="kw">test_mu_sigKnown</span>(<span class="dt">db=</span>data522, <span class="dt">mu0 =</span> mu522, <span class="dt">sigma =</span> sigma522, <span class="dt">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Z2 value: 8.4026&quot;
## [1] &quot;chi2: 5.99146 with p = 2 degrees of freedom&quot;
## [1] &quot;reject H0: TRUE&quot;</code></pre>
</div>
</div>
<div id="tests-on-mu-when-sigma-is-unknown" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Tests on <span class="math inline">\(\mu\)</span> when <span class="math inline">\(\Sigma\)</span> is unknown</h2>
<div id="example-5.3.2." class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Example 5.3.2.</h3>
<p>In table 3.3 we have <span class="math inline">\(n=10\)</span> observations on <span class="math inline">\(p=3\)</span> variables. Desirable leves for <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span> are <span class="math inline">\(15\)</span> and <span class="math inline">\(6\)</span>, respectively, and the expected level of <span class="math inline">\(y_3\)</span> is <span class="math inline">\(2.85\)</span>. We can, therefore, test the hyphotesis</p>
<p><span class="math display">\[H_0: \mu=\begin{pmatrix}
15\\
6\\
2.85
\end{pmatrix}\]</span></p>
<p>Database from table 3.3</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter5.html#cb13-1"></a>y_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="dv">35</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">20</span>, <span class="dv">35</span>, <span class="dv">35</span>, <span class="dv">35</span>, <span class="dv">30</span>)</span>
<span id="cb13-2"><a href="chapter5.html#cb13-2"></a>y_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="fl">4.9</span>, <span class="fl">3.5</span>, <span class="dv">30</span>, <span class="fl">2.8</span>, <span class="fl">2.7</span>, <span class="fl">2.8</span>, <span class="fl">4.6</span>, <span class="fl">10.9</span>, <span class="dv">8</span>, <span class="fl">1.6</span>)</span>
<span id="cb13-3"><a href="chapter5.html#cb13-3"></a>y_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="fl">2.7</span>, <span class="fl">2.8</span>, <span class="fl">4.38</span>, <span class="fl">3.21</span>, <span class="fl">2.73</span>, <span class="fl">2.81</span>, <span class="fl">2.88</span>, <span class="fl">2.9</span>, <span class="fl">3.28</span>, <span class="fl">3.2</span>)</span>
<span id="cb13-4"><a href="chapter5.html#cb13-4"></a></span>
<span id="cb13-5"><a href="chapter5.html#cb13-5"></a>data532 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">cbind</span>(y_<span class="dv">1</span>, y_<span class="dv">2</span>, y_<span class="dv">3</span>))</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter5.html#cb14-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb14-2"><a href="chapter5.html#cb14-2"></a>  data532, <span class="dt">caption =</span> <span class="st">&#39;Data Exercise 5.32&#39;</span>,</span>
<span id="cb14-3"><a href="chapter5.html#cb14-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb14-4"><a href="chapter5.html#cb14-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-8">Table 5.2: </span>Data Exercise 5.32</caption>
<thead>
<tr class="header">
<th align="right">y_1</th>
<th align="right">y_2</th>
<th align="right">y_3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">35</td>
<td align="right">4.9</td>
<td align="right">2.70</td>
</tr>
<tr class="even">
<td align="right">35</td>
<td align="right">3.5</td>
<td align="right">2.80</td>
</tr>
<tr class="odd">
<td align="right">40</td>
<td align="right">30.0</td>
<td align="right">4.38</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">2.8</td>
<td align="right">3.21</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">2.7</td>
<td align="right">2.73</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">2.8</td>
<td align="right">2.81</td>
</tr>
<tr class="odd">
<td align="right">35</td>
<td align="right">4.6</td>
<td align="right">2.88</td>
</tr>
<tr class="even">
<td align="right">35</td>
<td align="right">10.9</td>
<td align="right">2.90</td>
</tr>
<tr class="odd">
<td align="right">35</td>
<td align="right">8.0</td>
<td align="right">3.28</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">1.6</td>
<td align="right">3.20</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="chapter5.html#cb15-1"></a><span class="co">#mu0</span></span>
<span id="cb15-2"><a href="chapter5.html#cb15-2"></a>mu532 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">15.0</span>, <span class="fl">6.0</span>, <span class="fl">2.85</span>), <span class="dt">nrow =</span> <span class="dv">3</span>, <span class="dt">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb15-3"><a href="chapter5.html#cb15-3"></a>mu532</span></code></pre></div>
<pre><code>##       [,1]
## [1,] 15.00
## [2,]  6.00
## [3,]  2.85</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapter5.html#cb17-1"></a>db &lt;-<span class="st"> </span>data532</span>
<span id="cb17-2"><a href="chapter5.html#cb17-2"></a>mu0 &lt;-<span class="st"> </span>mu532</span>
<span id="cb17-3"><a href="chapter5.html#cb17-3"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(db) </span>
<span id="cb17-4"><a href="chapter5.html#cb17-4"></a>  v &lt;-<span class="st"> </span>n<span class="dv">-1</span></span>
<span id="cb17-5"><a href="chapter5.html#cb17-5"></a>  p &lt;-<span class="st"> </span><span class="kw">ncol</span>(db)</span>
<span id="cb17-6"><a href="chapter5.html#cb17-6"></a>  y_hat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">apply</span>(db, <span class="dt">MARGIN=</span><span class="dv">2</span>, mean)) <span class="co"># sample mean for each column</span></span>
<span id="cb17-7"><a href="chapter5.html#cb17-7"></a>  S &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">cov</span>(db))</span>
<span id="cb17-8"><a href="chapter5.html#cb17-8"></a>S</span></code></pre></div>
<pre><code>##            y_1       y_2       y_3
## y_1 140.544444 49.680000 1.9412222
## y_2  49.680000 72.248444 3.6760889
## y_3   1.941222  3.676089 0.2501211</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter5.html#cb19-1"></a>y_hat</span></code></pre></div>
<pre><code>##       [,1]
## y_1 28.100
## y_2  7.180
## y_3  3.089</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter5.html#cb21-1"></a>T2 &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">t</span>(y_hat <span class="op">-</span><span class="st"> </span>mu0) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(S)  <span class="op">%*%</span><span class="st"> </span>(y_hat <span class="op">-</span><span class="st"> </span>mu0)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter5.html#cb22-1"></a>test_mu_sigUnknown &lt;-<span class="st"> </span><span class="cf">function</span>(db, mu0, alpha){</span>
<span id="cb22-2"><a href="chapter5.html#cb22-2"></a>  <span class="kw">library</span>(ICSNP)</span>
<span id="cb22-3"><a href="chapter5.html#cb22-3"></a>  <span class="st">&quot;</span></span>
<span id="cb22-4"><a href="chapter5.html#cb22-4"></a><span class="st">  This function computes $Z^{2}$ (eq. 5.5).</span></span>
<span id="cb22-5"><a href="chapter5.html#cb22-5"></a><span class="st">  Parameters:</span></span>
<span id="cb22-6"><a href="chapter5.html#cb22-6"></a><span class="st">  * db: database containing columns of variables</span></span>
<span id="cb22-7"><a href="chapter5.html#cb22-7"></a><span class="st">  * mu0: vector of means in H0</span></span>
<span id="cb22-8"><a href="chapter5.html#cb22-8"></a><span class="st">  * alpha: significance level</span></span>
<span id="cb22-9"><a href="chapter5.html#cb22-9"></a><span class="st">  &quot;</span></span>
<span id="cb22-10"><a href="chapter5.html#cb22-10"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(db) </span>
<span id="cb22-11"><a href="chapter5.html#cb22-11"></a>  v &lt;-<span class="st"> </span>n<span class="dv">-1</span></span>
<span id="cb22-12"><a href="chapter5.html#cb22-12"></a>  p &lt;-<span class="st"> </span><span class="kw">ncol</span>(db)</span>
<span id="cb22-13"><a href="chapter5.html#cb22-13"></a>  y_hat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">apply</span>(db, <span class="dt">MARGIN=</span><span class="dv">2</span>, mean)) <span class="co"># sample mean for each column</span></span>
<span id="cb22-14"><a href="chapter5.html#cb22-14"></a>  S &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">cov</span>(db))</span>
<span id="cb22-15"><a href="chapter5.html#cb22-15"></a>  T2 &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">t</span>(y_hat <span class="op">-</span><span class="st"> </span>mu0) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(S)  <span class="op">%*%</span><span class="st"> </span>(y_hat <span class="op">-</span><span class="st"> </span>mu0)</span>
<span id="cb22-16"><a href="chapter5.html#cb22-16"></a>  T2_adj &lt;-<span class="st"> </span>T2<span class="op">*</span>(v<span class="op">-</span>p<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(v<span class="op">*</span>p)</span>
<span id="cb22-17"><a href="chapter5.html#cb22-17"></a>  <span class="co"># performing the test</span></span>
<span id="cb22-18"><a href="chapter5.html#cb22-18"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;T2 value:&quot;</span>, <span class="kw">round</span>(T2, <span class="dv">5</span>), <span class="dt">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb22-19"><a href="chapter5.html#cb22-19"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;T2 F-adjusted value:&quot;</span>, <span class="kw">round</span>(T2_adj, <span class="dv">5</span>), <span class="dt">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb22-20"><a href="chapter5.html#cb22-20"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;F-critial value:&quot;</span>, <span class="kw">round</span>(<span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">df1=</span>p, <span class="dt">df2=</span>v<span class="op">-</span>p<span class="op">+</span><span class="dv">1</span>), <span class="dv">5</span>) , <span class="st">&quot;with&quot;</span>, p,<span class="st">&quot;and&quot;</span>, v<span class="op">-</span>p<span class="op">+</span><span class="dv">1</span>, <span class="st">&quot; degrees of freedom&quot;</span>, <span class="dt">sep=</span><span class="st">&quot; &quot;</span>))</span>
<span id="cb22-21"><a href="chapter5.html#cb22-21"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;reject H0:&quot;</span>, T2_adj <span class="op">&gt;</span><span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">df1=</span>p, <span class="dt">df2=</span>v<span class="op">-</span>p<span class="op">+</span><span class="dv">1</span>)))</span>
<span id="cb22-22"><a href="chapter5.html#cb22-22"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;p-value:&quot;</span>, (<span class="kw">pf</span>(T2_adj,<span class="dt">df1=</span>p, <span class="dt">df2=</span>v<span class="op">-</span>p<span class="op">+</span><span class="dv">1</span>, <span class="dt">lower.tail =</span> F))))</span>
<span id="cb22-23"><a href="chapter5.html#cb22-23"></a>  <span class="kw">print</span>(<span class="st">&quot;***Comparing results using HotellingsT2 from ICSNP library - F Test***&quot;</span>)</span>
<span id="cb22-24"><a href="chapter5.html#cb22-24"></a>  <span class="kw">print</span>(<span class="kw">HotellingsT2</span>(db, <span class="dt">Y =</span> <span class="ot">NULL</span>, <span class="dt">mu =</span> mu0, <span class="dt">test =</span> <span class="st">&quot;f&quot;</span>))</span>
<span id="cb22-25"><a href="chapter5.html#cb22-25"></a>  <span class="kw">print</span>(<span class="st">&quot;***Comparing results using HotellingsT2 from ICSNP library - Chi Test***&quot;</span>)</span>
<span id="cb22-26"><a href="chapter5.html#cb22-26"></a>  <span class="kw">print</span>(<span class="kw">HotellingsT2</span>(db, <span class="dt">Y =</span> <span class="ot">NULL</span>, <span class="dt">mu =</span> mu0, <span class="dt">test =</span> <span class="st">&quot;chi&quot;</span>))</span>
<span id="cb22-27"><a href="chapter5.html#cb22-27"></a></span>
<span id="cb22-28"><a href="chapter5.html#cb22-28"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chapter5.html#cb23-1"></a><span class="kw">test_mu_sigUnknown</span>(<span class="dt">db=</span>data532, <span class="dt">mu0=</span>mu532, <span class="dt">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] &quot;T2 value: 24.55891&quot;
## [1] &quot;T2 F-adjusted value: 6.36712&quot;
## [1] &quot;F-critial value: 4.34683 with 3 and 7  degrees of freedom&quot;
## [1] &quot;reject H0: TRUE&quot;
## [1] &quot;p-value: 0.0206801514119681&quot;
## [1] &quot;***Comparing results using HotellingsT2 from ICSNP library - F Test***&quot;
## 
##  Hotelling&#39;s one sample T2-test
## 
## data:  db
## T.2 = 6.3671, df1 = 3, df2 = 7, p-value = 0.02068
## alternative hypothesis: true location is not equal to c(15,6,2.85)
## 
## [1] &quot;***Comparing results using HotellingsT2 from ICSNP library - Chi Test***&quot;
## 
##  Hotelling&#39;s one sample T2-test
## 
## data:  db
## T.2 = 24.559, df = 3, p-value = 1.909e-05
## alternative hypothesis: true location is not equal to c(15,6,2.85)</code></pre>
</div>
</div>
<div id="comparing-two-mean-vectors" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Comparing two mean vectors</h2>
<div id="example-5.4.2" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Example 5.4.2</h3>
<p>Four psychological test were given to <span class="math inline">\(32\)</span> men and <span class="math inline">\(32\)</span> women. The data are recorded in Table <span class="math inline">\(5.1\)</span> (Beall 1945). The variables are:</p>
<p><span class="math display">\[y_{1}=\text{pictorial inconsistencies}\]</span></p>
<p><span class="math display">\[y_{2}=\text{paper form board}\]</span></p>
<p><span class="math display">\[y_{3}=\text{tool recognition}\]</span></p>
<p><span class="math display">\[y_{4}= \text{vocabulary}\]</span></p>
<p>We wish to test:</p>
<p><span class="math display">\[H_{0}: \mu_{1}=\mu{2} \ \text{vs} \ H_{1}: \mu_{1} \neq \mu_{2}\]</span></p>
<p>We assume that the two samples are independent and that <span class="math inline">\(\Sigma_{1}=\Sigma_{2}=\Sigma\)</span>, say with unknown.
These assumptions are neccesary in order for <span class="math inline">\(T^{2}\)</span> statistic in (5.9) to have a <span class="math inline">\(T^2\)</span>-distribution.</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>First we load the data required</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter5.html#cb25-1"></a><span class="co">#pyschological data of males</span></span>
<span id="cb25-2"><a href="chapter5.html#cb25-2"></a></span>
<span id="cb25-3"><a href="chapter5.html#cb25-3"></a>y_1m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,   <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">17</span>, <span class="dv">19</span>)</span>
<span id="cb25-4"><a href="chapter5.html#cb25-4"></a></span>
<span id="cb25-5"><a href="chapter5.html#cb25-5"></a>y_2m &lt;-<span class="kw">c</span>(<span class="dv">15</span>,    <span class="dv">17</span>, <span class="dv">14</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="dv">21</span>, <span class="dv">13</span>, <span class="dv">5</span>,  <span class="dv">7</span>,  <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">19</span>, <span class="dv">18</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">19</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">19</span>)</span>
<span id="cb25-6"><a href="chapter5.html#cb25-6"></a></span>
<span id="cb25-7"><a href="chapter5.html#cb25-7"></a>y_3m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">32</span>,   <span class="dv">24</span>, <span class="dv">29</span>, <span class="dv">10</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">22</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">32</span>, <span class="dv">31</span>, <span class="dv">26</span>, <span class="dv">33</span>, <span class="dv">19</span>, <span class="dv">30</span>, <span class="dv">34</span>, <span class="dv">30</span>, <span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">23</span>, <span class="dv">34</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">21</span>, <span class="dv">30</span>)</span>
<span id="cb25-8"><a href="chapter5.html#cb25-8"></a></span>
<span id="cb25-9"><a href="chapter5.html#cb25-9"></a>y_4m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">26</span>,   <span class="dv">14</span>, <span class="dv">23</span>, <span class="dv">16</span>, <span class="dv">28</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">17</span>, <span class="dv">27</span>, <span class="dv">20</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">27</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">17</span>, <span class="dv">29</span>, <span class="dv">26</span>, <span class="dv">24</span>, <span class="dv">16</span>, <span class="dv">23</span>, <span class="dv">16</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">28</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter5.html#cb26-1"></a>data542_male &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb26-2"><a href="chapter5.html#cb26-2"></a>  y_1m, y_2m, y_3m, y_4m</span>
<span id="cb26-3"><a href="chapter5.html#cb26-3"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapter5.html#cb27-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb27-2"><a href="chapter5.html#cb27-2"></a>  data542_male, <span class="dt">caption =</span> <span class="st">&#39;Data Male, Exercise 5.42&#39;</span>,</span>
<span id="cb27-3"><a href="chapter5.html#cb27-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb27-4"><a href="chapter5.html#cb27-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-16">Table 5.3: </span>Data Male, Exercise 5.42</caption>
<thead>
<tr class="header">
<th align="right">y_1m</th>
<th align="right">y_2m</th>
<th align="right">y_3m</th>
<th align="right">y_4m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">17</td>
<td align="right">15</td>
<td align="right">32</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">17</td>
<td align="right">24</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">29</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">12</td>
<td align="right">10</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">17</td>
<td align="right">26</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">21</td>
<td align="right">26</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">13</td>
<td align="right">26</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">5</td>
<td align="right">22</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">7</td>
<td align="right">30</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">15</td>
<td align="right">30</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">17</td>
<td align="right">26</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">20</td>
<td align="right">28</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">15</td>
<td align="right">29</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">19</td>
<td align="right">32</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">18</td>
<td align="right">31</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">26</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">17</td>
<td align="right">33</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">14</td>
<td align="right">19</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">21</td>
<td align="right">30</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">21</td>
<td align="right">34</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">17</td>
<td align="right">30</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">15</td>
<td align="right">25</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">26</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">23</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">18</td>
<td align="right">34</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">15</td>
<td align="right">28</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">16</td>
<td align="right">29</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">19</td>
<td align="right">32</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">16</td>
<td align="right">33</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">20</td>
<td align="right">21</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">19</td>
<td align="right">30</td>
<td align="right">28</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapter5.html#cb28-1"></a><span class="co">#pyschological data of females</span></span>
<span id="cb28-2"><a href="chapter5.html#cb28-2"></a></span>
<span id="cb28-3"><a href="chapter5.html#cb28-3"></a>y_1f &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb28-4"><a href="chapter5.html#cb28-4"></a>  <span class="dv">14</span>,   <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">2</span>,  <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">7</span>,  <span class="dv">12</span>, <span class="dv">6</span></span>
<span id="cb28-5"><a href="chapter5.html#cb28-5"></a>  )</span>
<span id="cb28-6"><a href="chapter5.html#cb28-6"></a></span>
<span id="cb28-7"><a href="chapter5.html#cb28-7"></a></span>
<span id="cb28-8"><a href="chapter5.html#cb28-8"></a>y_2f &lt;-<span class="kw">c</span>(</span>
<span id="cb28-9"><a href="chapter5.html#cb28-9"></a>  <span class="dv">12</span>,   <span class="dv">14</span>, <span class="dv">19</span>, <span class="dv">13</span>, <span class="dv">20</span>, <span class="dv">9</span>,  <span class="dv">13</span>, <span class="dv">8</span>,  <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">10</span>, <span class="dv">16</span>, <span class="dv">8</span>,  <span class="dv">16</span>, <span class="dv">21</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">6</span>,  <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">7</span>,  <span class="dv">15</span>, <span class="dv">5</span></span>
<span id="cb28-10"><a href="chapter5.html#cb28-10"></a>  )</span>
<span id="cb28-11"><a href="chapter5.html#cb28-11"></a></span>
<span id="cb28-12"><a href="chapter5.html#cb28-12"></a>y_3f &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb28-13"><a href="chapter5.html#cb28-13"></a>  <span class="dv">14</span>,   <span class="dv">12</span>, <span class="dv">21</span>, <span class="dv">10</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">13</span>, <span class="dv">19</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">13</span>, <span class="dv">25</span>, <span class="dv">8</span>,  <span class="dv">13</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="dv">16</span>, <span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">12</span>, <span class="dv">24</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">7</span>,  <span class="dv">6</span></span>
<span id="cb28-14"><a href="chapter5.html#cb28-14"></a>  )</span>
<span id="cb28-15"><a href="chapter5.html#cb28-15"></a></span>
<span id="cb28-16"><a href="chapter5.html#cb28-16"></a>y_4f &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb28-17"><a href="chapter5.html#cb28-17"></a>  <span class="dv">26</span>,   <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">23</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">26</span>, <span class="dv">14</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">9</span>,  <span class="dv">23</span>, <span class="dv">20</span>, <span class="dv">28</span>, <span class="dv">18</span>, <span class="dv">28</span>, <span class="dv">13</span></span>
<span id="cb28-18"><a href="chapter5.html#cb28-18"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter5.html#cb29-1"></a>data542_female &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb29-2"><a href="chapter5.html#cb29-2"></a>  y_1f, y_2f, y_3f, y_4f</span>
<span id="cb29-3"><a href="chapter5.html#cb29-3"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter5.html#cb30-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb30-2"><a href="chapter5.html#cb30-2"></a>  data542_female, <span class="dt">caption =</span> <span class="st">&#39;Data Female, Exercise 5.42&#39;</span>,</span>
<span id="cb30-3"><a href="chapter5.html#cb30-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb30-4"><a href="chapter5.html#cb30-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-19">Table 5.4: </span>Data Female, Exercise 5.42</caption>
<thead>
<tr class="header">
<th align="right">y_1f</th>
<th align="right">y_2f</th>
<th align="right">y_3f</th>
<th align="right">y_4f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">14</td>
<td align="right">12</td>
<td align="right">14</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">14</td>
<td align="right">12</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">19</td>
<td align="right">21</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">13</td>
<td align="right">10</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">20</td>
<td align="right">16</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">9</td>
<td align="right">14</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">13</td>
<td align="right">18</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">8</td>
<td align="right">13</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">20</td>
<td align="right">19</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">10</td>
<td align="right">11</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">18</td>
<td align="right">25</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">18</td>
<td align="right">13</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">10</td>
<td align="right">25</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">8</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">8</td>
<td align="right">13</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">23</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">21</td>
<td align="right">26</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">17</td>
<td align="right">14</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">16</td>
<td align="right">15</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">23</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">16</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">16</td>
<td align="right">22</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">17</td>
<td align="right">22</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">16</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">20</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">17</td>
<td align="right">24</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">15</td>
<td align="right">18</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">16</td>
<td align="right">18</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">7</td>
<td align="right">19</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">15</td>
<td align="right">7</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<p>We can also visualize the data</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter5.html#cb31-1"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;plotly&quot;</span>)){</span>
<span id="cb31-2"><a href="chapter5.html#cb31-2"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;plotly&quot;</span>)</span>
<span id="cb31-3"><a href="chapter5.html#cb31-3"></a>    <span class="kw">library</span>(ICSNP)</span>
<span id="cb31-4"><a href="chapter5.html#cb31-4"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="chapter5.html#cb32-1"></a>f1 &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(data542_male,</span>
<span id="cb32-2"><a href="chapter5.html#cb32-2"></a>              <span class="dt">type =</span> <span class="st">&quot;box&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-3"><a href="chapter5.html#cb32-3"></a><span class="st">  </span><span class="kw">add_boxplot</span>(<span class="dt">y =</span> <span class="op">~</span>y_1m) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-4"><a href="chapter5.html#cb32-4"></a><span class="st">  </span><span class="kw">add_boxplot</span>(<span class="dt">y =</span> <span class="op">~</span>y_2m)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-5"><a href="chapter5.html#cb32-5"></a><span class="st">  </span><span class="kw">add_boxplot</span>(<span class="dt">y =</span> <span class="op">~</span>y_3m)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-6"><a href="chapter5.html#cb32-6"></a><span class="st">  </span><span class="kw">add_boxplot</span>(<span class="dt">y =</span> <span class="op">~</span>y_4m) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-7"><a href="chapter5.html#cb32-7"></a><span class="st">  </span><span class="kw">layout</span>(<span class="dt">title =</span> <span class="st">&quot;Male Psychological Scores By Each Variable&quot;</span>,</span>
<span id="cb32-8"><a href="chapter5.html#cb32-8"></a>         <span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Variables&quot;</span>),</span>
<span id="cb32-9"><a href="chapter5.html#cb32-9"></a>         <span class="dt">yaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Scores&quot;</span>))</span>
<span id="cb32-10"><a href="chapter5.html#cb32-10"></a>f1</span></code></pre></div>
<div id="htmlwidget-6421a3795ca6d393c585" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6421a3795ca6d393c585">{"x":{"visdat":{"fe7618e7f51":["function () ","plotlyVisDat"]},"cur_data":"fe7618e7f51","attrs":{"fe7618e7f51":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"},"fe7618e7f51.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"inherit":true},"fe7618e7f51.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"inherit":true},"fe7618e7f51.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"inherit":true},"fe7618e7f51.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Male Psychological Scores By Each Variable","xaxis":{"domain":[0,1],"automargin":true,"title":"Variables"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Scores"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"fillcolor":"rgba(31,119,180,0.5)","type":"box","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255,127,14,0.5)","type":"box","y":[17,15,15,13,20,15,15,13,14,17,17,17,15,18,18,15,18,10,18,18,13,16,11,16,16,18,16,15,18,18,17,19],"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(44,160,44,0.5)","type":"box","y":[15,17,14,12,17,21,13,5,7,15,17,20,15,19,18,14,17,14,21,21,17,16,15,13,13,18,15,16,19,16,20,19],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(214,39,40,0.5)","type":"box","y":[32,24,29,10,26,26,26,22,30,30,26,28,29,32,31,26,33,19,30,34,30,16,25,26,23,34,28,29,32,33,21,30],"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(148,103,189,0.5)","type":"box","y":[26,14,23,16,28,21,22,22,17,27,20,24,24,28,27,21,26,17,29,26,24,16,23,16,21,24,27,24,23,23,21,28],"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"line":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter5.html#cb33-1"></a>f2 &lt;-<span class="st"> </span><span class="kw">plot_ly</span>(data542_female,</span>
<span id="cb33-2"><a href="chapter5.html#cb33-2"></a>              <span class="dt">type =</span> <span class="st">&quot;box&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-3"><a href="chapter5.html#cb33-3"></a><span class="st">  </span><span class="kw">add_boxplot</span>(<span class="dt">y =</span> <span class="op">~</span>y_1f) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-4"><a href="chapter5.html#cb33-4"></a><span class="st">  </span><span class="kw">add_boxplot</span>(<span class="dt">y =</span> <span class="op">~</span>y_2f)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-5"><a href="chapter5.html#cb33-5"></a><span class="st">  </span><span class="kw">add_boxplot</span>(<span class="dt">y =</span> <span class="op">~</span>y_3f)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-6"><a href="chapter5.html#cb33-6"></a><span class="st">  </span><span class="kw">add_boxplot</span>(<span class="dt">y =</span> <span class="op">~</span>y_4f)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-7"><a href="chapter5.html#cb33-7"></a><span class="st">  </span><span class="kw">layout</span>(<span class="dt">title =</span> <span class="st">&quot;Female Psychological Scores By Each Variable&quot;</span>,</span>
<span id="cb33-8"><a href="chapter5.html#cb33-8"></a>         <span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Variables&quot;</span>),</span>
<span id="cb33-9"><a href="chapter5.html#cb33-9"></a>         <span class="dt">yaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Scores&quot;</span>))</span>
<span id="cb33-10"><a href="chapter5.html#cb33-10"></a>f2</span></code></pre></div>
<div id="htmlwidget-6c1160b4012fab777c82" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6c1160b4012fab777c82">{"x":{"visdat":{"fe75248d0e0":["function () ","plotlyVisDat"]},"cur_data":"fe75248d0e0","attrs":{"fe75248d0e0":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"},"fe75248d0e0.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"inherit":true},"fe75248d0e0.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"inherit":true},"fe75248d0e0.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"inherit":true},"fe75248d0e0.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","y":{},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Female Psychological Scores By Each Variable","xaxis":{"domain":[0,1],"automargin":true,"title":"Variables"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Scores"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"fillcolor":"rgba(31,119,180,0.5)","type":"box","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255,127,14,0.5)","type":"box","y":[14,13,12,12,11,12,10,10,12,11,12,14,14,13,14,13,16,14,16,13,2,14,17,16,15,12,14,13,11,7,12,6],"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(44,160,44,0.5)","type":"box","y":[12,14,19,13,20,9,13,8,20,10,18,18,10,16,8,16,21,17,16,16,6,16,17,13,14,10,17,15,16,7,15,5],"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(214,39,40,0.5)","type":"box","y":[14,12,21,10,16,14,18,13,19,11,25,13,25,8,13,23,26,14,15,23,16,22,22,16,20,12,24,18,18,19,7,6],"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(148,103,189,0.5)","type":"box","y":[26,21,21,16,16,18,24,23,23,27,25,26,28,14,25,28,26,14,23,24,21,26,28,14,26,9,23,20,28,18,28,13],"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"line":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<blockquote>
<ol start="2" style="list-style-type: decimal">
<li>We find the mean vectors and covariances matrices of the two samples.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapter5.html#cb34-1"></a><span class="co">#Determining the mean of each variable of the male population</span></span>
<span id="cb34-2"><a href="chapter5.html#cb34-2"></a>y_mean_male&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb34-3"><a href="chapter5.html#cb34-3"></a>  <span class="kw">apply</span>(</span>
<span id="cb34-4"><a href="chapter5.html#cb34-4"></a>    data542_male, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb34-5"><a href="chapter5.html#cb34-5"></a>    )</span>
<span id="cb34-6"><a href="chapter5.html#cb34-6"></a>  )</span>
<span id="cb34-7"><a href="chapter5.html#cb34-7"></a>y_mean_male</span></code></pre></div>
<pre><code>##          [,1]
## y_1m 15.96875
## y_2m 15.90625
## y_3m 27.18750
## y_4m 22.75000</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapter5.html#cb36-1"></a><span class="kw">dim</span>(y_mean_male)</span></code></pre></div>
<pre><code>## [1] 4 1</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chapter5.html#cb38-1"></a><span class="co">#Determining the mean of each variable of the female population</span></span>
<span id="cb38-2"><a href="chapter5.html#cb38-2"></a>y_mean_female&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb38-3"><a href="chapter5.html#cb38-3"></a>  <span class="kw">apply</span>(data542_female, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb38-4"><a href="chapter5.html#cb38-4"></a>        )</span>
<span id="cb38-5"><a href="chapter5.html#cb38-5"></a>  )</span>
<span id="cb38-6"><a href="chapter5.html#cb38-6"></a>y_mean_female</span></code></pre></div>
<pre><code>##          [,1]
## y_1f 12.34375
## y_2f 13.90625
## y_3f 16.65625
## y_4f 21.93750</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="chapter5.html#cb40-1"></a><span class="kw">dim</span>(y_mean_female)</span></code></pre></div>
<pre><code>## [1] 4 1</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chapter5.html#cb42-1"></a><span class="co">#Determining the covariance matrix of the male population</span></span>
<span id="cb42-2"><a href="chapter5.html#cb42-2"></a>sigma_male &lt;-<span class="st"> </span><span class="kw">cov</span>(data542_male)</span>
<span id="cb42-3"><a href="chapter5.html#cb42-3"></a>sigma_male</span></code></pre></div>
<pre><code>##          y_1m      y_2m      y_3m      y_4m
## y_1m 5.192540  4.545363  6.522177  5.250000
## y_2m 4.545363 13.184476  6.760081  6.266129
## y_3m 6.522177  6.760081 28.673387 14.467742
## y_4m 5.250000  6.266129 14.467742 16.645161</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="chapter5.html#cb44-1"></a><span class="co">#Determining the mean of each variable of the female population</span></span>
<span id="cb44-2"><a href="chapter5.html#cb44-2"></a>sigma_female &lt;-<span class="st"> </span><span class="kw">cov</span>(data542_female)</span>
<span id="cb44-3"><a href="chapter5.html#cb44-3"></a>sigma_female</span></code></pre></div>
<pre><code>##          y_1f      y_2f      y_3f      y_4f
## y_1f 9.136089  7.549395  4.863911  4.151210
## y_2f 7.549395 18.603831 10.224798  5.445565
## y_3f 4.863911 10.224798 30.039315 13.493952
## y_4f 4.151210  5.445565 13.493952 27.995968</code></pre>
<blockquote>
<ol start="3" style="list-style-type: decimal">
<li>We find the pooled covaricance matrix -an unbiased estimator of the common population covariance matrix, <span class="math inline">\(\Sigma\)</span>.</li>
</ol>
</blockquote>
<p><span class="math display">\[S_{pl}= \frac{1}{n_{1}+n_{2}-2}[(n_{1}-1)\textbf{S}_{1}+(n_{2}-1)\textbf{S}_{2}]\]</span></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chapter5.html#cb46-1"></a><span class="co">#function for finding the common population covariance matrix</span></span>
<span id="cb46-2"><a href="chapter5.html#cb46-2"></a></span>
<span id="cb46-3"><a href="chapter5.html#cb46-3"></a>common_population_variance &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2) {</span>
<span id="cb46-4"><a href="chapter5.html#cb46-4"></a>  <span class="st">&quot;</span></span>
<span id="cb46-5"><a href="chapter5.html#cb46-5"></a></span>
<span id="cb46-6"><a href="chapter5.html#cb46-6"></a><span class="st">  &quot;</span></span>
<span id="cb46-7"><a href="chapter5.html#cb46-7"></a>  n_<span class="dv">1</span>=<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb46-8"><a href="chapter5.html#cb46-8"></a>  n_<span class="dv">2</span>=<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb46-9"><a href="chapter5.html#cb46-9"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1)</span>
<span id="cb46-10"><a href="chapter5.html#cb46-10"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2)</span>
<span id="cb46-11"><a href="chapter5.html#cb46-11"></a></span>
<span id="cb46-12"><a href="chapter5.html#cb46-12"></a>  sigma_population&lt;-(<span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>))<span class="op">*</span>((n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span>)</span>
<span id="cb46-13"><a href="chapter5.html#cb46-13"></a>  <span class="kw">print</span>(<span class="st">&quot;The pooled covariance matrix is:&quot;</span>)</span>
<span id="cb46-14"><a href="chapter5.html#cb46-14"></a>  <span class="kw">print</span>(sigma_population)</span>
<span id="cb46-15"><a href="chapter5.html#cb46-15"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="chapter5.html#cb47-1"></a><span class="kw">common_population_variance</span>(data542_female, data542_male)</span></code></pre></div>
<pre><code>## [1] &quot;The pooled covariance matrix is:&quot;
##          y_1f      y_2f      y_3f      y_4f
## y_1f 7.164315  6.047379  5.693044  4.700605
## y_2f 6.047379 15.894153  8.492440  5.855847
## y_3f 5.693044  8.492440 29.356351 13.980847
## y_4f 4.700605  5.855847 13.980847 22.320565</code></pre>
<blockquote>
<ol start="4" style="list-style-type: decimal">
<li>Then, to test <span class="math display">\[H_{0}: \mu_{1}=\mu{2} \ \text{vs} \ H_{1}: \mu_{1} \neq \mu_{2}\]</span>, we find:</li>
</ol>
</blockquote>
<p><span class="math display">\[T^2= \frac{ n_{1}n_{2}}{n_{1}+n_{2}}(\bar{y}_{1}- \bar{y}_2)&#39; \textbf{S}_{pl}^{-1}(\bar{y}_{1}- \bar{y}_2)\]</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="chapter5.html#cb49-1"></a><span class="co">#function for finding the T^2 in a multivariate two sample setting</span></span>
<span id="cb49-2"><a href="chapter5.html#cb49-2"></a></span>
<span id="cb49-3"><a href="chapter5.html#cb49-3"></a>T2_two_sample&lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2) {</span>
<span id="cb49-4"><a href="chapter5.html#cb49-4"></a>  <span class="st">&quot;</span></span>
<span id="cb49-5"><a href="chapter5.html#cb49-5"></a></span>
<span id="cb49-6"><a href="chapter5.html#cb49-6"></a><span class="st">  &quot;</span></span>
<span id="cb49-7"><a href="chapter5.html#cb49-7"></a>  n_<span class="dv">1</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb49-8"><a href="chapter5.html#cb49-8"></a>  n_<span class="dv">2</span>&lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb49-9"><a href="chapter5.html#cb49-9"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1)</span>
<span id="cb49-10"><a href="chapter5.html#cb49-10"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2)</span>
<span id="cb49-11"><a href="chapter5.html#cb49-11"></a>  </span>
<span id="cb49-12"><a href="chapter5.html#cb49-12"></a>  y_mean_<span class="dv">1</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb49-13"><a href="chapter5.html#cb49-13"></a>  <span class="kw">apply</span>(data1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb49-14"><a href="chapter5.html#cb49-14"></a>        )</span>
<span id="cb49-15"><a href="chapter5.html#cb49-15"></a>  )</span>
<span id="cb49-16"><a href="chapter5.html#cb49-16"></a>  </span>
<span id="cb49-17"><a href="chapter5.html#cb49-17"></a>  y_mean_<span class="dv">2</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb49-18"><a href="chapter5.html#cb49-18"></a>  <span class="kw">apply</span>(data2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb49-19"><a href="chapter5.html#cb49-19"></a>        )</span>
<span id="cb49-20"><a href="chapter5.html#cb49-20"></a>  )</span>
<span id="cb49-21"><a href="chapter5.html#cb49-21"></a>  sigma_population&lt;-(</span>
<span id="cb49-22"><a href="chapter5.html#cb49-22"></a>    <span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)</span>
<span id="cb49-23"><a href="chapter5.html#cb49-23"></a>    )<span class="op">*</span>(</span>
<span id="cb49-24"><a href="chapter5.html#cb49-24"></a>    (n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span></span>
<span id="cb49-25"><a href="chapter5.html#cb49-25"></a>    )</span>
<span id="cb49-26"><a href="chapter5.html#cb49-26"></a>  </span>
<span id="cb49-27"><a href="chapter5.html#cb49-27"></a>  sigma_population_inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma_population)</span>
<span id="cb49-28"><a href="chapter5.html#cb49-28"></a>  T2 &lt;&lt;-<span class="st"> </span>((n_<span class="dv">1</span><span class="op">*</span>n_<span class="dv">2</span>)<span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span>))<span class="op">*</span><span class="kw">t</span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>) <span class="op">%*%</span><span class="st"> </span>sigma_population_inverse <span class="op">%*%</span><span class="st"> </span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>)</span>
<span id="cb49-29"><a href="chapter5.html#cb49-29"></a>  </span>
<span id="cb49-30"><a href="chapter5.html#cb49-30"></a>  <span class="kw">print</span>(<span class="st">&quot;The pooled covariance matrix is:&quot;</span>)</span>
<span id="cb49-31"><a href="chapter5.html#cb49-31"></a>  <span class="kw">print</span>(sigma_population)</span>
<span id="cb49-32"><a href="chapter5.html#cb49-32"></a>  <span class="kw">print</span>(<span class="st">&quot;The value of T2 is:&quot;</span>)</span>
<span id="cb49-33"><a href="chapter5.html#cb49-33"></a>  <span class="kw">print</span> (T2)</span>
<span id="cb49-34"><a href="chapter5.html#cb49-34"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chapter5.html#cb50-1"></a><span class="kw">T2_two_sample</span>(data542_female, data542_male)</span></code></pre></div>
<pre><code>## [1] &quot;The pooled covariance matrix is:&quot;
##          y_1f      y_2f      y_3f      y_4f
## y_1f 7.164315  6.047379  5.693044  4.700605
## y_2f 6.047379 15.894153  8.492440  5.855847
## y_3f 5.693044  8.492440 29.356351 13.980847
## y_4f 4.700605  5.855847 13.980847 22.320565
## [1] &quot;The value of T2 is:&quot;
##         [,1]
## [1,] 97.6015</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="chapter5.html#cb52-1"></a><span class="co">#transforming T^2- statistic to an F-statistic</span></span></code></pre></div>
<p>The <span class="math inline">\(T^2\)</span>-statistic can be readily transformed to an F-statistic using:</p>
<p><span class="math display">\[
\frac{n_{1}+ n_{2}-p-1}{(n_1+n_2-2)p}T^2=F_{p, n_1+n_2-p-1}
\]</span></p>
<p>where again the dimension <span class="math inline">\(p\)</span> of the <span class="math inline">\(T^2\)</span>-statistic becomes the first degree-of-freedom parameter for the <span class="math inline">\(F\)</span>-statistic.</p>
<blockquote>
<ol start="5" style="list-style-type: decimal">
<li>Finally, we have the elements to integrate all mentioned above (plus some complements of the T2 statistic test) into a function that will test whether the means of the two samples are equal and compare it to existing packages in R.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="chapter5.html#cb53-1"></a><span class="co">#Function for multivariate two-Sample $T^2$-test</span></span>
<span id="cb53-2"><a href="chapter5.html#cb53-2"></a></span>
<span id="cb53-3"><a href="chapter5.html#cb53-3"></a></span>
<span id="cb53-4"><a href="chapter5.html#cb53-4"></a></span>
<span id="cb53-5"><a href="chapter5.html#cb53-5"></a>hotelling_two_independent_samples &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2, alpha) {</span>
<span id="cb53-6"><a href="chapter5.html#cb53-6"></a>  <span class="st">&quot;</span></span>
<span id="cb53-7"><a href="chapter5.html#cb53-7"></a><span class="st">  Considering that p variables are measured on two samples, this function tests whether</span></span>
<span id="cb53-8"><a href="chapter5.html#cb53-8"></a><span class="st">  H_0:u_1=u_2 vs H_1: u_1 distinct from    u_2. We assume that the two samples are independent and that</span></span>
<span id="cb53-9"><a href="chapter5.html#cb53-9"></a><span class="st">  sigma_1=sigma_2=sigma</span></span>
<span id="cb53-10"><a href="chapter5.html#cb53-10"></a><span class="st">  </span></span>
<span id="cb53-11"><a href="chapter5.html#cb53-11"></a><span class="st">  Input: </span></span>
<span id="cb53-12"><a href="chapter5.html#cb53-12"></a><span class="st">  + data1: dataset from sample 1</span></span>
<span id="cb53-13"><a href="chapter5.html#cb53-13"></a><span class="st">  + data2: dataset from sample 2</span></span>
<span id="cb53-14"><a href="chapter5.html#cb53-14"></a><span class="st">  + alpha. significance level</span></span>
<span id="cb53-15"><a href="chapter5.html#cb53-15"></a><span class="st">  </span></span>
<span id="cb53-16"><a href="chapter5.html#cb53-16"></a><span class="st">  Output:</span></span>
<span id="cb53-17"><a href="chapter5.html#cb53-17"></a><span class="st">  + sigma_population: pooled covariance matrix</span></span>
<span id="cb53-18"><a href="chapter5.html#cb53-18"></a><span class="st">  + T2: hotellings T2</span></span>
<span id="cb53-19"><a href="chapter5.html#cb53-19"></a><span class="st">  + F: T2-statistic transformed to an F-statistic</span></span>
<span id="cb53-20"><a href="chapter5.html#cb53-20"></a><span class="st">  + F-critical value</span></span>
<span id="cb53-21"><a href="chapter5.html#cb53-21"></a><span class="st">  + Reject H0: if we reject H0=TRUE, otherwise FALSE</span></span>
<span id="cb53-22"><a href="chapter5.html#cb53-22"></a><span class="st">  + P-value</span></span>
<span id="cb53-23"><a href="chapter5.html#cb53-23"></a></span>
<span id="cb53-24"><a href="chapter5.html#cb53-24"></a><span class="st">  &quot;</span></span>
<span id="cb53-25"><a href="chapter5.html#cb53-25"></a>  <span class="co">#package for hotelling testing</span></span>
<span id="cb53-26"><a href="chapter5.html#cb53-26"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;ICSNP&quot;</span>)){</span>
<span id="cb53-27"><a href="chapter5.html#cb53-27"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;ICSNP&quot;</span>)</span>
<span id="cb53-28"><a href="chapter5.html#cb53-28"></a>    <span class="kw">library</span>(ICSNP)</span>
<span id="cb53-29"><a href="chapter5.html#cb53-29"></a>    }</span>
<span id="cb53-30"><a href="chapter5.html#cb53-30"></a>  n_<span class="dv">1</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb53-31"><a href="chapter5.html#cb53-31"></a>  n_<span class="dv">2</span>&lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb53-32"><a href="chapter5.html#cb53-32"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1)</span>
<span id="cb53-33"><a href="chapter5.html#cb53-33"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2)</span>
<span id="cb53-34"><a href="chapter5.html#cb53-34"></a>  </span>
<span id="cb53-35"><a href="chapter5.html#cb53-35"></a>  y_mean_<span class="dv">1</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb53-36"><a href="chapter5.html#cb53-36"></a>  <span class="kw">apply</span>(data1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb53-37"><a href="chapter5.html#cb53-37"></a>        )</span>
<span id="cb53-38"><a href="chapter5.html#cb53-38"></a>  )</span>
<span id="cb53-39"><a href="chapter5.html#cb53-39"></a>  </span>
<span id="cb53-40"><a href="chapter5.html#cb53-40"></a>  y_mean_<span class="dv">2</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb53-41"><a href="chapter5.html#cb53-41"></a>  <span class="kw">apply</span>(data2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb53-42"><a href="chapter5.html#cb53-42"></a>        )</span>
<span id="cb53-43"><a href="chapter5.html#cb53-43"></a>  )</span>
<span id="cb53-44"><a href="chapter5.html#cb53-44"></a>  sigma_population&lt;-(</span>
<span id="cb53-45"><a href="chapter5.html#cb53-45"></a>    <span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)</span>
<span id="cb53-46"><a href="chapter5.html#cb53-46"></a>    )<span class="op">*</span>(</span>
<span id="cb53-47"><a href="chapter5.html#cb53-47"></a>    (n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span></span>
<span id="cb53-48"><a href="chapter5.html#cb53-48"></a>    )</span>
<span id="cb53-49"><a href="chapter5.html#cb53-49"></a>  </span>
<span id="cb53-50"><a href="chapter5.html#cb53-50"></a>  sigma_population_inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma_population)</span>
<span id="cb53-51"><a href="chapter5.html#cb53-51"></a>  T2 &lt;&lt;-<span class="st"> </span>((n_<span class="dv">1</span><span class="op">*</span>n_<span class="dv">2</span>)<span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span>))<span class="op">*</span><span class="kw">t</span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>) <span class="op">%*%</span><span class="st"> </span>sigma_population_inverse <span class="op">%*%</span><span class="st"> </span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>)</span>
<span id="cb53-52"><a href="chapter5.html#cb53-52"></a>  F&lt;-<span class="kw">round</span>(T2<span class="op">*</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span><span class="op">-</span>p<span class="dv">-1</span>)<span class="op">/</span>(p<span class="op">*</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)),<span class="dv">2</span>)</span>
<span id="cb53-53"><a href="chapter5.html#cb53-53"></a>  p&lt;-<span class="kw">ncol</span>(data1)</span>
<span id="cb53-54"><a href="chapter5.html#cb53-54"></a>  <span class="kw">print</span>(</span>
<span id="cb53-55"><a href="chapter5.html#cb53-55"></a>    <span class="st">&quot;The pooled covariance matrix is:&quot;</span></span>
<span id="cb53-56"><a href="chapter5.html#cb53-56"></a>    )</span>
<span id="cb53-57"><a href="chapter5.html#cb53-57"></a>  <span class="kw">print</span>(</span>
<span id="cb53-58"><a href="chapter5.html#cb53-58"></a>    sigma_population</span>
<span id="cb53-59"><a href="chapter5.html#cb53-59"></a>    )</span>
<span id="cb53-60"><a href="chapter5.html#cb53-60"></a>  <span class="kw">print</span>(</span>
<span id="cb53-61"><a href="chapter5.html#cb53-61"></a>    <span class="kw">paste0</span>(</span>
<span id="cb53-62"><a href="chapter5.html#cb53-62"></a>      <span class="st">&quot;The value of T2 is: &quot;</span>, T2 </span>
<span id="cb53-63"><a href="chapter5.html#cb53-63"></a>      )</span>
<span id="cb53-64"><a href="chapter5.html#cb53-64"></a>    )</span>
<span id="cb53-65"><a href="chapter5.html#cb53-65"></a>  <span class="kw">print</span>(</span>
<span id="cb53-66"><a href="chapter5.html#cb53-66"></a>    <span class="kw">paste0</span>(</span>
<span id="cb53-67"><a href="chapter5.html#cb53-67"></a>      <span class="st">&quot;T2-statistic transformed to an F-statistic is: &quot;</span>, F</span>
<span id="cb53-68"><a href="chapter5.html#cb53-68"></a>           )</span>
<span id="cb53-69"><a href="chapter5.html#cb53-69"></a>    )</span>
<span id="cb53-70"><a href="chapter5.html#cb53-70"></a>  <span class="kw">print</span>(</span>
<span id="cb53-71"><a href="chapter5.html#cb53-71"></a>    <span class="kw">paste0</span>(</span>
<span id="cb53-72"><a href="chapter5.html#cb53-72"></a>      <span class="st">&quot;F-critical value: &quot;</span>, <span class="kw">round</span>(<span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">df1=</span>p, <span class="dt">df2=</span>n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span><span class="op">-</span>p<span class="dv">-1</span>), <span class="dv">5</span>) , <span class="st">&quot; with &quot;</span>, p,<span class="st">&quot; and &quot;</span>, n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span><span class="op">-</span>p<span class="dv">-1</span>, <span class="st">&quot; degrees of freedom&quot;</span>, <span class="dt">sep=</span><span class="st">&quot; &quot;</span></span>
<span id="cb53-73"><a href="chapter5.html#cb53-73"></a>      )</span>
<span id="cb53-74"><a href="chapter5.html#cb53-74"></a>    )</span>
<span id="cb53-75"><a href="chapter5.html#cb53-75"></a>  <span class="kw">print</span>(</span>
<span id="cb53-76"><a href="chapter5.html#cb53-76"></a>    <span class="kw">paste0</span>(</span>
<span id="cb53-77"><a href="chapter5.html#cb53-77"></a>      <span class="st">&quot;Reject H0: &quot;</span>, F <span class="op">&gt;</span><span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">df1=</span>p, <span class="dt">df2=</span>n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span><span class="op">-</span>p<span class="dv">-1</span>)</span>
<span id="cb53-78"><a href="chapter5.html#cb53-78"></a>      )</span>
<span id="cb53-79"><a href="chapter5.html#cb53-79"></a>    )</span>
<span id="cb53-80"><a href="chapter5.html#cb53-80"></a>  <span class="kw">print</span>(</span>
<span id="cb53-81"><a href="chapter5.html#cb53-81"></a>    <span class="kw">paste0</span>(</span>
<span id="cb53-82"><a href="chapter5.html#cb53-82"></a>      <span class="st">&quot;P-value: &quot;</span>, (<span class="kw">pf</span>(F,<span class="dt">df1=</span>p, <span class="dt">df2=</span>n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span><span class="op">-</span>p<span class="dv">-1</span>, <span class="dt">lower.tail =</span> F))</span>
<span id="cb53-83"><a href="chapter5.html#cb53-83"></a>      )</span>
<span id="cb53-84"><a href="chapter5.html#cb53-84"></a>    )</span>
<span id="cb53-85"><a href="chapter5.html#cb53-85"></a>  <span class="kw">print</span>(</span>
<span id="cb53-86"><a href="chapter5.html#cb53-86"></a>    <span class="st">&quot;***Comparing results using HotellingsT2 from ICSNP library - F-TEST***&quot;</span></span>
<span id="cb53-87"><a href="chapter5.html#cb53-87"></a>    )</span>
<span id="cb53-88"><a href="chapter5.html#cb53-88"></a>  <span class="kw">print</span>(</span>
<span id="cb53-89"><a href="chapter5.html#cb53-89"></a>    <span class="kw">HotellingsT2</span>(data1, data2, <span class="dt">mu=</span><span class="ot">NULL</span>, <span class="dt">test =</span> <span class="st">&quot;f&quot;</span>)</span>
<span id="cb53-90"><a href="chapter5.html#cb53-90"></a>    )</span>
<span id="cb53-91"><a href="chapter5.html#cb53-91"></a>  <span class="kw">print</span>(</span>
<span id="cb53-92"><a href="chapter5.html#cb53-92"></a>    <span class="st">&quot;***Comparing results using HotellingsT2 from ICSNP library - CHI-TEST***&quot;</span></span>
<span id="cb53-93"><a href="chapter5.html#cb53-93"></a>    )</span>
<span id="cb53-94"><a href="chapter5.html#cb53-94"></a>  <span class="kw">print</span>(</span>
<span id="cb53-95"><a href="chapter5.html#cb53-95"></a>    <span class="kw">HotellingsT2</span>(data1, data2, <span class="dt">mu=</span><span class="ot">NULL</span>, <span class="dt">test =</span> <span class="st">&quot;chi&quot;</span>)</span>
<span id="cb53-96"><a href="chapter5.html#cb53-96"></a>    )</span>
<span id="cb53-97"><a href="chapter5.html#cb53-97"></a>}</span></code></pre></div>
<blockquote>
<ol start="6" style="list-style-type: decimal">
<li>The solution to problem <span class="math inline">\(5.42\)</span> is:</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="chapter5.html#cb54-1"></a><span class="kw">hotelling_two_independent_samples</span>(data542_female, data542_male, <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The pooled covariance matrix is:&quot;
##          y_1f      y_2f      y_3f      y_4f
## y_1f 7.164315  6.047379  5.693044  4.700605
## y_2f 6.047379 15.894153  8.492440  5.855847
## y_3f 5.693044  8.492440 29.356351 13.980847
## y_4f 4.700605  5.855847 13.980847 22.320565
## [1] &quot;The value of T2 is: 97.6014965277689&quot;
## [1] &quot;T2-statistic transformed to an F-statistic is: 31.48&quot;
## [1] &quot;F-critical value: 2.52791 with 4 and 59 degrees of freedom &quot;
## [1] &quot;Reject H0: TRUE&quot;
## [1] &quot;P-value: 0.999999999999951&quot;
## [1] &quot;***Comparing results using HotellingsT2 from ICSNP library - F-TEST***&quot;
## 
##  Hotelling&#39;s two sample T2-test
## 
## data:  data1 and data2
## T.2 = 23.22, df1 = 4, df2 = 59, p-value = 1.464e-11
## alternative hypothesis: true location difference is not equal to c(0,0,0,0)
## 
## [1] &quot;***Comparing results using HotellingsT2 from ICSNP library - CHI-TEST***&quot;
## 
##  Hotelling&#39;s two sample T2-test
## 
## data:  data1 and data2
## T.2 = 97.601, df = 4, p-value &lt; 2.2e-16
## alternative hypothesis: true location difference is not equal to c(0,0,0,0)</code></pre>
</div>
</div>
<div id="tests-on-individual-variables-conditional-on-rejection-of-h_0-by-the-t2-test." class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Tests on individual variables conditional on rejection of <span class="math inline">\(H_{0}\)</span> by the <span class="math inline">\(T^2\)</span>-test.</h2>
<p>If the hypothesis <span class="math inline">\(H_{0}: \mu_{1} = \mu_{2}\)</span> is rejected, the implication is that <span class="math inline">\(\mu_{ij} \neq \mu_{2j}\)</span> for at least one <span class="math inline">\(j=1,2,...,p\)</span>. But there is no guarantee that <span class="math inline">\(H_{0}: \mu_{1} = \mu_{2}\)</span> will be rejected for some <span class="math inline">\(j\)</span> by a univariate test. However, if we consider a linear combination of the variables, <span class="math inline">\(z = a&#39;y\)</span>, then there is at least one coefficient vector  for which will reject the corresponding hyphotesis <span class="math inline">\(H_{0}=a&#39;\mu_{1}=a&#39;\mu_{2}\)</span>. Thus <strong>if</strong> <span class="math inline">\(H_{0}: \mu_{1} = \mu_{2}\)</span> is rejected by <span class="math inline">\(T^2\)</span>, the  <span class="math inline">\(a&#39;y\)</span> will lead to rejection of<span class="math inline">\(H_{0}=a&#39;\mu_{1}=a&#39;\mu_{2}\)</span>, with <span class="math inline">\(a=S_{pl}^{-1}(\bar{y}_{1}-\bar{y}_{2})\)</span>.</p>
<p>We can then examine each <span class="math inline">\(a_{j}\)</span> in  for an indication of the contribution of the corresponding <span class="math inline">\(y_{j}\)</span> to rejection of <span class="math inline">\(H_{0}\)</span>.</p>
<div id="example-5.5" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Example 5.5</h3>
<p>Returning to the psychological data Table <span class="math inline">\(5.1\)</span>, we obtained <span class="math inline">\(\bar{y}_{1}- \bar{y}_{2}\)</span>, and <span class="math inline">\(\textbf{S}_{pl}\)</span>. The discriminant function coefficiente vector is obtained as:</p>
<p><span class="math display">\[a=\textbf{S}_{pl}^{-1}(\bar{y}_{1}- \bar{y}_{2})\]</span></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="chapter5.html#cb56-1"></a>discriminant_function &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2) {</span>
<span id="cb56-2"><a href="chapter5.html#cb56-2"></a>    <span class="st">&quot;</span></span>
<span id="cb56-3"><a href="chapter5.html#cb56-3"></a><span class="st">    This function determines the discriminat function coefficient vector</span></span>
<span id="cb56-4"><a href="chapter5.html#cb56-4"></a><span class="st">    </span></span>
<span id="cb56-5"><a href="chapter5.html#cb56-5"></a></span>
<span id="cb56-6"><a href="chapter5.html#cb56-6"></a><span class="st">    Input: </span></span>
<span id="cb56-7"><a href="chapter5.html#cb56-7"></a><span class="st">    + data1: dataset from sample 1</span></span>
<span id="cb56-8"><a href="chapter5.html#cb56-8"></a><span class="st">    + data2: dataset from sample 2</span></span>
<span id="cb56-9"><a href="chapter5.html#cb56-9"></a></span>
<span id="cb56-10"><a href="chapter5.html#cb56-10"></a><span class="st">    Output:</span></span>
<span id="cb56-11"><a href="chapter5.html#cb56-11"></a><span class="st">    + a: discriminant function coefficient vector</span></span>
<span id="cb56-12"><a href="chapter5.html#cb56-12"></a><span class="st">  </span></span>
<span id="cb56-13"><a href="chapter5.html#cb56-13"></a><span class="st">    &quot;</span></span>
<span id="cb56-14"><a href="chapter5.html#cb56-14"></a></span>
<span id="cb56-15"><a href="chapter5.html#cb56-15"></a>  n_<span class="dv">1</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb56-16"><a href="chapter5.html#cb56-16"></a>  n_<span class="dv">2</span>&lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb56-17"><a href="chapter5.html#cb56-17"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1)</span>
<span id="cb56-18"><a href="chapter5.html#cb56-18"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2)</span>
<span id="cb56-19"><a href="chapter5.html#cb56-19"></a>  </span>
<span id="cb56-20"><a href="chapter5.html#cb56-20"></a>  y_mean_<span class="dv">1</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb56-21"><a href="chapter5.html#cb56-21"></a>  <span class="kw">apply</span>(data1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb56-22"><a href="chapter5.html#cb56-22"></a>        )</span>
<span id="cb56-23"><a href="chapter5.html#cb56-23"></a>  )</span>
<span id="cb56-24"><a href="chapter5.html#cb56-24"></a>  </span>
<span id="cb56-25"><a href="chapter5.html#cb56-25"></a>  y_mean_<span class="dv">2</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb56-26"><a href="chapter5.html#cb56-26"></a>  <span class="kw">apply</span>(data2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb56-27"><a href="chapter5.html#cb56-27"></a>        )</span>
<span id="cb56-28"><a href="chapter5.html#cb56-28"></a>  )</span>
<span id="cb56-29"><a href="chapter5.html#cb56-29"></a>  sigma_population&lt;-(</span>
<span id="cb56-30"><a href="chapter5.html#cb56-30"></a>    <span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)</span>
<span id="cb56-31"><a href="chapter5.html#cb56-31"></a>    )<span class="op">*</span>(</span>
<span id="cb56-32"><a href="chapter5.html#cb56-32"></a>    (n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span></span>
<span id="cb56-33"><a href="chapter5.html#cb56-33"></a>    )</span>
<span id="cb56-34"><a href="chapter5.html#cb56-34"></a>  </span>
<span id="cb56-35"><a href="chapter5.html#cb56-35"></a>  sigma_population_inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma_population)</span>
<span id="cb56-36"><a href="chapter5.html#cb56-36"></a>  a &lt;-<span class="st"> </span>sigma_population_inverse<span class="op">%*%</span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>)</span>
<span id="cb56-37"><a href="chapter5.html#cb56-37"></a>  <span class="kw">print</span>(</span>
<span id="cb56-38"><a href="chapter5.html#cb56-38"></a>      <span class="st">&quot;The discriminant coeficient vector is: &quot;</span></span>
<span id="cb56-39"><a href="chapter5.html#cb56-39"></a>      )</span>
<span id="cb56-40"><a href="chapter5.html#cb56-40"></a>  <span class="kw">print</span>(<span class="kw">round</span>(a, <span class="dv">4</span>))</span>
<span id="cb56-41"><a href="chapter5.html#cb56-41"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="chapter5.html#cb57-1"></a><span class="kw">discriminant_function</span>(data542_male, data542_female)</span></code></pre></div>
<pre><code>## [1] &quot;The discriminant coeficient vector is: &quot;
##         [,1]
## y_1m  0.5104
## y_2m -0.2033
## y_3m  0.4660
## y_4m -0.3097</code></pre>
<p>Thus the linear combination that best separates the two groups is:</p>
<p><span class="math display">\[a&#39;y= 0,5104y_{1} - 0.2033y_{2} +0.4660y_{3}-0.3097y_{4}\]</span></p>
</div>
</div>
<div id="computation-of-t2" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Computation of <span class="math inline">\(T^2\)</span></h2>
<p><strong>Obtaining <span class="math inline">\(T^2\)</span> from a MANOVA Program</strong></p>
<p>One-way MANOVA involves a comparison of mean vectors from several samples. Typically, the number of samples is three or more, but the procedure will also accommodate two samples. The two-sample <span class="math inline">\(T^2\)</span> test is thus a special case of MANOVA.</p>
<p><strong>Obtaining <span class="math inline">\(T^2\)</span> from Multiple Regression</strong></p>
<div id="example-5.6.2" class="section level3" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Example: 5.6.2</h3>
<p>We illustrate the regression approach to computation of <span class="math inline">\(T^2\)</span> using the psychological data in Table <span class="math inline">\(5.1.\)</span></p>
</div>
</div>
<div id="paired-observation-test" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Paired Observation Test</h2>
<p><strong>Univariate Case</strong></p>
<p>Suppose two samples are <strong>not independent</strong> because there exists a natural pairing between the <span class="math inline">\(ith\)</span> observation <span class="math inline">\(y_{i}\)</span> int the first sample and the <span class="math inline">\(ith\)</span> observation <span class="math inline">\(x_{i}\)</span> in the second sample for all <span class="math inline">\(i\)</span>, as for example, when a treatment is applied twice to the same indidividual or when subjects are matched according to some criterion, such as IQ or family background. With such pairing, the samples are often referred to as <strong>paired observations or matched pairs</strong>.</p>
<blockquote>
<p>The two samples thus obtained are <code>correlated</code>, and the two-sample test statistic is not appropriate because the samples must be <code>independent</code> in order to have a t-distribution.</p>
</blockquote>
<p><strong>Multivariate Case</strong>
We assume <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are correlated and have a multivariate normal distribution.</p>
<p><span class="math display">\[H_0=\mu_d=0\]</span>, which is equivalent to <span class="math inline">\(H_0=\mu_y=\mu_x\)</span>, since <span class="math inline">\(\mu_d=E(y-x)=\mu_y-\mu_x\)</span>.
we find:
<span class="math display">\[\bar{d}=\frac{1}{n}\sum_1^nd_i\]</span></p>
<p><span class="math display">\[S_d=\frac{1}{n-1}\sum_1^n(d_i-\bar{d})(d_i-\bar{d})&#39;\]</span></p>
<p>We then have:</p>
<p><span class="math display">\[T^2=\bar{d}&#39;\begin{pmatrix}
\frac{S_d}{n}
\end{pmatrix}^{-1}\bar{d}=n\bar{d}&#39;S_d^{-1}\bar{d}&#39;\]</span></p>
<div id="example-5.7.2" class="section level3" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Example 5.7.2</h3>
<p>To compare two types of coating for resistance to corroison, 15 pieces of pipe were coated with each type of coating. Two pipes, one with each type of coating, were buried together and left for the same length of time at <span class="math inline">\(15\)</span> different locations, providing a natural pairing of the observations. Corrosion for the first type of coating was measured by two variables:</p>
<p><span class="math inline">\(y_1\)</span> = maximum depth of pit in thousandths of an inch. <span class="math inline">\(y_2\)</span> = number of pits.</p>
<p>with <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> defined analogously for the second coating. The data and differences are given in Table <span class="math inline">\(5.3\)</span>. Thus, we have, for example, <span class="math inline">\(y_1&#39;=74\)</span></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="chapter5.html#cb59-1"></a>coat1_depth &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">73</span>, <span class="dv">43</span>, <span class="dv">47</span>, <span class="dv">53</span>, <span class="dv">58</span>, <span class="dv">47</span>, <span class="dv">52</span>, <span class="dv">38</span>, <span class="dv">61</span>, <span class="dv">56</span>, <span class="dv">56</span>, <span class="dv">34</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">75</span>)</span>
<span id="cb59-2"><a href="chapter5.html#cb59-2"></a>coat1_numb  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">31</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">26</span>, <span class="dv">36</span>, <span class="dv">30</span>, <span class="dv">29</span>, <span class="dv">36</span>, <span class="dv">34</span>, <span class="dv">33</span>, <span class="dv">19</span>, <span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">15</span>, <span class="dv">18</span>)</span>
<span id="cb59-3"><a href="chapter5.html#cb59-3"></a>coat2_depth &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">51</span>, <span class="dv">41</span>, <span class="dv">43</span>, <span class="dv">41</span>, <span class="dv">47</span>, <span class="dv">32</span>, <span class="dv">24</span>, <span class="dv">43</span>, <span class="dv">53</span>, <span class="dv">52</span>, <span class="dv">57</span>, <span class="dv">44</span>, <span class="dv">57</span>, <span class="dv">40</span>, <span class="dv">68</span>)</span>
<span id="cb59-4"><a href="chapter5.html#cb59-4"></a>coat2_numb  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">35</span>, <span class="dv">14</span>, <span class="dv">19</span>, <span class="dv">29</span>, <span class="dv">34</span>, <span class="dv">26</span>, <span class="dv">19</span>, <span class="dv">37</span>, <span class="dv">24</span>, <span class="dv">27</span>, <span class="dv">14</span>, <span class="dv">19</span>, <span class="dv">30</span>, <span class="dv">7</span>, <span class="dv">13</span>)</span>
<span id="cb59-5"><a href="chapter5.html#cb59-5"></a>diff_depth  &lt;-<span class="st"> </span>coat1_depth<span class="op">-</span>coat2_depth</span>
<span id="cb59-6"><a href="chapter5.html#cb59-6"></a>diff_numb   &lt;-<span class="st"> </span>coat1_numb<span class="op">-</span>coat2_numb</span>
<span id="cb59-7"><a href="chapter5.html#cb59-7"></a></span>
<span id="cb59-8"><a href="chapter5.html#cb59-8"></a>data572 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(coat1_depth, coat1_numb, coat2_depth, coat2_numb, diff_depth, diff_numb)</span>
<span id="cb59-9"><a href="chapter5.html#cb59-9"></a>data572a &lt;-<span class="st"> </span><span class="kw">tibble</span>(coat1_depth, coat1_numb, coat2_depth, coat2_numb, diff_depth, diff_numb)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="chapter5.html#cb60-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb60-2"><a href="chapter5.html#cb60-2"></a>  data572a, <span class="dt">caption =</span> <span class="st">&#39;Data Exercise 5.72&#39;</span>,</span>
<span id="cb60-3"><a href="chapter5.html#cb60-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb60-4"><a href="chapter5.html#cb60-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-33">Table 5.5: </span>Data Exercise 5.72</caption>
<thead>
<tr class="header">
<th align="right">coat1_depth</th>
<th align="right">coat1_numb</th>
<th align="right">coat2_depth</th>
<th align="right">coat2_numb</th>
<th align="right">diff_depth</th>
<th align="right">diff_numb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">73</td>
<td align="right">31</td>
<td align="right">51</td>
<td align="right">35</td>
<td align="right">22</td>
<td align="right">-4</td>
</tr>
<tr class="even">
<td align="right">43</td>
<td align="right">19</td>
<td align="right">41</td>
<td align="right">14</td>
<td align="right">2</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="right">47</td>
<td align="right">22</td>
<td align="right">43</td>
<td align="right">19</td>
<td align="right">4</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">53</td>
<td align="right">26</td>
<td align="right">41</td>
<td align="right">29</td>
<td align="right">12</td>
<td align="right">-3</td>
</tr>
<tr class="odd">
<td align="right">58</td>
<td align="right">36</td>
<td align="right">47</td>
<td align="right">34</td>
<td align="right">11</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">47</td>
<td align="right">30</td>
<td align="right">32</td>
<td align="right">26</td>
<td align="right">15</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">52</td>
<td align="right">29</td>
<td align="right">24</td>
<td align="right">19</td>
<td align="right">28</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">38</td>
<td align="right">36</td>
<td align="right">43</td>
<td align="right">37</td>
<td align="right">-5</td>
<td align="right">-1</td>
</tr>
<tr class="odd">
<td align="right">61</td>
<td align="right">34</td>
<td align="right">53</td>
<td align="right">24</td>
<td align="right">8</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">56</td>
<td align="right">33</td>
<td align="right">52</td>
<td align="right">27</td>
<td align="right">4</td>
<td align="right">6</td>
</tr>
<tr class="odd">
<td align="right">56</td>
<td align="right">19</td>
<td align="right">57</td>
<td align="right">14</td>
<td align="right">-1</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">34</td>
<td align="right">19</td>
<td align="right">44</td>
<td align="right">19</td>
<td align="right">-10</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">55</td>
<td align="right">26</td>
<td align="right">57</td>
<td align="right">30</td>
<td align="right">-2</td>
<td align="right">-4</td>
</tr>
<tr class="even">
<td align="right">65</td>
<td align="right">15</td>
<td align="right">40</td>
<td align="right">7</td>
<td align="right">25</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">75</td>
<td align="right">18</td>
<td align="right">68</td>
<td align="right">13</td>
<td align="right">7</td>
<td align="right">5</td>
</tr>
</tbody>
</table>
<p>Calculating the difference averages</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="chapter5.html#cb61-1"></a><span class="co"># difference vector</span></span>
<span id="cb61-2"><a href="chapter5.html#cb61-2"></a>d_bar_depth &lt;-<span class="st"> </span><span class="kw">mean</span>(data572<span class="op">$</span>diff_depth)</span>
<span id="cb61-3"><a href="chapter5.html#cb61-3"></a><span class="kw">print</span>(<span class="st">&quot;depth average, d_bar_depth&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;depth average, d_bar_depth&quot;</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="chapter5.html#cb63-1"></a><span class="kw">print</span>(d_bar_depth)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="chapter5.html#cb65-1"></a>d_bar_numb  &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">mean</span>(data572<span class="op">$</span>diff_numb))</span>
<span id="cb65-2"><a href="chapter5.html#cb65-2"></a><span class="kw">print</span>(<span class="st">&quot;depth average, d_bar_numb&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;depth average, d_bar_numb&quot;</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="chapter5.html#cb67-1"></a><span class="kw">print</span>(d_bar_numb)</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 3.066667</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="chapter5.html#cb69-1"></a><span class="kw">print</span>(<span class="st">&quot;d_bar vector&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;d_bar vector&quot;</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="chapter5.html#cb71-1"></a>d_bar_vector &lt;-<span class="st"> </span><span class="kw">c</span>(d_bar_depth, d_bar_numb)</span>
<span id="cb71-2"><a href="chapter5.html#cb71-2"></a>d_bar_vector &lt;-<span class="st"> </span>(<span class="kw">as.matrix</span>(d_bar_vector))</span>
<span id="cb71-3"><a href="chapter5.html#cb71-3"></a>d_bar_vector</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 8.000000
## [2,] 3.066667</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="chapter5.html#cb73-1"></a><span class="kw">print</span>(d_bar_vector)</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 8.000000
## [2,] 3.066667</code></pre>
<p>Function for calculating matrix <span class="math inline">\(S_{d}\)</span></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="chapter5.html#cb75-1"></a>calc_Sd &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">y1=</span><span class="dv">1</span>, <span class="dt">y2=</span><span class="dv">2</span>, <span class="dt">x1=</span><span class="dv">3</span>, <span class="dt">x2=</span><span class="dv">4</span>){</span>
<span id="cb75-2"><a href="chapter5.html#cb75-2"></a>  <span class="st">&quot;</span></span>
<span id="cb75-3"><a href="chapter5.html#cb75-3"></a><span class="st">  (see table 5.3 for clarity)</span></span>
<span id="cb75-4"><a href="chapter5.html#cb75-4"></a><span class="st">  data: dataframe</span></span>
<span id="cb75-5"><a href="chapter5.html#cb75-5"></a><span class="st">  y1: number of the column of y1, 1 for depth coating 1 </span></span>
<span id="cb75-6"><a href="chapter5.html#cb75-6"></a><span class="st">  y2: number of the column of y2, 1 for number coating 1</span></span>
<span id="cb75-7"><a href="chapter5.html#cb75-7"></a><span class="st">  x1: number of the column of x1, 1 for depth coating 2</span></span>
<span id="cb75-8"><a href="chapter5.html#cb75-8"></a><span class="st">  x2: number of the column of y2, 1 for number coating 2</span></span>
<span id="cb75-9"><a href="chapter5.html#cb75-9"></a><span class="st">  &quot;</span></span>
<span id="cb75-10"><a href="chapter5.html#cb75-10"></a>  d_bar_y1x1 &lt;-<span class="st"> </span><span class="kw">mean</span>((data[,y1])<span class="op">-</span>(data[,x1]))</span>
<span id="cb75-11"><a href="chapter5.html#cb75-11"></a>  d_bar_y2x2 &lt;-<span class="st"> </span><span class="kw">mean</span>((data[,y2])<span class="op">-</span>(data[,x2]))</span>
<span id="cb75-12"><a href="chapter5.html#cb75-12"></a>  d_bar_vector &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(d_bar_y1x1, d_bar_y2x2))</span>
<span id="cb75-13"><a href="chapter5.html#cb75-13"></a></span>
<span id="cb75-14"><a href="chapter5.html#cb75-14"></a>  n  &lt;-<span class="st"> </span><span class="kw">nrow</span>(data) <span class="co"># number of rows</span></span>
<span id="cb75-15"><a href="chapter5.html#cb75-15"></a>  d &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data=</span><span class="dv">0</span>, <span class="dt">nrow=</span>n, <span class="dv">2</span>) <span class="co"># in this case 2 because we have depth and number</span></span>
<span id="cb75-16"><a href="chapter5.html#cb75-16"></a>  sum_diffs &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># suma de los vectores (d-dbar)(d-dbar)&#39;</span></span>
<span id="cb75-17"><a href="chapter5.html#cb75-17"></a>  </span>
<span id="cb75-18"><a href="chapter5.html#cb75-18"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="kw">nrow</span>(data))){</span>
<span id="cb75-19"><a href="chapter5.html#cb75-19"></a>  y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(data[i, y1], data[i, y2]))</span>
<span id="cb75-20"><a href="chapter5.html#cb75-20"></a>  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(data[i, x1], data[i, x2]))</span>
<span id="cb75-21"><a href="chapter5.html#cb75-21"></a>  diff_xy &lt;-<span class="st"> </span>(y <span class="op">-</span><span class="st"> </span>x) </span>
<span id="cb75-22"><a href="chapter5.html#cb75-22"></a>  diff_xy_d &lt;-<span class="st"> </span>diff_xy <span class="op">-</span><span class="st"> </span>d_bar_vector</span>
<span id="cb75-23"><a href="chapter5.html#cb75-23"></a>  aux &lt;-<span class="st"> </span>diff_xy_d <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(diff_xy_d)</span>
<span id="cb75-24"><a href="chapter5.html#cb75-24"></a>  sum_diffs &lt;-<span class="st"> </span>sum_diffs <span class="op">+</span><span class="st"> </span>aux</span>
<span id="cb75-25"><a href="chapter5.html#cb75-25"></a>  }</span>
<span id="cb75-26"><a href="chapter5.html#cb75-26"></a>  </span>
<span id="cb75-27"><a href="chapter5.html#cb75-27"></a>  Sd &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>) <span class="op">*</span>sum_diffs</span>
<span id="cb75-28"><a href="chapter5.html#cb75-28"></a>  </span>
<span id="cb75-29"><a href="chapter5.html#cb75-29"></a>}</span>
<span id="cb75-30"><a href="chapter5.html#cb75-30"></a></span>
<span id="cb75-31"><a href="chapter5.html#cb75-31"></a><span class="co"># testing the function to get Sd in the exercise</span></span>
<span id="cb75-32"><a href="chapter5.html#cb75-32"></a>Sd &lt;-<span class="st"> </span><span class="kw">calc_Sd</span>(data572, <span class="dt">y1=</span><span class="dv">1</span>, <span class="dt">y2=</span><span class="dv">2</span>, <span class="dt">x1=</span><span class="dv">3</span>, <span class="dt">x2=</span><span class="dv">4</span>)</span>
<span id="cb75-33"><a href="chapter5.html#cb75-33"></a><span class="kw">print</span>(<span class="st">&quot;* matrix Sd&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;* matrix Sd&quot;</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="chapter5.html#cb77-1"></a><span class="kw">print</span>(Sd)</span></code></pre></div>
<pre><code>##           [,1]     [,2]
## [1,] 121.57143 17.07143
## [2,]  17.07143 21.78095</code></pre>
<p>Compute <span class="math inline">\(T^{2}\)</span> using (5.24)</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="chapter5.html#cb79-1"></a>cal_T2_test &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">y1=</span><span class="dv">1</span>, <span class="dt">y2=</span><span class="dv">2</span>, <span class="dt">x1=</span><span class="dv">3</span>, <span class="dt">x2=</span><span class="dv">4</span>){</span>
<span id="cb79-2"><a href="chapter5.html#cb79-2"></a>  <span class="st">&quot;</span></span>
<span id="cb79-3"><a href="chapter5.html#cb79-3"></a><span class="st">  Calculate T2 of equation 5.24</span></span>
<span id="cb79-4"><a href="chapter5.html#cb79-4"></a><span class="st">  data: dataframe</span></span>
<span id="cb79-5"><a href="chapter5.html#cb79-5"></a><span class="st">  y1: number of the column of y1, 1 for depth coating 1 </span></span>
<span id="cb79-6"><a href="chapter5.html#cb79-6"></a><span class="st">  y2: number of the column of y2, 1 for number coating 1</span></span>
<span id="cb79-7"><a href="chapter5.html#cb79-7"></a><span class="st">  x1: number of the column of x1, 1 for depth coating 2</span></span>
<span id="cb79-8"><a href="chapter5.html#cb79-8"></a><span class="st">  x2: number of the column of y2, 1 for number coating 2</span></span>
<span id="cb79-9"><a href="chapter5.html#cb79-9"></a><span class="st">  &quot;</span></span>
<span id="cb79-10"><a href="chapter5.html#cb79-10"></a>  d_bar_y1x1 &lt;-<span class="st"> </span><span class="kw">mean</span>((data[,y1])<span class="op">-</span>(data[,x1]))</span>
<span id="cb79-11"><a href="chapter5.html#cb79-11"></a>  d_bar_y2x2 &lt;-<span class="st"> </span><span class="kw">mean</span>((data[,y2])<span class="op">-</span>(data[,x2]))</span>
<span id="cb79-12"><a href="chapter5.html#cb79-12"></a>  <span class="co">#d_bar_vector: vector of means</span></span>
<span id="cb79-13"><a href="chapter5.html#cb79-13"></a>  d_bar_vector &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(d_bar_y1x1, d_bar_y2x2))</span>
<span id="cb79-14"><a href="chapter5.html#cb79-14"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;d_bar_y1x1: &quot;</span>, d_bar_y1x1 ))</span>
<span id="cb79-15"><a href="chapter5.html#cb79-15"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;d_bar_y2x2: &quot;</span>, d_bar_y2x2 ))</span>
<span id="cb79-16"><a href="chapter5.html#cb79-16"></a>  <span class="co">#n: number of observations</span></span>
<span id="cb79-17"><a href="chapter5.html#cb79-17"></a>  n  &lt;-<span class="st"> </span><span class="kw">nrow</span>(data) <span class="co"># number of rows</span></span>
<span id="cb79-18"><a href="chapter5.html#cb79-18"></a>  d &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data=</span><span class="dv">0</span>, <span class="dt">nrow=</span>n, <span class="dv">2</span>) <span class="co"># in this case 2 because we have depth and number</span></span>
<span id="cb79-19"><a href="chapter5.html#cb79-19"></a>  sum_diffs &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># suma de los vectores (d-dbar)(d-dbar)&#39;</span></span>
<span id="cb79-20"><a href="chapter5.html#cb79-20"></a>  </span>
<span id="cb79-21"><a href="chapter5.html#cb79-21"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="kw">nrow</span>(data))){</span>
<span id="cb79-22"><a href="chapter5.html#cb79-22"></a>  y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(data[i, y1], data[i, y2]))</span>
<span id="cb79-23"><a href="chapter5.html#cb79-23"></a>  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(data[i, x1], data[i, x2]))</span>
<span id="cb79-24"><a href="chapter5.html#cb79-24"></a>  diff_xy &lt;-<span class="st"> </span>(y <span class="op">-</span><span class="st"> </span>x) </span>
<span id="cb79-25"><a href="chapter5.html#cb79-25"></a>  diff_xy_d &lt;-<span class="st"> </span>diff_xy <span class="op">-</span><span class="st"> </span>d_bar_vector</span>
<span id="cb79-26"><a href="chapter5.html#cb79-26"></a>  aux &lt;-<span class="st"> </span>diff_xy_d <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(diff_xy_d)</span>
<span id="cb79-27"><a href="chapter5.html#cb79-27"></a>  sum_diffs &lt;-<span class="st"> </span>sum_diffs <span class="op">+</span><span class="st"> </span>aux</span>
<span id="cb79-28"><a href="chapter5.html#cb79-28"></a>  }</span>
<span id="cb79-29"><a href="chapter5.html#cb79-29"></a>  <span class="co">#Sd: Cov</span></span>
<span id="cb79-30"><a href="chapter5.html#cb79-30"></a>  Sd &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(n<span class="dv">-1</span>) <span class="op">*</span>sum_diffs</span>
<span id="cb79-31"><a href="chapter5.html#cb79-31"></a>  <span class="kw">print</span>(<span class="st">&quot;* matrix Sd&quot;</span>)</span>
<span id="cb79-32"><a href="chapter5.html#cb79-32"></a>  <span class="kw">print</span>(Sd)</span>
<span id="cb79-33"><a href="chapter5.html#cb79-33"></a>  T2 &lt;-<span class="st"> </span><span class="kw">t</span>(d_bar_vector) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(Sd<span class="op">/</span>n) <span class="op">%*%</span><span class="st"> </span>d_bar_vector</span>
<span id="cb79-34"><a href="chapter5.html#cb79-34"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;T2 statistic: &quot;</span>, T2, <span class="st">&quot;with p=2 and n-1: &quot;</span>, n<span class="dv">-1</span> ))</span>
<span id="cb79-35"><a href="chapter5.html#cb79-35"></a>  <span class="kw">print</span>(<span class="st">&quot;see: table A7. If T2 &gt; for a given alpha, reject H0 &quot;</span>)</span>
<span id="cb79-36"><a href="chapter5.html#cb79-36"></a>  </span>
<span id="cb79-37"><a href="chapter5.html#cb79-37"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="chapter5.html#cb80-1"></a>T2 &lt;-<span class="st"> </span><span class="kw">cal_T2_test</span>(data572, <span class="dt">y1=</span><span class="dv">1</span>, <span class="dt">y2=</span><span class="dv">2</span>, <span class="dt">x1=</span><span class="dv">3</span>, <span class="dt">x2=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] &quot;d_bar_y1x1:  8&quot;
## [1] &quot;d_bar_y2x2:  3.06666666666667&quot;
## [1] &quot;* matrix Sd&quot;
##           [,1]     [,2]
## [1,] 121.57143 17.07143
## [2,]  17.07143 21.78095
## [1] &quot;T2 statistic:  10.8188985401983 with p=2 and n-1:  14&quot;
## [1] &quot;see: table A7. If T2 &gt; for a given alpha, reject H0 &quot;</code></pre>
<p>For this case, if wee look in table A7 th critical value is 8.197. And conclude the two coating differ in their effect on corrosion.</p>
</div>
</div>
<div id="test-for-aditional-information" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> Test for Aditional Information</h2>
<p>In this section we again consider <strong>two independent samples</strong> in section <span class="math inline">\(5.4\)</span>. We start with a basic <span class="math inline">\(p x 1\)</span> vector y of measurements on each sampling unit and <strong>ask</strong> whether a <span class="math inline">\(q x 1\)</span> subvector <strong>x</strong> measured in addition to <span class="math inline">\(y\)</span> (on the same unit) <strong>will significantly increase the separation of the two samples</strong> as shown by <span class="math inline">\(T^2\)</span>`.</p>
<p>Or, we may be interested in determining <strong>whether some of the variables we already have are redundant</strong> in the presence of other variables in terms of separating the groups, in terms of <strong>separating the groups</strong>.</p>
<p>In short: we wish to test the hypothesis that <span class="math inline">\(x_{1}\)</span> and <span class="math inline">\(x_{2}\)</span> are <strong>redundant</strong> for separating the two groups: that is, that the extra <span class="math inline">\(q\)</span> variables <strong>do no</strong> contribute anything significant beyond the information already available in <span class="math inline">\(y_{1}\)</span> and <span class="math inline">\(y_{2}\)</span> for seperating the groups.</p>
<p><strong>Notice!</strong> We area not asking whether <span class="math inline">\(x\)</span>’s can signigicantly separate the two groups by themselves, but whether they provide additional separation beyond the separation already achieved by the <span class="math inline">\(y\)</span>’s.</p>
<hr />
<blockquote>
<p><span class="math inline">\(H_{0}\)</span>: redundancy of <strong>x</strong>.</p>
</blockquote>
<blockquote>
<p>We reject hypothesis of redundancy if <span class="math inline">\(F&gt;= F_{\alpha, q, \nu-p-q+1}\)</span></p>
</blockquote>
<hr />
<p>If <span class="math inline">\(x\)</span>’s were independent of <span class="math inline">\(y\)</span>’s, we would have <span class="math inline">\(T^2_{p+q}=T^2_p+T^2_q\)</span>, but this does not hold because they are correlated. Therefore, we can only inquiry <strong>whether the increase from <span class="math inline">\(T^2_p\)</span> to <span class="math inline">\(T^2_{p+q)}\)</span> is significant</strong>.</p>
<p><span class="math inline">\(T^2\)</span>-statistic, based on the full set of <span class="math inline">\(p+q\)</span> variables is given by:</p>
<p><span class="math display">\[
T^2_{p+q}=\frac{n_1n_2}{n_1+n_2}
\Big(\begin{bmatrix}
    \bar{y}_1\\
    \bar{x}_1
\end{bmatrix}
-
\begin{bmatrix}
    \bar{y}_2\\
    \bar{x}_2
\end{bmatrix}\Big)&#39;\textbf{S}_{pl}^{-1}\Big(\begin{bmatrix}
    \bar{y}_1\\
    \bar{x}_1
\end{bmatrix}
-
\begin{bmatrix}
    \bar{y}_2\\
    \bar{x}_2
\end{bmatrix}\Big)
\]</span></p>
<p>Whereas <span class="math inline">\(T^2\)</span>, for the reduced set of <span class="math inline">\(p\)</span> variables is:</p>
<p><span class="math display">\[T^2_p=\frac{n_1n_2}{n_1+n_2}(\bar{y}_1- \bar{y}_2)&#39;\textbf{S}_{yy}^{-1}(\bar{y}_1- \bar{y}_2)\]</span></p>
<p>Then the test statistic for the significance of the increase from <span class="math inline">\(T^2_P\)</span> to <span class="math inline">\(T^2_{p+q}\)</span> is given by:</p>
<p><span class="math display">\[
T^2(x|y)= (\nu-p)\frac{T^2_{p+q}-T^2_p}{\nu+T^2_p}
\]</span></p>
<p>which is distributed as <span class="math inline">\(T^2_{q, \nu-p}\)</span>. We reject the hyphotesis of redundancy of <span class="math inline">\(x\)</span> if <span class="math inline">\(T^2(x|y) &gt;= T^2_{\alpha, q,\nu-p}\)</span></p>
<p><span class="math inline">\(T^2(x|y)\)</span> can be also converted to an <span class="math inline">\(F\)</span>-statistic:</p>
<p><span class="math display">\[
F=\frac{\nu-p-q+1}{q}\frac{T^2_{p+q}-T^2_p}{\nu+ T^2_p}
\]</span></p>
<p>Which is distributed as <span class="math inline">\(F_{q, \nu-p-q+1}\)</span>, and we reject the hypothesis of redundacy if <span class="math inline">\(F&gt;= F_{\alpha, q, \nu-p-q+1}\)</span></p>
<div id="example-5.8" class="section level3" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> Example 5.8</h3>
<p>We use the psychological data of Table <span class="math inline">\(5.1\)</span> to illustrate tests on subvectors. We begin by testing the significance of <span class="math inline">\(y_{3}\)</span> and <span class="math inline">\(y_{4}\)</span> above and beyond <span class="math inline">\(y_{1}\)</span> and <span class="math inline">\(y_{2}\)</span> (In the notation of the present section,<span class="math inline">\(y_{3}\)</span> and <span class="math inline">\(y_{4}\)</span> become <span class="math inline">\(x_{1}\)</span> and <span class="math inline">\(x_{2}\)</span>).</p>
<blockquote>
<p><span class="math inline">\(H_{0}\)</span>: <span class="math inline">\(y_3\)</span> and <span class="math inline">\(y_4\)</span> are redundant on <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span>.</p>
</blockquote>
<p>For these subvectors, <span class="math inline">\(p = 2\)</span> and <span class="math inline">\(q = 2\)</span>. The value of <span class="math inline">\(T^2_{p+q}\)</span> for all four variables as given by (5.27) was obtained in Example <span class="math inline">\(5.4.2\)</span> as <span class="math inline">\(97.6015\)</span>.</p>
<p>Thus, for <span class="math inline">\(y_{1}\)</span> and <span class="math inline">\(y_{2}\)</span> we obtain, by (5.28), the <span class="math inline">\(T^2\)</span>-statistic for the reduced set of <span class="math inline">\(p\)</span> variables:</p>
<p><span class="math display">\[
T_{p}^{2}= \frac{n_{1}n_{2}}{n_{1}+n_{2}}(\bar{y_1}-\bar{y_2})&#39;S_{yy}^{-1}(\bar{y_{1}}-\bar{y_{2}})
\]</span></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="chapter5.html#cb82-1"></a>T2_reduced &lt;-<span class="st"> </span>{<span class="kw">nrow</span>(data542_male)<span class="op">*</span><span class="kw">nrow</span>(data542_female)}<span class="op">/</span>{<span class="kw">nrow</span>(data542_male)<span class="op">+</span><span class="st"> </span><span class="kw">nrow</span>(data542_female)}</span></code></pre></div>
<p>First, we get the reduced data samples.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="chapter5.html#cb83-1"></a><span class="co">##filter variables of interest from each dataset</span></span>
<span id="cb83-2"><a href="chapter5.html#cb83-2"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;tidyverse&quot;</span>)){</span>
<span id="cb83-3"><a href="chapter5.html#cb83-3"></a>  <span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb83-4"><a href="chapter5.html#cb83-4"></a>  <span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb83-5"><a href="chapter5.html#cb83-5"></a>  }</span>
<span id="cb83-6"><a href="chapter5.html#cb83-6"></a>  data542_female_reduced &lt;-<span class="st"> </span>data542_female <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(y_1f, y_2f) <span class="co">#we select the variables of data1 we are interested in</span></span>
<span id="cb83-7"><a href="chapter5.html#cb83-7"></a>  data542_male_reduced &lt;-<span class="st"> </span>data542_male <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(y_1m, y_2m) <span class="co">#we select the variables of data2 we are interested in</span></span></code></pre></div>
<p>Second, with the reduced version of the data samples, we have enough elements to find the <span class="math inline">\(T^2\)</span>-statistic for the reduced set of <span class="math inline">\(p\)</span> variables:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="chapter5.html#cb84-1"></a><span class="co">#function for finding the T^2-statistic for the reduced set of p variables:</span></span>
<span id="cb84-2"><a href="chapter5.html#cb84-2"></a></span>
<span id="cb84-3"><a href="chapter5.html#cb84-3"></a>T2_two_sample_reduced&lt;-<span class="st"> </span><span class="cf">function</span>(data1_reduced, data2_reduced) {</span>
<span id="cb84-4"><a href="chapter5.html#cb84-4"></a>  <span class="st">&quot;</span></span>
<span id="cb84-5"><a href="chapter5.html#cb84-5"></a><span class="st">  Function to obtain T2 for the reduced set of p            variables.</span></span>
<span id="cb84-6"><a href="chapter5.html#cb84-6"></a><span class="st">  &quot;</span></span>
<span id="cb84-7"><a href="chapter5.html#cb84-7"></a>  n_<span class="dv">1</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data1_reduced)</span>
<span id="cb84-8"><a href="chapter5.html#cb84-8"></a>  n_<span class="dv">2</span>&lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data2_reduced)</span>
<span id="cb84-9"><a href="chapter5.html#cb84-9"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1_reduced) </span>
<span id="cb84-10"><a href="chapter5.html#cb84-10"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2_reduced)</span>
<span id="cb84-11"><a href="chapter5.html#cb84-11"></a>  </span>
<span id="cb84-12"><a href="chapter5.html#cb84-12"></a>  y_mean_<span class="dv">1</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb84-13"><a href="chapter5.html#cb84-13"></a>  <span class="kw">apply</span>(data1_reduced, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb84-14"><a href="chapter5.html#cb84-14"></a>        )</span>
<span id="cb84-15"><a href="chapter5.html#cb84-15"></a>  ) </span>
<span id="cb84-16"><a href="chapter5.html#cb84-16"></a>  </span>
<span id="cb84-17"><a href="chapter5.html#cb84-17"></a>  y_mean_<span class="dv">2</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb84-18"><a href="chapter5.html#cb84-18"></a>  <span class="kw">apply</span>(data2_reduced, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb84-19"><a href="chapter5.html#cb84-19"></a>        )</span>
<span id="cb84-20"><a href="chapter5.html#cb84-20"></a>  ) </span>
<span id="cb84-21"><a href="chapter5.html#cb84-21"></a>  sigma_population_reduced&lt;-(</span>
<span id="cb84-22"><a href="chapter5.html#cb84-22"></a>    <span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)</span>
<span id="cb84-23"><a href="chapter5.html#cb84-23"></a>    )<span class="op">*</span>(</span>
<span id="cb84-24"><a href="chapter5.html#cb84-24"></a>    (n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span></span>
<span id="cb84-25"><a href="chapter5.html#cb84-25"></a>    )</span>
<span id="cb84-26"><a href="chapter5.html#cb84-26"></a>  p &lt;-<span class="st"> </span><span class="kw">ncol</span>(data1_reduced)</span>
<span id="cb84-27"><a href="chapter5.html#cb84-27"></a>  sigma_population_reduced_inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma_population_reduced)</span>
<span id="cb84-28"><a href="chapter5.html#cb84-28"></a>  T2_reduced &lt;&lt;-<span class="st"> </span>((n_<span class="dv">1</span><span class="op">*</span>n_<span class="dv">2</span>)<span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span>))<span class="op">*</span><span class="kw">t</span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>) <span class="op">%*%</span><span class="st"> </span>sigma_population_reduced_inverse <span class="op">%*%</span><span class="st"> </span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>)</span>
<span id="cb84-29"><a href="chapter5.html#cb84-29"></a>  </span>
<span id="cb84-30"><a href="chapter5.html#cb84-30"></a>  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;The pooled covariance matrix of the reduced set of &quot;</span>, p, <span class="st">&quot; variables is:&quot;</span>))</span>
<span id="cb84-31"><a href="chapter5.html#cb84-31"></a>  <span class="kw">print</span>(sigma_population_reduced)</span>
<span id="cb84-32"><a href="chapter5.html#cb84-32"></a>  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;The value of T2 for the reduced set of &quot;</span>, p, <span class="st">&quot; variables is:&quot;</span>))</span>
<span id="cb84-33"><a href="chapter5.html#cb84-33"></a>  <span class="kw">print</span> (<span class="kw">round</span>(T2_reduced, <span class="dv">4</span>))</span>
<span id="cb84-34"><a href="chapter5.html#cb84-34"></a></span>
<span id="cb84-35"><a href="chapter5.html#cb84-35"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="chapter5.html#cb85-1"></a><span class="kw">T2_two_sample_reduced</span>(data542_female_reduced, data542_male_reduced)</span></code></pre></div>
<pre><code>## [1] &quot;The pooled covariance matrix of the reduced set of 2 variables is:&quot;
##          y_1f      y_2f
## y_1f 7.164315  6.047379
## y_2f 6.047379 15.894153
## [1] &quot;The value of T2 for the reduced set of 2 variables is:&quot;
##         [,1]
## [1,] 31.0126</code></pre>
<p>Third, we are ready to test redundancy of variables or significance of the increase from <span class="math inline">\(T_p^2\)</span> to <span class="math inline">\(T_{p+q}^2\)</span>. The null hyphotesis is: redundancy of x. We reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(T^2_(x|y)&gt;=T^2_(\alpha, q,\nu-p)\)</span></p>
<p>We can also convert <span class="math inline">\(T^2(x|y)\)</span> to an F-statistic:</p>
<p><span class="math display">\[F=\frac{\nu-p-q-1}{q}*\frac{T^2_{p+q}-T^2_p}{v+T^2_p}\]</span></p>
<p>Then, we reject <span class="math inline">\(H_{0}\)</span> if <span class="math inline">\(F&gt;=F_{\alpha, q, \nu-p-q+1}\)</span>.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="chapter5.html#cb87-1"></a><span class="co">#Function to test redundancy of variables or significance of the increase from Tp^2 to Tp+q^2</span></span>
<span id="cb87-2"><a href="chapter5.html#cb87-2"></a></span>
<span id="cb87-3"><a href="chapter5.html#cb87-3"></a>test_redundancy_additional_information &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2, data1_reduced, data2_reduced, alpha) {</span>
<span id="cb87-4"><a href="chapter5.html#cb87-4"></a>  <span class="st">&quot;</span></span>
<span id="cb87-5"><a href="chapter5.html#cb87-5"></a><span class="st">  This function tests the statistic significance of the increase from T_p^2 to T_{p+q}^2. </span></span>
<span id="cb87-6"><a href="chapter5.html#cb87-6"></a><span class="st">  H0: Redundancy of x </span></span>
<span id="cb87-7"><a href="chapter5.html#cb87-7"></a><span class="st">  We reject H0 if T^2_(x|y)&gt;=T^2_(alpha, q, niu-p)</span></span>
<span id="cb87-8"><a href="chapter5.html#cb87-8"></a><span class="st">  Or, if we convert T^2_(x|y) to an F-statistic: we reject H0 if F&gt;=F_{alpha, q, niu-p-q+1}</span></span>
<span id="cb87-9"><a href="chapter5.html#cb87-9"></a></span>
<span id="cb87-10"><a href="chapter5.html#cb87-10"></a><span class="st">  Input: </span></span>
<span id="cb87-11"><a href="chapter5.html#cb87-11"></a><span class="st">  + data1: dataset from sample 1</span></span>
<span id="cb87-12"><a href="chapter5.html#cb87-12"></a><span class="st">  + data2: dataset from sample 2</span></span>
<span id="cb87-13"><a href="chapter5.html#cb87-13"></a><span class="st">  + data1_reduced: dataset from sample 1 with selected variables of interest</span></span>
<span id="cb87-14"><a href="chapter5.html#cb87-14"></a><span class="st">  + data2_reduced: dataset from sample 2 with selected variables of interest</span></span>
<span id="cb87-15"><a href="chapter5.html#cb87-15"></a><span class="st">  + alpha: significance level</span></span>
<span id="cb87-16"><a href="chapter5.html#cb87-16"></a></span>
<span id="cb87-17"><a href="chapter5.html#cb87-17"></a><span class="st">  &quot;</span></span>
<span id="cb87-18"><a href="chapter5.html#cb87-18"></a>  <span class="co">#package for hotelling testing</span></span>
<span id="cb87-19"><a href="chapter5.html#cb87-19"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;ICSNP&quot;</span>)){</span>
<span id="cb87-20"><a href="chapter5.html#cb87-20"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;ICSNP&quot;</span>)</span>
<span id="cb87-21"><a href="chapter5.html#cb87-21"></a>    <span class="kw">library</span>(ICSNP)</span>
<span id="cb87-22"><a href="chapter5.html#cb87-22"></a>    }</span>
<span id="cb87-23"><a href="chapter5.html#cb87-23"></a>  n_<span class="dv">1</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb87-24"><a href="chapter5.html#cb87-24"></a>  n_<span class="dv">2</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb87-25"><a href="chapter5.html#cb87-25"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1)</span>
<span id="cb87-26"><a href="chapter5.html#cb87-26"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2)</span>
<span id="cb87-27"><a href="chapter5.html#cb87-27"></a>  </span>
<span id="cb87-28"><a href="chapter5.html#cb87-28"></a>  y_mean_<span class="dv">1</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb87-29"><a href="chapter5.html#cb87-29"></a>  <span class="kw">apply</span>(data1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb87-30"><a href="chapter5.html#cb87-30"></a>        )</span>
<span id="cb87-31"><a href="chapter5.html#cb87-31"></a>  )</span>
<span id="cb87-32"><a href="chapter5.html#cb87-32"></a>  </span>
<span id="cb87-33"><a href="chapter5.html#cb87-33"></a>  y_mean_<span class="dv">2</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb87-34"><a href="chapter5.html#cb87-34"></a>  <span class="kw">apply</span>(data2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb87-35"><a href="chapter5.html#cb87-35"></a>        )</span>
<span id="cb87-36"><a href="chapter5.html#cb87-36"></a>  )</span>
<span id="cb87-37"><a href="chapter5.html#cb87-37"></a>  sigma_population&lt;-(</span>
<span id="cb87-38"><a href="chapter5.html#cb87-38"></a>    <span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)</span>
<span id="cb87-39"><a href="chapter5.html#cb87-39"></a>    )<span class="op">*</span>(</span>
<span id="cb87-40"><a href="chapter5.html#cb87-40"></a>    (n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span></span>
<span id="cb87-41"><a href="chapter5.html#cb87-41"></a>    )</span>
<span id="cb87-42"><a href="chapter5.html#cb87-42"></a>  </span>
<span id="cb87-43"><a href="chapter5.html#cb87-43"></a>  sigma_population_inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma_population)</span>
<span id="cb87-44"><a href="chapter5.html#cb87-44"></a>  T2 &lt;&lt;-<span class="st"> </span>((n_<span class="dv">1</span><span class="op">*</span>n_<span class="dv">2</span>)<span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span>))<span class="op">*</span><span class="kw">t</span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>) <span class="op">%*%</span><span class="st"> </span>sigma_population_inverse <span class="op">%*%</span><span class="st"> </span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>)</span>
<span id="cb87-45"><a href="chapter5.html#cb87-45"></a>  </span>
<span id="cb87-46"><a href="chapter5.html#cb87-46"></a>  n_<span class="dv">1</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data1_reduced)</span>
<span id="cb87-47"><a href="chapter5.html#cb87-47"></a>  n_<span class="dv">2</span>&lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data2_reduced)</span>
<span id="cb87-48"><a href="chapter5.html#cb87-48"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1_reduced) </span>
<span id="cb87-49"><a href="chapter5.html#cb87-49"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2_reduced)</span>
<span id="cb87-50"><a href="chapter5.html#cb87-50"></a>  </span>
<span id="cb87-51"><a href="chapter5.html#cb87-51"></a>  y_mean_<span class="dv">1</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb87-52"><a href="chapter5.html#cb87-52"></a>  <span class="kw">apply</span>(data1_reduced, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb87-53"><a href="chapter5.html#cb87-53"></a>        )</span>
<span id="cb87-54"><a href="chapter5.html#cb87-54"></a>  ) </span>
<span id="cb87-55"><a href="chapter5.html#cb87-55"></a>  </span>
<span id="cb87-56"><a href="chapter5.html#cb87-56"></a>  y_mean_<span class="dv">2</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb87-57"><a href="chapter5.html#cb87-57"></a>  <span class="kw">apply</span>(data2_reduced, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb87-58"><a href="chapter5.html#cb87-58"></a>        )</span>
<span id="cb87-59"><a href="chapter5.html#cb87-59"></a>  ) </span>
<span id="cb87-60"><a href="chapter5.html#cb87-60"></a>  sigma_population_reduced&lt;-(</span>
<span id="cb87-61"><a href="chapter5.html#cb87-61"></a>    <span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)</span>
<span id="cb87-62"><a href="chapter5.html#cb87-62"></a>    )<span class="op">*</span>(</span>
<span id="cb87-63"><a href="chapter5.html#cb87-63"></a>    (n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span></span>
<span id="cb87-64"><a href="chapter5.html#cb87-64"></a>    )</span>
<span id="cb87-65"><a href="chapter5.html#cb87-65"></a>  p &lt;-<span class="st"> </span><span class="kw">ncol</span>(data1_reduced)</span>
<span id="cb87-66"><a href="chapter5.html#cb87-66"></a>  q &lt;-<span class="st"> </span><span class="kw">ncol</span>(data1)<span class="op">-</span><span class="kw">ncol</span>(data1_reduced)</span>
<span id="cb87-67"><a href="chapter5.html#cb87-67"></a>  sigma_population_reduced_inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma_population_reduced)</span>
<span id="cb87-68"><a href="chapter5.html#cb87-68"></a>  T2_reduced &lt;&lt;-<span class="st"> </span>((n_<span class="dv">1</span><span class="op">*</span>n_<span class="dv">2</span>)<span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span>))<span class="op">*</span><span class="kw">t</span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>) <span class="op">%*%</span><span class="st"> </span>sigma_population_reduced_inverse <span class="op">%*%</span><span class="st"> </span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>)</span>
<span id="cb87-69"><a href="chapter5.html#cb87-69"></a>  niu=n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span></span>
<span id="cb87-70"><a href="chapter5.html#cb87-70"></a>  T2_significance_increase &lt;&lt;-<span class="st"> </span>(niu<span class="op">-</span>p)<span class="op">*</span>(T2<span class="op">-</span>T2_reduced)<span class="op">/</span>(niu<span class="op">+</span>T2_reduced)</span>
<span id="cb87-71"><a href="chapter5.html#cb87-71"></a>  F =<span class="st"> </span>((niu<span class="op">-</span>p<span class="op">-</span>q<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>q)<span class="op">*</span>(T2<span class="op">-</span>T2_reduced)<span class="op">/</span>(niu<span class="op">+</span>T2_reduced)</span>
<span id="cb87-72"><a href="chapter5.html#cb87-72"></a>  df1=q</span>
<span id="cb87-73"><a href="chapter5.html#cb87-73"></a>  df2=niu<span class="op">-</span>p<span class="op">-</span>q<span class="op">+</span><span class="dv">1</span></span>
<span id="cb87-74"><a href="chapter5.html#cb87-74"></a>  <span class="kw">print</span>(</span>
<span id="cb87-75"><a href="chapter5.html#cb87-75"></a>    <span class="st">&quot;The pooled covariance matrix is:&quot;</span></span>
<span id="cb87-76"><a href="chapter5.html#cb87-76"></a>    )</span>
<span id="cb87-77"><a href="chapter5.html#cb87-77"></a>  <span class="kw">print</span>(</span>
<span id="cb87-78"><a href="chapter5.html#cb87-78"></a>    <span class="kw">round</span>(sigma_population,<span class="dv">4</span></span>
<span id="cb87-79"><a href="chapter5.html#cb87-79"></a>          )</span>
<span id="cb87-80"><a href="chapter5.html#cb87-80"></a>    )</span>
<span id="cb87-81"><a href="chapter5.html#cb87-81"></a>  <span class="kw">print</span>(</span>
<span id="cb87-82"><a href="chapter5.html#cb87-82"></a>    <span class="kw">paste0</span>(</span>
<span id="cb87-83"><a href="chapter5.html#cb87-83"></a>      <span class="st">&quot;The value of T2 is: &quot;</span>, <span class="kw">round</span>(T2,<span class="dv">4</span>) </span>
<span id="cb87-84"><a href="chapter5.html#cb87-84"></a>      )</span>
<span id="cb87-85"><a href="chapter5.html#cb87-85"></a>    )  </span>
<span id="cb87-86"><a href="chapter5.html#cb87-86"></a>  </span>
<span id="cb87-87"><a href="chapter5.html#cb87-87"></a>  <span class="kw">print</span>(</span>
<span id="cb87-88"><a href="chapter5.html#cb87-88"></a>    <span class="kw">paste0</span>(</span>
<span id="cb87-89"><a href="chapter5.html#cb87-89"></a>      <span class="st">&quot;The pooled covariance matrix of the reduced set of &quot;</span>, p, <span class="st">&quot; variables is:&quot;</span></span>
<span id="cb87-90"><a href="chapter5.html#cb87-90"></a>      )</span>
<span id="cb87-91"><a href="chapter5.html#cb87-91"></a>    )</span>
<span id="cb87-92"><a href="chapter5.html#cb87-92"></a>  <span class="kw">print</span>(</span>
<span id="cb87-93"><a href="chapter5.html#cb87-93"></a>    <span class="kw">round</span>(</span>
<span id="cb87-94"><a href="chapter5.html#cb87-94"></a>      sigma_population_reduced, <span class="dv">4</span></span>
<span id="cb87-95"><a href="chapter5.html#cb87-95"></a>      )</span>
<span id="cb87-96"><a href="chapter5.html#cb87-96"></a>    )</span>
<span id="cb87-97"><a href="chapter5.html#cb87-97"></a>  <span class="kw">print</span>(</span>
<span id="cb87-98"><a href="chapter5.html#cb87-98"></a>    <span class="kw">paste0</span>(</span>
<span id="cb87-99"><a href="chapter5.html#cb87-99"></a>      <span class="st">&quot;The value of T2 for the reduced set of &quot;</span>, p, <span class="st">&quot; variables is:&quot;</span></span>
<span id="cb87-100"><a href="chapter5.html#cb87-100"></a>      )</span>
<span id="cb87-101"><a href="chapter5.html#cb87-101"></a>    )</span>
<span id="cb87-102"><a href="chapter5.html#cb87-102"></a>  <span class="kw">print</span>(</span>
<span id="cb87-103"><a href="chapter5.html#cb87-103"></a>    <span class="kw">round</span>(</span>
<span id="cb87-104"><a href="chapter5.html#cb87-104"></a>      T2_reduced, <span class="dv">4</span></span>
<span id="cb87-105"><a href="chapter5.html#cb87-105"></a>      )</span>
<span id="cb87-106"><a href="chapter5.html#cb87-106"></a>    )</span>
<span id="cb87-107"><a href="chapter5.html#cb87-107"></a>  <span class="kw">print</span>(</span>
<span id="cb87-108"><a href="chapter5.html#cb87-108"></a>    <span class="kw">paste0</span>(</span>
<span id="cb87-109"><a href="chapter5.html#cb87-109"></a>    <span class="st">&quot;The results of the test statistic for the significance of the increase from &quot;</span>, <span class="kw">round</span>(T2_reduced,<span class="dv">4</span>), <span class="st">&quot; to &quot;</span>, <span class="kw">round</span>(T2, <span class="dv">4</span>), <span class="st">&quot; is &quot;</span></span>
<span id="cb87-110"><a href="chapter5.html#cb87-110"></a>    )</span>
<span id="cb87-111"><a href="chapter5.html#cb87-111"></a>  )</span>
<span id="cb87-112"><a href="chapter5.html#cb87-112"></a>  <span class="kw">print</span>(</span>
<span id="cb87-113"><a href="chapter5.html#cb87-113"></a>    <span class="kw">round</span>(</span>
<span id="cb87-114"><a href="chapter5.html#cb87-114"></a>      T2_significance_increase, <span class="dv">4</span></span>
<span id="cb87-115"><a href="chapter5.html#cb87-115"></a>      )</span>
<span id="cb87-116"><a href="chapter5.html#cb87-116"></a>    )</span>
<span id="cb87-117"><a href="chapter5.html#cb87-117"></a></span>
<span id="cb87-118"><a href="chapter5.html#cb87-118"></a>  <span class="kw">print</span>(</span>
<span id="cb87-119"><a href="chapter5.html#cb87-119"></a>    <span class="kw">paste0</span>(</span>
<span id="cb87-120"><a href="chapter5.html#cb87-120"></a>      <span class="st">&quot;T2 test statistic transformed to an F-statistic is: &quot;</span>, <span class="kw">round</span>(F,<span class="dv">4</span>)</span>
<span id="cb87-121"><a href="chapter5.html#cb87-121"></a>           )</span>
<span id="cb87-122"><a href="chapter5.html#cb87-122"></a>    )</span>
<span id="cb87-123"><a href="chapter5.html#cb87-123"></a>  <span class="kw">print</span>(</span>
<span id="cb87-124"><a href="chapter5.html#cb87-124"></a>    <span class="kw">paste0</span>(</span>
<span id="cb87-125"><a href="chapter5.html#cb87-125"></a>      <span class="st">&quot;F-critical value: &quot;</span>, <span class="kw">round</span>(<span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha, df1, df2), <span class="dv">5</span>) , <span class="st">&quot; with &quot;</span>, df1,<span class="st">&quot; and &quot;</span>, df2, <span class="st">&quot; degrees of freedom&quot;</span>, <span class="dt">sep=</span><span class="st">&quot; &quot;</span></span>
<span id="cb87-126"><a href="chapter5.html#cb87-126"></a>      )</span>
<span id="cb87-127"><a href="chapter5.html#cb87-127"></a>    )</span>
<span id="cb87-128"><a href="chapter5.html#cb87-128"></a>  <span class="kw">print</span>(</span>
<span id="cb87-129"><a href="chapter5.html#cb87-129"></a>    <span class="kw">paste0</span>(</span>
<span id="cb87-130"><a href="chapter5.html#cb87-130"></a>      <span class="st">&quot;Reject H0: &quot;</span>, F <span class="op">&gt;</span><span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha, df1, df2)</span>
<span id="cb87-131"><a href="chapter5.html#cb87-131"></a>      )</span>
<span id="cb87-132"><a href="chapter5.html#cb87-132"></a>    )</span>
<span id="cb87-133"><a href="chapter5.html#cb87-133"></a>  <span class="kw">print</span>(</span>
<span id="cb87-134"><a href="chapter5.html#cb87-134"></a>    <span class="kw">paste0</span>(</span>
<span id="cb87-135"><a href="chapter5.html#cb87-135"></a>      <span class="st">&quot;P-value: &quot;</span>, (<span class="kw">pf</span>(F,df1, df2, <span class="dt">lower.tail =</span> F))</span>
<span id="cb87-136"><a href="chapter5.html#cb87-136"></a>      )</span>
<span id="cb87-137"><a href="chapter5.html#cb87-137"></a>    )</span>
<span id="cb87-138"><a href="chapter5.html#cb87-138"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="chapter5.html#cb88-1"></a><span class="kw">test_redundancy_additional_information</span>(data542_female, data542_male, data542_female_reduced, data542_male_reduced, <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The pooled covariance matrix is:&quot;
##        y_1f    y_2f    y_3f    y_4f
## y_1f 7.1643  6.0474  5.6930  4.7006
## y_2f 6.0474 15.8942  8.4924  5.8558
## y_3f 5.6930  8.4924 29.3564 13.9808
## y_4f 4.7006  5.8558 13.9808 22.3206
## [1] &quot;The value of T2 is: 97.6015&quot;
## [1] &quot;The pooled covariance matrix of the reduced set of 2 variables is:&quot;
##        y_1f    y_2f
## y_1f 7.1643  6.0474
## y_2f 6.0474 15.8942
## [1] &quot;The value of T2 for the reduced set of 2 variables is:&quot;
##         [,1]
## [1,] 31.0126
## [1] &quot;The results of the test statistic for the significance of the increase from 31.0126 to 97.6015 is &quot;
##         [,1]
## [1,] 42.9548
## [1] &quot;T2 test statistic transformed to an F-statistic is: 21.1194&quot;
## [1] &quot;F-critical value: 3.15312 with 2 and 59 degrees of freedom &quot;
## [1] &quot;Reject H0: TRUE&quot;
## [1] &quot;P-value: 0.999999879110234&quot;</code></pre>
<p>Therefore we conclude that <span class="math inline">\(x=(y_3, y_4)&#39;\)</span> adds a significant amount of separation to <span class="math inline">\(y=(y_1,y_2)&#39;\)</span>.</p>
<p>If we want to test the effect of each variable adjusted to the rest of the variables, we just need to redefine the data samples from which to pooled. Notice that when we are testing the effect of adding a single <span class="math inline">\(x\)</span>, then <span class="math inline">\(t^2_{\alpha/2, \nu -p}= F_{\alpha, 1, \nu-p}\)</span>.</p>
<p>For illustration purposes we will only evaluate the effect of <span class="math inline">\(y_1\)</span> on the other three variables.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="chapter5.html#cb90-1"></a><span class="co">##filter variables of interest from each dataset: we keep everyvariable by y_1</span></span>
<span id="cb90-2"><a href="chapter5.html#cb90-2"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;tidyverse&quot;</span>)){</span>
<span id="cb90-3"><a href="chapter5.html#cb90-3"></a>  <span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb90-4"><a href="chapter5.html#cb90-4"></a>  <span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb90-5"><a href="chapter5.html#cb90-5"></a>  }</span>
<span id="cb90-6"><a href="chapter5.html#cb90-6"></a>  data542_female_reduced_y1&lt;-<span class="st"> </span>data542_female <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(y_2f, y_3f,y_4f) <span class="co">#we select the variables of data1 we are interested in</span></span>
<span id="cb90-7"><a href="chapter5.html#cb90-7"></a>  data542_male_reduced_y1&lt;-<span class="st"> </span>data542_male <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(y_2m, y_3m, y_4m) <span class="co">#we select the variables of data2 we are interested in</span></span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="chapter5.html#cb91-1"></a><span class="kw">test_redundancy_additional_information</span>(data542_female, data542_male, data542_female_reduced_y1, data542_male_reduced_y1, <span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The pooled covariance matrix is:&quot;
##        y_1f    y_2f    y_3f    y_4f
## y_1f 7.1643  6.0474  5.6930  4.7006
## y_2f 6.0474 15.8942  8.4924  5.8558
## y_3f 5.6930  8.4924 29.3564 13.9808
## y_4f 4.7006  5.8558 13.9808 22.3206
## [1] &quot;The value of T2 is: 97.6015&quot;
## [1] &quot;The pooled covariance matrix of the reduced set of 3 variables is:&quot;
##         y_2f    y_3f    y_4f
## y_2f 15.8942  8.4924  5.8558
## y_3f  8.4924 29.3564 13.9808
## y_4f  5.8558 13.9808 22.3206
## [1] &quot;The value of T2 for the reduced set of 3 variables is:&quot;
##         [,1]
## [1,] 78.8733
## [1] &quot;The results of the test statistic for the significance of the increase from 78.8733 to 97.6015 is &quot;
##        [,1]
## [1,] 7.8437
## [1] &quot;T2 test statistic transformed to an F-statistic is: 7.8437&quot;
## [1] &quot;F-critical value: 4.00398 with 1 and 59 degrees of freedom &quot;
## [1] &quot;Reject H0: TRUE&quot;
## [1] &quot;P-value: 0.993115461108083&quot;</code></pre>
</div>
</div>
<div id="profile-analysis" class="section level2" number="5.9">
<h2><span class="header-section-number">5.9</span> Profile Analysis</h2>
<p>When multivariate data are the result of repeated measures, you might want to see how the mean is changing over time. As an example, you might have data on blood pressure taken once per month for the same set of patients.</p>
<p>Profile analysis can also be used when variables are not ordered in time (or any other way), but the values are on a similar scale, such as in psychological testing.</p>
<p><strong>Tecnical Note:</strong> A profile plot uses the subscript of the variable on the x-axis and the means μ1,…,μp on the y-axis. The pattern obtained by plotting <span class="math inline">\(\mu_{1}, \mu_{2}, ..., \mu_{p}\)</span> as ordinates and connecting the points is called <em>profile</em>. <strong>Profile Analysis</strong> is an analysis of the profile or a comparison of two or more profiles.</p>
<p>In a one sample setting, the null hypothesis that all means are equal <span class="math inline">\(H_{0} : \mu_1 = ··· = \mu_2\)</span> can be interpreted graphically as the hypothesis that the profile plot is flat. The alternative hypothesis is <span class="math inline">\(H_{1} : \mu_{i}\neq \mu_j\)</span> for for some <span class="math inline">\(i,j\)</span>.</p>
<blockquote>
<p>Note that these hypotheses are the same as for ANOVA, but the analysis will be different because the columns are not assumed to be independent. Here we have a single population but are sampling correlated variables from this population.</p>
</blockquote>
<p><strong>Parallelism</strong></p>
<p>Usually the main test of interest of profile analysis. It asks whether each segment is the same across all groups.</p>
<p>For two samples, <strong>the null hyphotesis that the two plots have the same slopes (are parallel)</strong> can be tested checking whether differences between means are equal for the two groups. This can be written as:</p>
<p><span class="math display">\[H_0=\mu_{i,j}-\mu_{i,j-1}= \mu_{2,j}-\mu_{2,j-1}\]</span>
for <span class="math inline">\(j=1, ..., p\)</span>. In matrix notation, this is:</p>
<p><span class="math display">\[H_{01}=\begin{pmatrix}
\mu_{12} &amp; -\mu_{11} \\
\mu_{12} &amp; -\mu_{11} \\
\vdots\\
\mu_{1p} &amp; -\mu_{1, p-1} \\
\end{pmatrix}=\begin{pmatrix}
\mu_{22} &amp; -\mu_{21} \\
\mu_{22} &amp; -\mu_{21} \\
\vdots\\
\mu_{2p} &amp; -\mu_{2, p-1} \\
\end{pmatrix}\]</span></p>
<p>which can be written as <span class="math inline">\(H_{01}:\mathbf{C\mu_1}=\mathbf{C\mu_2}\)</span>, using the contrast matrix:</p>
<p><span class="math display">\[\mathbf{C}=
\begin{pmatrix}
-1 &amp; 1 &amp; 0 &amp; \dots &amp; 0\\
0 &amp; -1 &amp; 1 &amp; \dots &amp;0 \\
\vdots&amp; \vdots&amp;\vdots &amp; &amp;\vdots\\
0&amp;0&amp;0 &amp; \dots &amp; 1
\end{pmatrix}\]</span></p>
<p>The test statistic is:</p>
<p>The biggest discrepancy in the slopes can be found by looking at the discriminant function, for which we use:</p>
<p><span class="math display">\[
\textbf{a}=(\textbf{C}S_{pl}\textbf{C&#39;})^{-1}\textbf{C}(\bar{y}_1- \bar{y}_2)
\]</span>
If the largest component of <span class="math inline">\(\textbf{a}\)</span> is <span class="math inline">\(a_i\)</span>, then the <span class="math inline">\(i\)</span> slope has largest violation of parallel slopes.</p>
<p><strong>Same overall level</strong></p>
<p>A second question is whether two samples have the same overall level, ignoring possible interaction.</p>
<p>This hyphotesis can be expressed as:</p>
<p><span class="math display">\[H_{0}: \mu_{11}+\dots + \mu_{1p}=\mu_{21}+ \cdots +\mu_{2p}\]</span>
or:</p>
<p><span class="math display">\[H_{0}=j&#39;(\mu_1-\mu_2)=0\]</span></p>
<p>In this case, the test statistic is:</p>
<p><span class="math display">\[t=\frac{j&#39;(\bar{y}_{1}-\bar{y}_2)}{\sqrt{j&#39;S_{pl}j(1/n_1+1/n_2)}}\]</span>
which has a t-distribution with <span class="math inline">\(n_1 +n_2 -2\)</span> degrees of freedom.</p>
<p><strong>Flatness</strong></p>
<p>A third hyphotesis is that the two profiles are both flat. Because the lack of parallelism automatically implies that at least one curve is not flat, the hypothesis that botch curves are flat is more interesting if the hyphotesis of parallelism cant be rejected.</p>
<div id="example-5.9.2" class="section level3" number="5.9.1">
<h3><span class="header-section-number">5.9.1</span> Example 5.9.2</h3>
<p>We use the psychological data in Table <span class="math inline">\(5.1\)</span> to illustrate two-sample profile analysis. The values of  <span class="math inline">\(\bar{y}_{1}\)</span>, <span class="math inline">\(\bar{y}_{2}\)</span> and <span class="math inline">\(\textbf{S}_{pl}\)</span> are given in Example <span class="math inline">\(5.4.2\)</span>. The profiles of the two mean vectors <span class="math inline">\(\bar{y}_{1}\)</span> and <span class="math inline">\(\bar{y}_{2}\)</span> are plotted in Figure <span class="math inline">\(5.8\)</span>. There appears to be a lack of parallelism.</p>
<p>To test for parallelism, <span class="math inline">\(H_{01}: \textbf{C}\mu_{1}= \textbf{C}\mu_{2}\)</span>, we use the matrix:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>First: data preparation, joining together both samples</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="chapter5.html#cb93-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb93-2"><a href="chapter5.html#cb93-2"></a>data542_female &lt;-<span class="st"> </span>data542_female <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dt">y1 =</span> y_1f, <span class="dt">y2=</span>y_2f, <span class="dt">y3=</span>y_3f, <span class="dt">y4=</span>y_4f) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">gender=</span><span class="st">&quot;female&quot;</span>)</span>
<span id="cb93-3"><a href="chapter5.html#cb93-3"></a></span>
<span id="cb93-4"><a href="chapter5.html#cb93-4"></a>data542_male &lt;-<span class="st"> </span>data542_male <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="dt">y1 =</span> y_1m, <span class="dt">y2=</span>y_2m, <span class="dt">y3=</span>y_3m, <span class="dt">y4=</span>y_4m) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">gender=</span><span class="st">&quot;male&quot;</span>)</span>
<span id="cb93-5"><a href="chapter5.html#cb93-5"></a></span>
<span id="cb93-6"><a href="chapter5.html#cb93-6"></a>data542 &lt;-<span class="st"> </span><span class="kw">rbind</span>(data542_female, data542_male)</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="chapter5.html#cb94-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb94-2"><a href="chapter5.html#cb94-2"></a>  data542, <span class="dt">caption =</span> <span class="st">&#39;Data Combine Exercise 5.42&#39;</span>,</span>
<span id="cb94-3"><a href="chapter5.html#cb94-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb94-4"><a href="chapter5.html#cb94-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-48">Table 5.6: </span>Data Combine Exercise 5.42</caption>
<thead>
<tr class="header">
<th align="right">y1</th>
<th align="right">y2</th>
<th align="right">y3</th>
<th align="right">y4</th>
<th align="left">gender</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">14</td>
<td align="right">12</td>
<td align="right">14</td>
<td align="right">26</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">14</td>
<td align="right">12</td>
<td align="right">21</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">19</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">13</td>
<td align="right">10</td>
<td align="right">16</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">20</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">9</td>
<td align="right">14</td>
<td align="right">18</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">13</td>
<td align="right">18</td>
<td align="right">24</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">8</td>
<td align="right">13</td>
<td align="right">23</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">20</td>
<td align="right">19</td>
<td align="right">23</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">10</td>
<td align="right">11</td>
<td align="right">27</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">18</td>
<td align="right">25</td>
<td align="right">25</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">18</td>
<td align="right">13</td>
<td align="right">26</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">10</td>
<td align="right">25</td>
<td align="right">28</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">8</td>
<td align="right">14</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">8</td>
<td align="right">13</td>
<td align="right">25</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">23</td>
<td align="right">28</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">21</td>
<td align="right">26</td>
<td align="right">26</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">17</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">16</td>
<td align="right">15</td>
<td align="right">23</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">23</td>
<td align="right">24</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">16</td>
<td align="right">21</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">16</td>
<td align="right">22</td>
<td align="right">26</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">17</td>
<td align="right">22</td>
<td align="right">28</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">16</td>
<td align="right">14</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">20</td>
<td align="right">26</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">9</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">17</td>
<td align="right">24</td>
<td align="right">23</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">15</td>
<td align="right">18</td>
<td align="right">20</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">16</td>
<td align="right">18</td>
<td align="right">28</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">7</td>
<td align="right">19</td>
<td align="right">18</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">15</td>
<td align="right">7</td>
<td align="right">28</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">13</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">15</td>
<td align="right">32</td>
<td align="right">26</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">17</td>
<td align="right">24</td>
<td align="right">14</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">29</td>
<td align="right">23</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">12</td>
<td align="right">10</td>
<td align="right">16</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">17</td>
<td align="right">26</td>
<td align="right">28</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">21</td>
<td align="right">26</td>
<td align="right">21</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">13</td>
<td align="right">26</td>
<td align="right">22</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">5</td>
<td align="right">22</td>
<td align="right">22</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">7</td>
<td align="right">30</td>
<td align="right">17</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">15</td>
<td align="right">30</td>
<td align="right">27</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">17</td>
<td align="right">26</td>
<td align="right">20</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">20</td>
<td align="right">28</td>
<td align="right">24</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">15</td>
<td align="right">29</td>
<td align="right">24</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">19</td>
<td align="right">32</td>
<td align="right">28</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">18</td>
<td align="right">31</td>
<td align="right">27</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">26</td>
<td align="right">21</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">17</td>
<td align="right">33</td>
<td align="right">26</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">14</td>
<td align="right">19</td>
<td align="right">17</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">21</td>
<td align="right">30</td>
<td align="right">29</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">21</td>
<td align="right">34</td>
<td align="right">26</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">17</td>
<td align="right">30</td>
<td align="right">24</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">15</td>
<td align="right">25</td>
<td align="right">23</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">26</td>
<td align="right">16</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">23</td>
<td align="right">21</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">18</td>
<td align="right">34</td>
<td align="right">24</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">15</td>
<td align="right">28</td>
<td align="right">27</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">16</td>
<td align="right">29</td>
<td align="right">24</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">19</td>
<td align="right">32</td>
<td align="right">23</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">16</td>
<td align="right">33</td>
<td align="right">23</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">20</td>
<td align="right">21</td>
<td align="right">21</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">19</td>
<td align="right">30</td>
<td align="right">28</td>
<td align="left">male</td>
</tr>
</tbody>
</table>
<blockquote>
<ol start="2" style="list-style-type: decimal">
<li>Second we implement the profiling analysis, employing the package “pbg”.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="chapter5.html#cb95-1"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;profileR&quot;</span>)){</span>
<span id="cb95-2"><a href="chapter5.html#cb95-2"></a>  <span class="kw">install.packages</span>(<span class="st">&quot;profileR&quot;</span>)</span>
<span id="cb95-3"><a href="chapter5.html#cb95-3"></a>  <span class="kw">library</span>(<span class="st">&quot;pbg&quot;</span>)</span>
<span id="cb95-4"><a href="chapter5.html#cb95-4"></a><span class="st">&quot;The pbg function implements three hypothesis tests. These tests are whether the profiles are parallel, have equal levels, and are flat across groups defined by the grouping variable. If parallelism is rejected, the other two tests are not necessary.</span></span>
<span id="cb95-5"><a href="chapter5.html#cb95-5"></a><span class="st">    &quot;</span></span>
<span id="cb95-6"><a href="chapter5.html#cb95-6"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="chapter5.html#cb96-1"></a>mod&lt;-<span class="kw">pbg</span>(<span class="dt">data=</span>data542[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">group=</span>data542[,<span class="dv">5</span>], <span class="dt">original.names =</span> <span class="ot">TRUE</span>, <span class="dt">profile.plot =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="multivariate-statistics-R-code_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="chapter5.html#cb97-1"></a><span class="kw">print</span>(mod)</span></code></pre></div>
<pre><code>## 
## Data Summary:
##      female     male
## y1 12.34375 15.96875
## y2 13.90625 15.90625
## y3 16.65625 27.18750
## y4 21.93750 22.75000</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="chapter5.html#cb99-1"></a><span class="kw">summary</span>(mod)</span></code></pre></div>
<pre><code>## Call:
## pbg(data = data542[, 1:4], group = data542[, 5], original.names = TRUE, 
##     profile.plot = TRUE)
## 
## Hypothesis Tests:
## $`Ho: Profiles are parallel`
##   Multivariate.Test Statistic Approx.F num.df den.df      p.value
## 1             Wilks  0.455078 23.94851      3     60 2.587417e-10
## 2            Pillai  0.544922 23.94851      3     60 2.587417e-10
## 3  Hotelling-Lawley  1.197425 23.94851      3     60 2.587417e-10
## 4               Roy  1.197425 23.94851      3     60 2.587417e-10
## 
## $`Ho: Profiles have equal levels`
##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## group        1  287.9  287.94   28.04 1.66e-06 ***
## Residuals   62  636.6   10.27                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## $`Ho: Profiles are flat`
##         F df1 df2      p-value
## 1 81.9367   3  60 3.401274e-21</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/C1587S/EMV-ejercicios/edit/master/04-chapter5.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["multivariate-statistics-R-code.pdf", "multivariate-statistics-R-code.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
