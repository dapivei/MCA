<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Discriminant Analysis: description of group separation | Multivariate and Categorical Statistics</title>
  <meta name="description" content="This is a book meant to me read along side the book Multivariate Methods." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Discriminant Analysis: description of group separation | Multivariate and Categorical Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book meant to me read along side the book Multivariate Methods." />
  <meta name="github-repo" content="https://github.com/C1587S/EMV-ejercicios" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Discriminant Analysis: description of group separation | Multivariate and Categorical Statistics" />
  
  <meta name="twitter:description" content="This is a book meant to me read along side the book Multivariate Methods." />
  

<meta name="author" content="Daniela Pinto Veizaga &amp; Sebastián Cadavid Sánchez" />


<meta name="date" content="2020-04-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter7.html"/>
<link rel="next" href="chapter9.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Multivariate and Categorical Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i><b>3</b> Literature</a></li>
<li class="chapter" data-level="4" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>4</b> Methods</a></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> Test on one or two mean vectors</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#multivariate-test-for-h_0mumu_0-with-sigma-known"><i class="fa fa-check"></i><b>5.1</b> Multivariate Test for <span class="math inline">\(H_{0}:\mu=\mu_{0}\)</span> with <span class="math inline">\(\Sigma\)</span> known</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="chapter5.html"><a href="chapter5.html#example-5.2.2"><i class="fa fa-check"></i><b>5.1.1</b> Example 5.2.2</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#multivariate-test-for-h_0mumu_0-with-sigma-known-1"><i class="fa fa-check"></i><b>5.2</b> Multivariate Test for <span class="math inline">\(H_{0}:\mu=\mu_{0}\)</span> with <span class="math inline">\(\Sigma\)</span> known</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#multivariate-two-sample-t2-test"><i class="fa fa-check"></i><b>5.3</b> Multivariate Two-Sample <span class="math inline">\(T^2\)</span>-test</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter5.html"><a href="chapter5.html#example-5.4.2"><i class="fa fa-check"></i><b>5.3.1</b> Example 5.4.2</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter5.html"><a href="chapter5.html#example-5.5"><i class="fa fa-check"></i><b>5.3.2</b> Example 5.5</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#computation-of-t2"><i class="fa fa-check"></i><b>5.4</b> Computation of <span class="math inline">\(T^2\)</span></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chapter5.html"><a href="chapter5.html#example-5.6.2"><i class="fa fa-check"></i><b>5.4.1</b> Example: 5.6.2</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#paired-observation-test"><i class="fa fa-check"></i><b>5.5</b> Paired Observation Test</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chapter5.html"><a href="chapter5.html#example-5.7.2"><i class="fa fa-check"></i><b>5.5.1</b> Example 5.7.2</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#test-for-aditional-information"><i class="fa fa-check"></i><b>5.6</b> Test for Aditional Information</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chapter5.html"><a href="chapter5.html#example-5.8"><i class="fa fa-check"></i><b>5.6.1</b> Example 5.8</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#profile-analysis"><i class="fa fa-check"></i><b>5.7</b> Profile Analysis</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="chapter5.html"><a href="chapter5.html#example-5.9.2"><i class="fa fa-check"></i><b>5.7.1</b> Example 5.9.2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> Multivariate Analysis of Variance Vectors</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#one-way-models"><i class="fa fa-check"></i><b>6.1</b> One Way Models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter6.html"><a href="chapter6.html#example-6.1.7"><i class="fa fa-check"></i><b>6.1.1</b> Example 6.1.7</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter6.html"><a href="chapter6.html#example-6.1.8"><i class="fa fa-check"></i><b>6.1.2</b> Example 6.1.8</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#comparison-of-the-four-manova-test-statistics-comparison-ot-the-four-manova-test-statistics"><i class="fa fa-check"></i><b>6.2</b> Comparison of the four MANOVA test statistics comparison ot the four MANOVA test statistics</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="chapter6.html"><a href="chapter6.html#example-6.2"><i class="fa fa-check"></i><b>6.2.1</b> Example 6.2</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#constrasts"><i class="fa fa-check"></i><b>6.3</b> Constrasts</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter6.html"><a href="chapter6.html#example-6.3.2"><i class="fa fa-check"></i><b>6.3.1</b> Example 6.3.2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#tests-on-individual-variables-following-rejection-of-h_0-by-the-overall-manova-test"><i class="fa fa-check"></i><b>6.4</b> Tests on individual variables following rejection of <span class="math inline">\(H_0\)</span> by the overall MANOVA test</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="chapter6.html"><a href="chapter6.html#example-6.4"><i class="fa fa-check"></i><b>6.4.1</b> Example 6.4</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="chapter6.html"><a href="chapter6.html#two-way-classification"><i class="fa fa-check"></i><b>6.5</b> Two-way Classification</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="chapter6.html"><a href="chapter6.html#example-6.5.2"><i class="fa fa-check"></i><b>6.5.1</b> Example 6.5.2</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="chapter6.html"><a href="chapter6.html#other-models"><i class="fa fa-check"></i><b>6.6</b> Other Models</a></li>
<li class="chapter" data-level="6.7" data-path="chapter6.html"><a href="chapter6.html#checking-on-assumptions"><i class="fa fa-check"></i><b>6.7</b> Checking on Assumptions</a></li>
<li class="chapter" data-level="6.8" data-path="chapter6.html"><a href="chapter6.html#profile-analysis-1"><i class="fa fa-check"></i><b>6.8</b> Profile Analysis</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="chapter6.html"><a href="chapter6.html#example-6.8"><i class="fa fa-check"></i><b>6.8.1</b> Example 6.8</a></li>
<li class="chapter" data-level="6.8.2" data-path="chapter6.html"><a href="chapter6.html#example-6.9.2"><i class="fa fa-check"></i><b>6.8.2</b> Example 6.9.2</a></li>
<li class="chapter" data-level="6.8.3" data-path="chapter6.html"><a href="chapter6.html#example-6.9.5"><i class="fa fa-check"></i><b>6.8.3</b> Example 6.9.5</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="chapter6.html"><a href="chapter6.html#growth-curves"><i class="fa fa-check"></i><b>6.9</b> Growth Curves</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="chapter6.html"><a href="chapter6.html#example-6.10.1"><i class="fa fa-check"></i><b>6.9.1</b> Example 6.10.1</a></li>
<li class="chapter" data-level="6.9.2" data-path="chapter6.html"><a href="chapter6.html#example-6.10.2"><i class="fa fa-check"></i><b>6.9.2</b> Example 6.10.2</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="chapter6.html"><a href="chapter6.html#tests-on-a-subvector"><i class="fa fa-check"></i><b>6.10</b> Tests on a Subvector</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="chapter6.html"><a href="chapter6.html#example-6.11.1"><i class="fa fa-check"></i><b>6.10.1</b> Example 6.11.1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> Tests in covariance matrices</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#testing-a-specified-pattern-for-sigma"><i class="fa fa-check"></i><b>7.2</b> Testing a specified pattern for <span class="math inline">\(\Sigma\)</span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="chapter7.html"><a href="chapter7.html#example-7.2.2"><i class="fa fa-check"></i><b>7.2.1</b> Example 7.2.2</a></li>
<li class="chapter" data-level="7.2.2" data-path="chapter7.html"><a href="chapter7.html#example-7.2.3"><i class="fa fa-check"></i><b>7.2.2</b> Example 7.2.3</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#tests-comparing-covariance-matrices"><i class="fa fa-check"></i><b>7.3</b> Tests comparing covariance matrices</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="chapter7.html"><a href="chapter7.html#example-7.3.2"><i class="fa fa-check"></i><b>7.3.1</b> Example 7.3.2</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#tests-of-independence"><i class="fa fa-check"></i><b>7.4</b> Tests of independence</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="chapter7.html"><a href="chapter7.html#example-7.4.1"><i class="fa fa-check"></i><b>7.4.1</b> Example 7.4.1</a></li>
<li class="chapter" data-level="7.4.2" data-path="chapter7.html"><a href="chapter7.html#example-7.4.2"><i class="fa fa-check"></i><b>7.4.2</b> Example 7.4.2</a></li>
<li class="chapter" data-level="7.4.3" data-path="chapter7.html"><a href="chapter7.html#example-7.4.3"><i class="fa fa-check"></i><b>7.4.3</b> Example 7.4.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> Discriminant Analysis: description of group separation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#introduction-1"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#discriminant-function-for-two-vectors"><i class="fa fa-check"></i><b>8.2</b> Discriminant Function for Two Vectors</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="chapter8.html"><a href="chapter8.html#example-8.2"><i class="fa fa-check"></i><b>8.2.1</b> Example 8.2</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#relantionship-between-two-group-discriminant-analysis-and-multiple-regression"><i class="fa fa-check"></i><b>8.3</b> Relantionship Between Two Group Discriminant Analysis and Multiple Regression</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="chapter8.html"><a href="chapter8.html#example-8.3."><i class="fa fa-check"></i><b>8.3.1</b> Example 8.3.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chapter8.html"><a href="chapter8.html#discriminant-analysis-for-several-groups"><i class="fa fa-check"></i><b>8.4</b> Discriminant Analysis For Several Groups</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="chapter8.html"><a href="chapter8.html#example-8.4.1."><i class="fa fa-check"></i><b>8.4.1</b> Example 8.4.1.</a></li>
<li class="chapter" data-level="8.4.2" data-path="chapter8.html"><a href="chapter8.html#example-8.4.2."><i class="fa fa-check"></i><b>8.4.2</b> Example 8.4.2.</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="chapter8.html"><a href="chapter8.html#standarized-discriminant-functions"><i class="fa fa-check"></i><b>8.5</b> Standarized Discriminant Functions</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="chapter8.html"><a href="chapter8.html#example-8.5."><i class="fa fa-check"></i><b>8.5.1</b> Example 8.5.</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="chapter8.html"><a href="chapter8.html#test-of-significance"><i class="fa fa-check"></i><b>8.6</b> Test of Significance</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="chapter8.html"><a href="chapter8.html#example-8.6.2"><i class="fa fa-check"></i><b>8.6.1</b> Example 8.6.2</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="chapter8.html"><a href="chapter8.html#interpretation-of-discriminant-functions"><i class="fa fa-check"></i><b>8.7</b> Interpretation of Discriminant Functions</a></li>
<li class="chapter" data-level="8.8" data-path="chapter8.html"><a href="chapter8.html#scatter-plots"><i class="fa fa-check"></i><b>8.8</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="chapter8.html"><a href="chapter8.html#example-8.8."><i class="fa fa-check"></i><b>8.8.1</b> Example 8.8.</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="chapter8.html"><a href="chapter8.html#stepwise-selection-of-variables"><i class="fa fa-check"></i><b>8.9</b> Stepwise Selection of Variables</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="chapter8.html"><a href="chapter8.html#example-8.9."><i class="fa fa-check"></i><b>8.9.1</b> Example 8.9.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> Classification Analysis: Allocation of Observartion Groups</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#introduction-2"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#classification-into-two-groups"><i class="fa fa-check"></i><b>9.2</b> Classification into Two Groups</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter9.html"><a href="chapter9.html#example-9.2."><i class="fa fa-check"></i><b>9.2.1</b> Example 9.2.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#classification-into-several-groups"><i class="fa fa-check"></i><b>9.3</b> Classification into Several Groups</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="chapter9.html"><a href="chapter9.html#example-9.3"><i class="fa fa-check"></i><b>9.3.1</b> Example 9.3</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#estimating-misclassification-rates"><i class="fa fa-check"></i><b>9.4</b> Estimating Misclassification Rates</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter9.html"><a href="chapter9.html#example-9.4.a."><i class="fa fa-check"></i><b>9.4.1</b> Example <span class="math inline">\(9.4.(a).\)</span></a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter9.html"><a href="chapter9.html#example-9.4.b"><i class="fa fa-check"></i><b>9.4.2</b> Example <span class="math inline">\(9.4.(b)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="chapter9.html"><a href="chapter9.html#improved-estimates-of-error-rates"><i class="fa fa-check"></i><b>9.5</b> Improved Estimates of Error Rates</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="chapter9.html"><a href="chapter9.html#example-9.5.2"><i class="fa fa-check"></i><b>9.5.1</b> Example <span class="math inline">\(9.5.2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="chapter9.html"><a href="chapter9.html#subset-selection"><i class="fa fa-check"></i><b>9.6</b> Subset Selection</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="chapter9.html"><a href="chapter9.html#example-9.6.a."><i class="fa fa-check"></i><b>9.6.1</b> Example 9.6.(a).</a></li>
<li class="chapter" data-level="9.6.2" data-path="chapter9.html"><a href="chapter9.html#example-9.6.b."><i class="fa fa-check"></i><b>9.6.2</b> Example 9.6.(b).</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="chapter9.html"><a href="chapter9.html#nonparametric-procedures"><i class="fa fa-check"></i><b>9.7</b> Nonparametric Procedures</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="chapter9.html"><a href="chapter9.html#example-9.7.2."><i class="fa fa-check"></i><b>9.7.1</b> Example 9.7.2.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter11.html"><a href="chapter11.html"><i class="fa fa-check"></i><b>10</b> Canonical Correlation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter11.html"><a href="chapter11.html#introduction-3"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="chapter11.html"><a href="chapter11.html#canonical-correlations-and-canonical-variates"><i class="fa fa-check"></i><b>10.2</b> Canonical Correlations and Canonical Variates</a></li>
<li class="chapter" data-level="10.3" data-path="chapter11.html"><a href="chapter11.html#properties-of-canonical-correlations"><i class="fa fa-check"></i><b>10.3</b> Properties of Canonical Correlations</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="chapter11.html"><a href="chapter11.html#example-11.3"><i class="fa fa-check"></i><b>10.3.1</b> Example 11.3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="chapter11.html"><a href="chapter11.html#tests-of-significance"><i class="fa fa-check"></i><b>10.4</b> Tests of Significance</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="chapter11.html"><a href="chapter11.html#example-11.4.1."><i class="fa fa-check"></i><b>10.4.1</b> Example 11.4.1.</a></li>
<li class="chapter" data-level="10.4.2" data-path="chapter11.html"><a href="chapter11.html#example-11.4.2."><i class="fa fa-check"></i><b>10.4.2</b> Example 11.4.2.</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chapter11.html"><a href="chapter11.html#interpretation"><i class="fa fa-check"></i><b>10.5</b> Interpretation</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="chapter11.html"><a href="chapter11.html#example-11.5.1."><i class="fa fa-check"></i><b>10.5.1</b> Example 11.5.1.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="chapter11.html"><a href="chapter11.html#relationships-of-canonical-correlation-analysis-to-other-multivariate-techniques"><i class="fa fa-check"></i><b>10.6</b> Relationships of Canonical Correlation Analysis to Other Multivariate Techniques</a></li>
<li class="chapter" data-level="10.7" data-path="chapter11.html"><a href="chapter11.html#references"><i class="fa fa-check"></i><b>10.7</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Multivariate and Categorical Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter8" class="section level1" number="8">
<h1><span class="header-section-number">Chapter 8</span> Discriminant Analysis: description of group separation</h1>
<div align="justify">

<div id="introduction-1" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
</div>
<div id="discriminant-function-for-two-vectors" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Discriminant Function for Two Vectors</h2>
<div id="example-8.2" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Example 8.2</h3>
<p>Samples of steel produced at two different rolling temperatures are compared in <em>Table 8.1</em> (Kramer and Jensen 1969a).</p>
<p>The variables are:</p>
<p><span class="math display">\[y_1=\textit{yield point}\]</span>
<span class="math display">\[y_2=\textit{ultimate strength}\]</span></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter8.html#cb3-1"></a><span class="co"># Data: Yield point and ultimate strenght of steel produced at two rolling temperatures</span></span>
<span id="cb3-2"><a href="chapter8.html#cb3-2"></a></span>
<span id="cb3-3"><a href="chapter8.html#cb3-3"></a>y1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">33</span>, <span class="dv">36</span>, <span class="dv">35</span>, <span class="dv">38</span>, <span class="dv">40</span>)</span>
<span id="cb3-4"><a href="chapter8.html#cb3-4"></a>y2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">61</span>, <span class="dv">64</span>, <span class="dv">63</span>, <span class="dv">65</span>)</span>
<span id="cb3-5"><a href="chapter8.html#cb3-5"></a>yield_strength_t1 &lt;-<span class="kw">data.frame</span>(y1, y2)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="chapter8.html#cb4-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb4-2"><a href="chapter8.html#cb4-2"></a>  yield_strength_t1, <span class="dt">caption =</span> <span class="st">&#39;Yield Strength T1&#39;</span>,</span>
<span id="cb4-3"><a href="chapter8.html#cb4-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb4-4"><a href="chapter8.html#cb4-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-2">Table 8.1: </span>Yield Strength T1</caption>
<thead>
<tr class="header">
<th align="right">y1</th>
<th align="right">y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">33</td>
<td align="right">60</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">61</td>
</tr>
<tr class="odd">
<td align="right">35</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="right">38</td>
<td align="right">63</td>
</tr>
<tr class="odd">
<td align="right">40</td>
<td align="right">65</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapter8.html#cb5-1"></a>y1  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">35</span>, <span class="dv">36</span>, <span class="dv">38</span>, <span class="dv">39</span>, <span class="dv">41</span>, <span class="dv">43</span>, <span class="dv">41</span>)</span>
<span id="cb5-2"><a href="chapter8.html#cb5-2"></a>y2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">57</span>, <span class="dv">59</span>, <span class="dv">59</span>, <span class="dv">61</span>, <span class="dv">63</span>, <span class="dv">65</span>, <span class="dv">59</span>)</span>
<span id="cb5-3"><a href="chapter8.html#cb5-3"></a></span>
<span id="cb5-4"><a href="chapter8.html#cb5-4"></a></span>
<span id="cb5-5"><a href="chapter8.html#cb5-5"></a>yield_strength_t2 &lt;-<span class="kw">data.frame</span>(y1, y2)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chapter8.html#cb6-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb6-2"><a href="chapter8.html#cb6-2"></a>  yield_strength_t2, <span class="dt">caption =</span> <span class="st">&#39;Yield Strength T2&#39;</span>,</span>
<span id="cb6-3"><a href="chapter8.html#cb6-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb6-4"><a href="chapter8.html#cb6-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-4">Table 8.2: </span>Yield Strength T2</caption>
<thead>
<tr class="header">
<th align="right">y1</th>
<th align="right">y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">35</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">59</td>
</tr>
<tr class="odd">
<td align="right">38</td>
<td align="right">59</td>
</tr>
<tr class="even">
<td align="right">39</td>
<td align="right">61</td>
</tr>
<tr class="odd">
<td align="right">41</td>
<td align="right">63</td>
</tr>
<tr class="even">
<td align="right">43</td>
<td align="right">65</td>
</tr>
<tr class="odd">
<td align="right">41</td>
<td align="right">59</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="chapter8.html#cb7-1"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;ggplot2&quot;</span>)){</span>
<span id="cb7-2"><a href="chapter8.html#cb7-2"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb7-3"><a href="chapter8.html#cb7-3"></a>    <span class="kw">library</span>(ggplot2)</span>
<span id="cb7-4"><a href="chapter8.html#cb7-4"></a>  }</span>
<span id="cb7-5"><a href="chapter8.html#cb7-5"></a><span class="kw">ggplot</span>(<span class="ot">NULL</span>, <span class="kw">aes</span>(y1, y2)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-6"><a href="chapter8.html#cb7-6"></a><span class="st">      </span><span class="kw">geom_point</span>(<span class="dt">data =</span> yield_strength_t1, <span class="dt">colour=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb7-7"><a href="chapter8.html#cb7-7"></a><span class="st">      </span><span class="kw">geom_point</span>(<span class="dt">data =</span> yield_strength_t2)</span></code></pre></div>
<p><img src="multivariate-statistics-R-code_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>If the points were proyected on either <span class="math inline">\(y_1\)</span> or <span class="math inline">\(y_2\)</span> axis, there would be considerable overlap. However it is clear from the figure above, that the two groups can be separated <strong>if they were projected in an appropiate direction.</strong></p>
<p>So, we obtain the single dimension onto which the points would be projected: the discriminant function, given by:</p>
<p><span class="math display">\[z=a&#39;y=a_1y_1+a_2y_2\]</span></p>
<p>We know that <span class="math inline">\(a\)</span> is given by:</p>
<p><span class="math display">\[a=S_{pl}^{-1}(\bar{y}_{1}-\bar{y}_{2})\]</span></p>
<p>So, first we proceed to find:</p>
<ol style="list-style-type: decimal">
<li>The means of each columns on each data frame:</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chapter8.html#cb8-1"></a>y_mean_yield_strength_t1&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb8-2"><a href="chapter8.html#cb8-2"></a>  <span class="kw">apply</span>(</span>
<span id="cb8-3"><a href="chapter8.html#cb8-3"></a>    yield_strength_t1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb8-4"><a href="chapter8.html#cb8-4"></a>    )</span>
<span id="cb8-5"><a href="chapter8.html#cb8-5"></a>  )</span>
<span id="cb8-6"><a href="chapter8.html#cb8-6"></a>y_mean_yield_strength_t1</span></code></pre></div>
<pre><code>##    [,1]
## y1 36.4
## y2 62.6</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapter8.html#cb10-1"></a>y_mean_yield_strength_t2&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb10-2"><a href="chapter8.html#cb10-2"></a>  <span class="kw">apply</span>(</span>
<span id="cb10-3"><a href="chapter8.html#cb10-3"></a>    yield_strength_t2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb10-4"><a href="chapter8.html#cb10-4"></a>    )</span>
<span id="cb10-5"><a href="chapter8.html#cb10-5"></a>  )</span>
<span id="cb10-6"><a href="chapter8.html#cb10-6"></a>y_mean_yield_strength_t2</span></code></pre></div>
<pre><code>##        [,1]
## y1 39.00000
## y2 60.42857</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>The common population variance:</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter8.html#cb12-1"></a>common_population_variance &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2) {</span>
<span id="cb12-2"><a href="chapter8.html#cb12-2"></a>  <span class="st">&quot;</span></span>
<span id="cb12-3"><a href="chapter8.html#cb12-3"></a><span class="st">  Function for calculating the common population matrix considering p variables measured on each sampling unit in two    samples. See Section 5.4.2. from the book. </span></span>
<span id="cb12-4"><a href="chapter8.html#cb12-4"></a><span class="st">  * Inputs:</span></span>
<span id="cb12-5"><a href="chapter8.html#cb12-5"></a><span class="st">  - </span></span>
<span id="cb12-6"><a href="chapter8.html#cb12-6"></a><span class="st">  * Outputs:</span></span>
<span id="cb12-7"><a href="chapter8.html#cb12-7"></a><span class="st">  &quot;</span></span>
<span id="cb12-8"><a href="chapter8.html#cb12-8"></a>  n_<span class="dv">1</span>=<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb12-9"><a href="chapter8.html#cb12-9"></a>  n_<span class="dv">2</span>=<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb12-10"><a href="chapter8.html#cb12-10"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1)</span>
<span id="cb12-11"><a href="chapter8.html#cb12-11"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2)</span>
<span id="cb12-12"><a href="chapter8.html#cb12-12"></a></span>
<span id="cb12-13"><a href="chapter8.html#cb12-13"></a>  sigma_population&lt;-(<span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>))<span class="op">*</span>((n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span>)</span>
<span id="cb12-14"><a href="chapter8.html#cb12-14"></a>  <span class="co">#print(&quot;The pooled covariance matrix is:&quot;)</span></span>
<span id="cb12-15"><a href="chapter8.html#cb12-15"></a>  <span class="co">#print(sigma_population)</span></span>
<span id="cb12-16"><a href="chapter8.html#cb12-16"></a>}</span>
<span id="cb12-17"><a href="chapter8.html#cb12-17"></a>spl_rolling_temperatures&lt;-<span class="kw">common_population_variance</span>(yield_strength_t1, yield_strength_t2)</span>
<span id="cb12-18"><a href="chapter8.html#cb12-18"></a><span class="co">#spl_rolling_temperatures</span></span></code></pre></div>
<p>Then, we have a:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter8.html#cb13-1"></a>a&lt;-<span class="kw">as.matrix</span>(<span class="kw">solve</span>(spl_rolling_temperatures)<span class="op">%*%</span>(y_mean_yield_strength_t1<span class="op">-</span>y_mean_yield_strength_t2))</span>
<span id="cb13-2"><a href="chapter8.html#cb13-2"></a>a</span></code></pre></div>
<pre><code>##         [,1]
## y1 -1.633377
## y2  1.819779</code></pre>
<p>Let’s compute a function for calculating the optimum directing given by <span class="math inline">\(a=S_{pl}^{-1}(\bar{y_1}-\bar{y_2})\)</span> (see equation 8.2 from the book).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="chapter8.html#cb15-1"></a>optim_dir &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2){</span>
<span id="cb15-2"><a href="chapter8.html#cb15-2"></a>  mean_vec_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">apply</span>(data1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean))</span>
<span id="cb15-3"><a href="chapter8.html#cb15-3"></a>  mean_vec_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">apply</span>(data2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean))</span>
<span id="cb15-4"><a href="chapter8.html#cb15-4"></a>  Sp &lt;-<span class="st"> </span><span class="kw">common_population_variance</span>(data1, data2)</span>
<span id="cb15-5"><a href="chapter8.html#cb15-5"></a>  <span class="kw">as.matrix</span>(<span class="kw">solve</span>(Sp)<span class="op">%*%</span>(mean_vec_<span class="dv">1</span><span class="op">-</span>mean_vec_<span class="dv">2</span>))</span>
<span id="cb15-6"><a href="chapter8.html#cb15-6"></a>}</span></code></pre></div>
<p>Let’s check the generated functions:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter8.html#cb16-1"></a><span class="kw">print</span>(<span class="st">&quot;The pooled covariance matrix is:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The pooled covariance matrix is:&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter8.html#cb18-1"></a>spl_rolling_temperatures&lt;-<span class="kw">common_population_variance</span>(yield_strength_t1, yield_strength_t2)</span>
<span id="cb18-2"><a href="chapter8.html#cb18-2"></a><span class="kw">print</span>(spl_rolling_temperatures)</span></code></pre></div>
<pre><code>##      y1       y2
## y1 7.92 5.680000
## y2 5.68 6.291429</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter8.html#cb20-1"></a>a &lt;-<span class="st"> </span><span class="kw">optim_dir</span>(yield_strength_t1, yield_strength_t2)</span>
<span id="cb20-2"><a href="chapter8.html#cb20-2"></a><span class="kw">print</span>(<span class="st">&quot;The optimum direction is:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;The optimum direction is:&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter8.html#cb22-1"></a><span class="kw">print</span>(a)</span></code></pre></div>
<pre><code>##         [,1]
## y1 -1.633377
## y2  1.819779</code></pre>
<p>It follows that the discriminant function is:</p>
<p><span class="math display">\[z=a&#39;y=-1.633y_1+1.819y_2\]</span></p>
<p>And the associated values of the projected points (See table 8.2) are :</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter8.html#cb24-1"></a>z_<span class="dv">1</span>&lt;-a[<span class="dv">1</span>]<span class="op">*</span>yield_strength_t1[<span class="dv">1</span>]<span class="op">+</span><span class="st"> </span>a[<span class="dv">2</span>]<span class="op">*</span>yield_strength_t1[<span class="dv">2</span>]</span>
<span id="cb24-2"><a href="chapter8.html#cb24-2"></a>z_<span class="dv">1</span></span></code></pre></div>
<pre><code>##         y1
## 1 55.28530
## 2 52.20494
## 3 59.29766
## 4 52.57775
## 5 52.95055</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter8.html#cb26-1"></a>z_<span class="dv">2</span> &lt;-<span class="st"> </span>a[<span class="dv">1</span>]<span class="op">*</span>yield_strength_t2[<span class="dv">1</span>]<span class="op">+</span><span class="st"> </span>a[<span class="dv">2</span>]<span class="op">*</span>yield_strength_t2[<span class="dv">2</span>]</span>
<span id="cb26-2"><a href="chapter8.html#cb26-2"></a>z_<span class="dv">2</span></span></code></pre></div>
<pre><code>##         y1
## 1 46.55921
## 2 48.56539
## 3 45.29863
## 4 47.30481
## 5 47.67762
## 6 48.05042
## 7 40.39850</code></pre>
<p>Now, using the table above, the separation provided by the discriminant function is clearly evident!</p>
</div>
</div>
<div id="relantionship-between-two-group-discriminant-analysis-and-multiple-regression" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Relantionship Between Two Group Discriminant Analysis and Multiple Regression</h2>
<p>Let w be a grouping variable (identifying groups 1 and 2) such that <span class="math inline">\(w = 0\)</span> and define <span class="math inline">\(b = (b\, b2,..., bp)&#39;\)</span> as the vector of regression coefficients when <span class="math inline">\(w\)</span> is fit to the <span class="math inline">\(y\)</span>’s. Then by (5.21), b is proportional to the discriminant function coefficient vector <span class="math inline">\(a=S_{pl}^{-1}(\bar{y_1}-\bar{y_2})\)</span>:</p>
<p><span class="math display">\[
b = a\frac{n_1n_2}{(n_1+n_2)(n_1+n_2-2+T^{2})}
\]</span></p>
<p>where <span class="math inline">\(T^{2}=[(\bar{y_1}-\bar{y_2})^{&#39;}S_{pl}^{-1}(\bar{y_1}-\bar{y_2})]\frac{n_1n_2}{(n_1+n_2)}\)</span> as in (5.2).</p>
<p>Function for calculating <span class="math inline">\(T^{2}\)</span>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapter8.html#cb28-1"></a>y_mean_yield_strength_t2&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb28-2"><a href="chapter8.html#cb28-2"></a>  <span class="kw">apply</span>(</span>
<span id="cb28-3"><a href="chapter8.html#cb28-3"></a>    yield_strength_t2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb28-4"><a href="chapter8.html#cb28-4"></a>    )</span>
<span id="cb28-5"><a href="chapter8.html#cb28-5"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter8.html#cb29-1"></a>calc_T2 &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2){</span>
<span id="cb29-2"><a href="chapter8.html#cb29-2"></a>  n1 &lt;-<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb29-3"><a href="chapter8.html#cb29-3"></a>  n2 &lt;-<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb29-4"><a href="chapter8.html#cb29-4"></a>  aux &lt;-<span class="st"> </span>n1<span class="op">*</span>n2<span class="op">/</span>(n1<span class="op">+</span>n2)</span>
<span id="cb29-5"><a href="chapter8.html#cb29-5"></a>  mean_vec_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">apply</span>(data1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean))</span>
<span id="cb29-6"><a href="chapter8.html#cb29-6"></a>  mean_vec_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">apply</span>(data2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean))</span>
<span id="cb29-7"><a href="chapter8.html#cb29-7"></a>  com_pvar_<span class="dv">1</span>_<span class="dv">2</span> &lt;-<span class="st">  </span><span class="kw">common_population_variance</span>(data1, data2)  </span>
<span id="cb29-8"><a href="chapter8.html#cb29-8"></a>  <span class="co"># compute T2</span></span>
<span id="cb29-9"><a href="chapter8.html#cb29-9"></a>  T2 &lt;-<span class="st"> </span>aux <span class="op">*</span><span class="st"> </span><span class="kw">t</span>(mean_vec_<span class="dv">1</span><span class="op">-</span>mean_vec_<span class="dv">2</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(com_pvar_<span class="dv">1</span>_<span class="dv">2</span>)  <span class="op">%*%</span><span class="st"> </span>(mean_vec_<span class="dv">1</span><span class="op">-</span>mean_vec_<span class="dv">2</span>)</span>
<span id="cb29-10"><a href="chapter8.html#cb29-10"></a>  </span>
<span id="cb29-11"><a href="chapter8.html#cb29-11"></a>}</span></code></pre></div>
<p>From (5.20), the squared multiple correlation <span class="math inline">\(R^{2}\)</span> is related to <span class="math inline">\(T^{2}\)</span> by:</p>
<p><span class="math display">\[
R^{2} = (\bar{y_1}-\bar{y_2})^{&#39;}b=\frac{T^{2}}{n_1+n_2-2+T^{2}}
\]</span>
The test statistic (5.29) for the hypothesis that q of the p + q variables are redundant
for separating the groups can also be obtained in terms of regression by (5.31) as</p>
<p><span class="math display">\[
F = \frac{n_1+n_2-p-q-1}{q} \frac{R_{p+q}^{2}}{1-R_{p+q}^{2}}
\]</span>
where <span class="math inline">\(R_{p+q}^{2}\)</span> and <span class="math inline">\(R_{p}^{2}\)</span> are from regressions with p + q and p variables, respectively.</p>
<div id="example-8.3." class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Example 8.3.</h3>
<p>In example <em>5.6.2</em>, the psychological data of <span class="math inline">\(Table 5.1\)</span>, were used in an illustration of the regression approach to computation of <span class="math inline">\(a\)</span> and <span class="math inline">\(T^2\)</span>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter8.html#cb30-1"></a><span class="co">#pyschological data of males</span></span>
<span id="cb30-2"><a href="chapter8.html#cb30-2"></a></span>
<span id="cb30-3"><a href="chapter8.html#cb30-3"></a>y_1m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,   <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">11</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">17</span>, <span class="dv">19</span>)</span>
<span id="cb30-4"><a href="chapter8.html#cb30-4"></a></span>
<span id="cb30-5"><a href="chapter8.html#cb30-5"></a>y_2m &lt;-<span class="kw">c</span>(<span class="dv">15</span>,    <span class="dv">17</span>, <span class="dv">14</span>, <span class="dv">12</span>, <span class="dv">17</span>, <span class="dv">21</span>, <span class="dv">13</span>, <span class="dv">5</span>,  <span class="dv">7</span>,  <span class="dv">15</span>, <span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">19</span>, <span class="dv">18</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">14</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">13</span>, <span class="dv">18</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">19</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">19</span>)</span>
<span id="cb30-6"><a href="chapter8.html#cb30-6"></a></span>
<span id="cb30-7"><a href="chapter8.html#cb30-7"></a>y_3m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">32</span>,   <span class="dv">24</span>, <span class="dv">29</span>, <span class="dv">10</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">22</span>, <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">32</span>, <span class="dv">31</span>, <span class="dv">26</span>, <span class="dv">33</span>, <span class="dv">19</span>, <span class="dv">30</span>, <span class="dv">34</span>, <span class="dv">30</span>, <span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">23</span>, <span class="dv">34</span>, <span class="dv">28</span>, <span class="dv">29</span>, <span class="dv">32</span>, <span class="dv">33</span>, <span class="dv">21</span>, <span class="dv">30</span>)</span>
<span id="cb30-8"><a href="chapter8.html#cb30-8"></a></span>
<span id="cb30-9"><a href="chapter8.html#cb30-9"></a>y_4m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">26</span>,   <span class="dv">14</span>, <span class="dv">23</span>, <span class="dv">16</span>, <span class="dv">28</span>, <span class="dv">21</span>, <span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">17</span>, <span class="dv">27</span>, <span class="dv">20</span>, <span class="dv">24</span>, <span class="dv">24</span>, <span class="dv">28</span>, <span class="dv">27</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">17</span>, <span class="dv">29</span>, <span class="dv">26</span>, <span class="dv">24</span>, <span class="dv">16</span>, <span class="dv">23</span>, <span class="dv">16</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">28</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter8.html#cb31-1"></a>data542_male &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb31-2"><a href="chapter8.html#cb31-2"></a>  y_1m, y_2m, y_3m, y_4m</span>
<span id="cb31-3"><a href="chapter8.html#cb31-3"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="chapter8.html#cb32-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb32-2"><a href="chapter8.html#cb32-2"></a>  data542_male, <span class="dt">caption =</span> <span class="st">&#39;Data Male&#39;</span>,</span>
<span id="cb32-3"><a href="chapter8.html#cb32-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb32-4"><a href="chapter8.html#cb32-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-17">Table 8.3: </span>Data Male</caption>
<thead>
<tr class="header">
<th align="right">y_1m</th>
<th align="right">y_2m</th>
<th align="right">y_3m</th>
<th align="right">y_4m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">17</td>
<td align="right">15</td>
<td align="right">32</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">17</td>
<td align="right">24</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">29</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">12</td>
<td align="right">10</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">17</td>
<td align="right">26</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">21</td>
<td align="right">26</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">13</td>
<td align="right">26</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">5</td>
<td align="right">22</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">7</td>
<td align="right">30</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">15</td>
<td align="right">30</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">17</td>
<td align="right">26</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">20</td>
<td align="right">28</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">15</td>
<td align="right">29</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">19</td>
<td align="right">32</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">18</td>
<td align="right">31</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">26</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">17</td>
<td align="right">33</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">14</td>
<td align="right">19</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">21</td>
<td align="right">30</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">21</td>
<td align="right">34</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">17</td>
<td align="right">30</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">15</td>
<td align="right">25</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">26</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">23</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">18</td>
<td align="right">34</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">15</td>
<td align="right">28</td>
<td align="right">27</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">16</td>
<td align="right">29</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">19</td>
<td align="right">32</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">16</td>
<td align="right">33</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">20</td>
<td align="right">21</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">19</td>
<td align="right">30</td>
<td align="right">28</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter8.html#cb33-1"></a><span class="co">#pyschological data of females</span></span>
<span id="cb33-2"><a href="chapter8.html#cb33-2"></a></span>
<span id="cb33-3"><a href="chapter8.html#cb33-3"></a>y_1f &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb33-4"><a href="chapter8.html#cb33-4"></a>  <span class="dv">14</span>,   <span class="dv">13</span>, <span class="dv">12</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">16</span>, <span class="dv">13</span>, <span class="dv">2</span>,  <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">12</span>, <span class="dv">14</span>, <span class="dv">13</span>, <span class="dv">11</span>, <span class="dv">7</span>,  <span class="dv">12</span>, <span class="dv">6</span></span>
<span id="cb33-5"><a href="chapter8.html#cb33-5"></a>  )</span>
<span id="cb33-6"><a href="chapter8.html#cb33-6"></a></span>
<span id="cb33-7"><a href="chapter8.html#cb33-7"></a></span>
<span id="cb33-8"><a href="chapter8.html#cb33-8"></a>y_2f &lt;-<span class="kw">c</span>(</span>
<span id="cb33-9"><a href="chapter8.html#cb33-9"></a>  <span class="dv">12</span>,   <span class="dv">14</span>, <span class="dv">19</span>, <span class="dv">13</span>, <span class="dv">20</span>, <span class="dv">9</span>,  <span class="dv">13</span>, <span class="dv">8</span>,  <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">10</span>, <span class="dv">16</span>, <span class="dv">8</span>,  <span class="dv">16</span>, <span class="dv">21</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">6</span>,  <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">13</span>, <span class="dv">14</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">7</span>,  <span class="dv">15</span>, <span class="dv">5</span></span>
<span id="cb33-10"><a href="chapter8.html#cb33-10"></a>  )</span>
<span id="cb33-11"><a href="chapter8.html#cb33-11"></a></span>
<span id="cb33-12"><a href="chapter8.html#cb33-12"></a>y_3f &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb33-13"><a href="chapter8.html#cb33-13"></a>  <span class="dv">14</span>,   <span class="dv">12</span>, <span class="dv">21</span>, <span class="dv">10</span>, <span class="dv">16</span>, <span class="dv">14</span>, <span class="dv">18</span>, <span class="dv">13</span>, <span class="dv">19</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">13</span>, <span class="dv">25</span>, <span class="dv">8</span>,  <span class="dv">13</span>, <span class="dv">23</span>, <span class="dv">26</span>, <span class="dv">14</span>, <span class="dv">15</span>, <span class="dv">23</span>, <span class="dv">16</span>, <span class="dv">22</span>, <span class="dv">22</span>, <span class="dv">16</span>, <span class="dv">20</span>, <span class="dv">12</span>, <span class="dv">24</span>, <span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">19</span>, <span class="dv">7</span>,  <span class="dv">6</span></span>
<span id="cb33-14"><a href="chapter8.html#cb33-14"></a>  )</span>
<span id="cb33-15"><a href="chapter8.html#cb33-15"></a></span>
<span id="cb33-16"><a href="chapter8.html#cb33-16"></a>y_4f &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb33-17"><a href="chapter8.html#cb33-17"></a>  <span class="dv">26</span>,   <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">18</span>, <span class="dv">24</span>, <span class="dv">23</span>, <span class="dv">23</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">26</span>, <span class="dv">14</span>, <span class="dv">23</span>, <span class="dv">24</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">26</span>, <span class="dv">9</span>,  <span class="dv">23</span>, <span class="dv">20</span>, <span class="dv">28</span>, <span class="dv">18</span>, <span class="dv">28</span>, <span class="dv">13</span></span>
<span id="cb33-18"><a href="chapter8.html#cb33-18"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapter8.html#cb34-1"></a>data542_female &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb34-2"><a href="chapter8.html#cb34-2"></a>  y_1f, y_2f, y_3f, y_4f</span>
<span id="cb34-3"><a href="chapter8.html#cb34-3"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="chapter8.html#cb35-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb35-2"><a href="chapter8.html#cb35-2"></a>  data542_female, <span class="dt">caption =</span> <span class="st">&#39;Data Female&#39;</span>,</span>
<span id="cb35-3"><a href="chapter8.html#cb35-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb35-4"><a href="chapter8.html#cb35-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-20">Table 8.4: </span>Data Female</caption>
<thead>
<tr class="header">
<th align="right">y_1f</th>
<th align="right">y_2f</th>
<th align="right">y_3f</th>
<th align="right">y_4f</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">14</td>
<td align="right">12</td>
<td align="right">14</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">14</td>
<td align="right">12</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">19</td>
<td align="right">21</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">13</td>
<td align="right">10</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">20</td>
<td align="right">16</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">9</td>
<td align="right">14</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">13</td>
<td align="right">18</td>
<td align="right">24</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">8</td>
<td align="right">13</td>
<td align="right">23</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">20</td>
<td align="right">19</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">10</td>
<td align="right">11</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">18</td>
<td align="right">25</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">18</td>
<td align="right">13</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">10</td>
<td align="right">25</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">8</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">8</td>
<td align="right">13</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">23</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">21</td>
<td align="right">26</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">17</td>
<td align="right">14</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">16</td>
<td align="right">15</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">16</td>
<td align="right">23</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">6</td>
<td align="right">16</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">16</td>
<td align="right">22</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">17</td>
<td align="right">22</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">13</td>
<td align="right">16</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">14</td>
<td align="right">20</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">10</td>
<td align="right">12</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">17</td>
<td align="right">24</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">15</td>
<td align="right">18</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">16</td>
<td align="right">18</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">7</td>
<td align="right">19</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">15</td>
<td align="right">7</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">5</td>
<td align="right">6</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<p>Calculating <span class="math inline">\(T^{2}\)</span> using our functions:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapter8.html#cb36-1"></a>T2 &lt;-<span class="st"> </span><span class="kw">calc_T2</span>(data542_male, data542_female)</span>
<span id="cb36-2"><a href="chapter8.html#cb36-2"></a>T2</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 97.6015</code></pre>
<p>Calculating <span class="math inline">\(a\)</span></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chapter8.html#cb38-1"></a>a &lt;-<span class="st"> </span><span class="kw">optim_dir</span>(data542_male, data542_female)</span>
<span id="cb38-2"><a href="chapter8.html#cb38-2"></a><span class="kw">print</span>(a)</span></code></pre></div>
<pre><code>##            [,1]
## y_1m  0.5104227
## y_2m -0.2032933
## y_3m  0.4660420
## y_4m -0.3096697</code></pre>
<blockquote>
<p>T2</p>
</blockquote>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="chapter8.html#cb40-1"></a><span class="co">#function for finding the T^2 in a multivariate two sample setting</span></span>
<span id="cb40-2"><a href="chapter8.html#cb40-2"></a></span>
<span id="cb40-3"><a href="chapter8.html#cb40-3"></a>T2_two_sample&lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2) {</span>
<span id="cb40-4"><a href="chapter8.html#cb40-4"></a>  <span class="st">&quot;</span></span>
<span id="cb40-5"><a href="chapter8.html#cb40-5"></a></span>
<span id="cb40-6"><a href="chapter8.html#cb40-6"></a><span class="st">  &quot;</span></span>
<span id="cb40-7"><a href="chapter8.html#cb40-7"></a>  n_<span class="dv">1</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb40-8"><a href="chapter8.html#cb40-8"></a>  n_<span class="dv">2</span>&lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb40-9"><a href="chapter8.html#cb40-9"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1)</span>
<span id="cb40-10"><a href="chapter8.html#cb40-10"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2)</span>
<span id="cb40-11"><a href="chapter8.html#cb40-11"></a>  </span>
<span id="cb40-12"><a href="chapter8.html#cb40-12"></a>  y_mean_<span class="dv">1</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb40-13"><a href="chapter8.html#cb40-13"></a>  <span class="kw">apply</span>(data1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb40-14"><a href="chapter8.html#cb40-14"></a>        )</span>
<span id="cb40-15"><a href="chapter8.html#cb40-15"></a>  )</span>
<span id="cb40-16"><a href="chapter8.html#cb40-16"></a>  </span>
<span id="cb40-17"><a href="chapter8.html#cb40-17"></a>  y_mean_<span class="dv">2</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb40-18"><a href="chapter8.html#cb40-18"></a>  <span class="kw">apply</span>(data2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb40-19"><a href="chapter8.html#cb40-19"></a>        )</span>
<span id="cb40-20"><a href="chapter8.html#cb40-20"></a>  )</span>
<span id="cb40-21"><a href="chapter8.html#cb40-21"></a>  sigma_population&lt;-(</span>
<span id="cb40-22"><a href="chapter8.html#cb40-22"></a>    <span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)</span>
<span id="cb40-23"><a href="chapter8.html#cb40-23"></a>    )<span class="op">*</span>(</span>
<span id="cb40-24"><a href="chapter8.html#cb40-24"></a>    (n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span></span>
<span id="cb40-25"><a href="chapter8.html#cb40-25"></a>    )</span>
<span id="cb40-26"><a href="chapter8.html#cb40-26"></a>  </span>
<span id="cb40-27"><a href="chapter8.html#cb40-27"></a>  sigma_population_inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma_population)</span>
<span id="cb40-28"><a href="chapter8.html#cb40-28"></a>  T2 &lt;&lt;-<span class="st"> </span>((n_<span class="dv">1</span><span class="op">*</span>n_<span class="dv">2</span>)<span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2</span>))<span class="op">*</span><span class="kw">t</span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>) <span class="op">%*%</span><span class="st"> </span>sigma_population_inverse <span class="op">%*%</span><span class="st"> </span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>)</span>
<span id="cb40-29"><a href="chapter8.html#cb40-29"></a>  </span>
<span id="cb40-30"><a href="chapter8.html#cb40-30"></a>  <span class="kw">print</span>(<span class="st">&quot;The pooled covariance matrix is:&quot;</span>)</span>
<span id="cb40-31"><a href="chapter8.html#cb40-31"></a>  <span class="kw">print</span>(sigma_population)</span>
<span id="cb40-32"><a href="chapter8.html#cb40-32"></a>  <span class="kw">print</span>(<span class="st">&quot;The value of T2 is:&quot;</span>)</span>
<span id="cb40-33"><a href="chapter8.html#cb40-33"></a>  <span class="kw">print</span> (T2)</span>
<span id="cb40-34"><a href="chapter8.html#cb40-34"></a>}</span>
<span id="cb40-35"><a href="chapter8.html#cb40-35"></a></span>
<span id="cb40-36"><a href="chapter8.html#cb40-36"></a>T2&lt;-<span class="kw">T2_two_sample</span>(data542_female, data542_male)</span></code></pre></div>
<pre><code>## [1] &quot;The pooled covariance matrix is:&quot;
##          y_1f      y_2f      y_3f      y_4f
## y_1f 7.164315  6.047379  5.693044  4.700605
## y_2f 6.047379 15.894153  8.492440  5.855847
## y_3f 5.693044  8.492440 29.356351 13.980847
## y_4f 4.700605  5.855847 13.980847 22.320565
## [1] &quot;The value of T2 is:&quot;
##         [,1]
## [1,] 97.6015</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chapter8.html#cb42-1"></a>discriminant_function &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2) {</span>
<span id="cb42-2"><a href="chapter8.html#cb42-2"></a>    <span class="st">&quot;</span></span>
<span id="cb42-3"><a href="chapter8.html#cb42-3"></a><span class="st">    This function determines the discriminat function coefficient vector</span></span>
<span id="cb42-4"><a href="chapter8.html#cb42-4"></a><span class="st">    </span></span>
<span id="cb42-5"><a href="chapter8.html#cb42-5"></a></span>
<span id="cb42-6"><a href="chapter8.html#cb42-6"></a><span class="st">    Input: </span></span>
<span id="cb42-7"><a href="chapter8.html#cb42-7"></a><span class="st">    + data1: dataset from sample 1</span></span>
<span id="cb42-8"><a href="chapter8.html#cb42-8"></a><span class="st">    + data2: dataset from sample 2</span></span>
<span id="cb42-9"><a href="chapter8.html#cb42-9"></a></span>
<span id="cb42-10"><a href="chapter8.html#cb42-10"></a><span class="st">    Output:</span></span>
<span id="cb42-11"><a href="chapter8.html#cb42-11"></a><span class="st">    + a: discriminant function coefficient vector</span></span>
<span id="cb42-12"><a href="chapter8.html#cb42-12"></a><span class="st">  </span></span>
<span id="cb42-13"><a href="chapter8.html#cb42-13"></a><span class="st">    &quot;</span></span>
<span id="cb42-14"><a href="chapter8.html#cb42-14"></a>  n_<span class="dv">1</span> &lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb42-15"><a href="chapter8.html#cb42-15"></a>  n_<span class="dv">2</span>&lt;&lt;-<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb42-16"><a href="chapter8.html#cb42-16"></a>  sigma_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data1)</span>
<span id="cb42-17"><a href="chapter8.html#cb42-17"></a>  sigma_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">cov</span>(data2)</span>
<span id="cb42-18"><a href="chapter8.html#cb42-18"></a>  </span>
<span id="cb42-19"><a href="chapter8.html#cb42-19"></a>  y_mean_<span class="dv">1</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb42-20"><a href="chapter8.html#cb42-20"></a>  <span class="kw">apply</span>(data1, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb42-21"><a href="chapter8.html#cb42-21"></a>        )</span>
<span id="cb42-22"><a href="chapter8.html#cb42-22"></a>  )</span>
<span id="cb42-23"><a href="chapter8.html#cb42-23"></a>  </span>
<span id="cb42-24"><a href="chapter8.html#cb42-24"></a>  y_mean_<span class="dv">2</span>&lt;-<span class="kw">as.matrix</span>(</span>
<span id="cb42-25"><a href="chapter8.html#cb42-25"></a>  <span class="kw">apply</span>(data2, <span class="dv">2</span>, <span class="dt">FUN=</span>mean</span>
<span id="cb42-26"><a href="chapter8.html#cb42-26"></a>        )</span>
<span id="cb42-27"><a href="chapter8.html#cb42-27"></a>  )</span>
<span id="cb42-28"><a href="chapter8.html#cb42-28"></a>  sigma_population&lt;-(</span>
<span id="cb42-29"><a href="chapter8.html#cb42-29"></a>    <span class="dv">1</span><span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span>)</span>
<span id="cb42-30"><a href="chapter8.html#cb42-30"></a>    )<span class="op">*</span>(</span>
<span id="cb42-31"><a href="chapter8.html#cb42-31"></a>    (n_<span class="dv">1-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(n_<span class="dv">2-1</span>) <span class="op">*</span><span class="st"> </span>sigma_<span class="dv">2</span></span>
<span id="cb42-32"><a href="chapter8.html#cb42-32"></a>    )</span>
<span id="cb42-33"><a href="chapter8.html#cb42-33"></a>  </span>
<span id="cb42-34"><a href="chapter8.html#cb42-34"></a>  sigma_population_inverse &lt;-<span class="st"> </span><span class="kw">solve</span>(sigma_population)</span>
<span id="cb42-35"><a href="chapter8.html#cb42-35"></a>  a &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(sigma_population_inverse<span class="op">%*%</span>(y_mean_<span class="dv">1</span><span class="op">-</span>y_mean_<span class="dv">2</span>))</span>
<span id="cb42-36"><a href="chapter8.html#cb42-36"></a>  <span class="kw">print</span>(</span>
<span id="cb42-37"><a href="chapter8.html#cb42-37"></a>      <span class="st">&quot;The discriminant coeficient vector is: &quot;</span></span>
<span id="cb42-38"><a href="chapter8.html#cb42-38"></a>      )</span>
<span id="cb42-39"><a href="chapter8.html#cb42-39"></a>  <span class="kw">print</span>(<span class="kw">round</span>(a, <span class="dv">4</span>))</span>
<span id="cb42-40"><a href="chapter8.html#cb42-40"></a>}</span>
<span id="cb42-41"><a href="chapter8.html#cb42-41"></a></span>
<span id="cb42-42"><a href="chapter8.html#cb42-42"></a>a&lt;-<span class="kw">discriminant_function</span>(data542_female, data542_male)</span></code></pre></div>
<pre><code>## [1] &quot;The discriminant coeficient vector is: &quot;
##         [,1]
## y_1f -0.5104
## y_2f  0.2033
## y_3f -0.4660
## y_4f  0.3097</code></pre>
<p>We use the same data to obtain</p>
<p>We define <strong>b</strong>, as a vector of regression coefficients when <span class="math inline">\(w\)</span> is fit to the <span class="math inline">\(y´s\)</span>"
<span class="math display">\[b=\frac{n_1n_2}{(n_1+n_2)(n_1+n_2-2+T^2)}a\]</span>
, where <span class="math inline">\(T^2=[n_1n_2/(n_1+n_2)](\bar{y}_{1}-\bar{y}_{2})&#39;S_{pl}^{-1}(\bar{y}_1 - \bar{y}_2)\)</span>.</p>
<p>From (5.20), we also know the squared multiple correlation <span class="math inline">\(R^2\)</span> is related to <span class="math inline">\(T^2\)</span> by:</p>
<p><span class="math display">\[R^2=(\bar{y}_{1}- \bar{y}_{2})&#39;b=\frac{T^2}{n_1+n_2-2+T^2}\]</span></p>
<blockquote>
<p>b</p>
</blockquote>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="chapter8.html#cb44-1"></a>regression_coefficientes &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2, a, T2) {</span>
<span id="cb44-2"><a href="chapter8.html#cb44-2"></a>  <span class="st">&quot;</span></span>
<span id="cb44-3"><a href="chapter8.html#cb44-3"></a></span>
<span id="cb44-4"><a href="chapter8.html#cb44-4"></a><span class="st">  &quot;</span></span>
<span id="cb44-5"><a href="chapter8.html#cb44-5"></a>  n_<span class="dv">1</span>=<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb44-6"><a href="chapter8.html#cb44-6"></a>  n_<span class="dv">2</span>=<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb44-7"><a href="chapter8.html#cb44-7"></a>  b &lt;-<span class="st"> </span><span class="kw">as.double</span>((n_<span class="dv">1</span><span class="op">*</span>n_<span class="dv">2</span>)<span class="op">/</span>((n_<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>n_<span class="dv">2</span>)<span class="op">*</span>(n_<span class="dv">1</span><span class="op">+</span><span class="st"> </span>n_<span class="dv">2-2</span><span class="op">+</span>T2)))<span class="op">*</span>a</span>
<span id="cb44-8"><a href="chapter8.html#cb44-8"></a></span>
<span id="cb44-9"><a href="chapter8.html#cb44-9"></a>  <span class="co">#b &lt;- as.matrix((n_1* n_2/((n_1 + n_2)%*%(n_1+ n_2-2+T2)))*a)</span></span>
<span id="cb44-10"><a href="chapter8.html#cb44-10"></a>  <span class="kw">print</span>(<span class="st">&quot;The vector of regression coefficientes is:&quot;</span>)</span>
<span id="cb44-11"><a href="chapter8.html#cb44-11"></a>  <span class="kw">print</span>(b)</span>
<span id="cb44-12"><a href="chapter8.html#cb44-12"></a>}</span>
<span id="cb44-13"><a href="chapter8.html#cb44-13"></a><span class="kw">regression_coefficientes</span>(data542_female, data542_male,a,T2)</span></code></pre></div>
<pre><code>## [1] &quot;The vector of regression coefficientes is:&quot;
##             [,1]
## y_1f -0.05116744
## y_2f  0.02038076
## y_3f -0.04671635
## y_4f  0.03104733</code></pre>
<blockquote>
<p>R2</p>
</blockquote>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chapter8.html#cb46-1"></a>r2 &lt;-<span class="st"> </span><span class="cf">function</span>(data1, data2,T2) {</span>
<span id="cb46-2"><a href="chapter8.html#cb46-2"></a>  <span class="st">&quot;</span></span>
<span id="cb46-3"><a href="chapter8.html#cb46-3"></a><span class="st">  Function to obtain the squared multiple correlation R2</span></span>
<span id="cb46-4"><a href="chapter8.html#cb46-4"></a><span class="st">  &quot;</span></span>
<span id="cb46-5"><a href="chapter8.html#cb46-5"></a>  n_<span class="dv">1</span>=<span class="st"> </span><span class="kw">nrow</span>(data1)</span>
<span id="cb46-6"><a href="chapter8.html#cb46-6"></a>  n_<span class="dv">2</span>=<span class="st"> </span><span class="kw">nrow</span>(data2)</span>
<span id="cb46-7"><a href="chapter8.html#cb46-7"></a>  r2 &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">as.double</span>(T2<span class="op">/</span>(n_<span class="dv">1</span><span class="op">+</span>n_<span class="dv">2-2</span><span class="op">+</span>T2)),<span class="dv">4</span>)</span>
<span id="cb46-8"><a href="chapter8.html#cb46-8"></a>  <span class="kw">print</span>(<span class="kw">paste0</span>(<span class="st">&quot;The squared multiple correlation (R2) is: &quot;</span>, r2))</span>
<span id="cb46-9"><a href="chapter8.html#cb46-9"></a>}</span>
<span id="cb46-10"><a href="chapter8.html#cb46-10"></a><span class="kw">r2</span>(data542_female, data542_male, T2)</span></code></pre></div>
<pre><code>## [1] &quot;The squared multiple correlation (R2) is: 0.6115&quot;</code></pre>
</div>
</div>
<div id="discriminant-analysis-for-several-groups" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Discriminant Analysis For Several Groups</h2>
<p>“In discriminant analysis for several groups, we are concerned with finding linear combinations of variables that best separate the k groups of multivariate observations. Discriminant analysis for several groups may serve any one of various pur- poses:
1. Examine group separation in a two-dimensional plot. When there are more than two groups, it requires more than one discriminant function to describe group separation. If the points in the p-dimensional space are projected onto a 2-dimensional space represented by the first t”wo discriminant functions, we obtain the best possible view of how the groups are separated.
2. Find a subset of the original variables that separates the groups almost as well as the original set. This topic was introduced in Section 6.11.2.
3. Rank the variables in terms of their relative contribution to group separation. This use for discriminant functions has been mentioned in Sections 5.5, 6.1.4, 6.1.8, and 6.4. In Section 8.5, we discuss standardized discriminant function coefficients that provide a more valid comparison of the variables.
4. Interpret the new dimensions represented by the discriminant functions.
5. Follow up to fixed-effects MANOVA."</p>
<div id="example-8.4.1." class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Example 8.4.1.</h3>
<p>The data in <em>Table 8.3</em> were collected by G.R.Bryce and R. M. Baker as part of a preliminary study of possible link between football helmet design and neck injuries.</p>
<p>Six head measurements were made on the subject. There were 30 subjects in each of the three groups: high school football players (group 1), college football playes (group 2); and nonfootball players(group 3). The six variables are:</p>
<p><span class="math display">\[ wdim = \textit{head width at widest dimension}\]</span>
<span class="math display">\[ circum = \textit{head circumference}\]</span></p>
<p><span class="math display">\[fbeye = \textit{front-to-back measurements at eye level}\]</span></p>
<p><span class="math display">\[eyehd = \textit{eye-to-top-of-head measurements}\]</span></p>
<p><span class="math display">\[earhd = \textit{ear-to-top-of-head measurements}\]</span></p>
<p><span class="math display">\[jaw = \textit{jaw width}\]</span></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="chapter8.html#cb48-1"></a>footballHeads &lt;-<span class="kw">read.table</span>(<span class="st">&quot;T8_3_FOOTBALL.DAT&quot;</span>)</span>
<span id="cb48-2"><a href="chapter8.html#cb48-2"></a><span class="kw">names</span>(footballHeads) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;wdim&quot;</span>, <span class="st">&quot;circum&quot;</span>, <span class="st">&quot;fbeye&quot;</span>, <span class="st">&quot;eyehd&quot;</span>, <span class="st">&quot;earhd&quot;</span>, <span class="st">&quot;jaw&quot;</span>)</span>
<span id="cb48-3"><a href="chapter8.html#cb48-3"></a>footballHeads[, <span class="st">&#39;group&#39;</span>] &lt;-<span class="st"> </span><span class="kw">as.factor</span>(footballHeads[, <span class="st">&#39;group&#39;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="chapter8.html#cb49-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(</span>
<span id="cb49-2"><a href="chapter8.html#cb49-2"></a>  footballHeads, <span class="dt">caption =</span> <span class="st">&#39;Football Heads&#39;</span>,</span>
<span id="cb49-3"><a href="chapter8.html#cb49-3"></a>  <span class="dt">booktabs =</span> <span class="ot">TRUE</span></span>
<span id="cb49-4"><a href="chapter8.html#cb49-4"></a>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-28">Table 8.5: </span>Football Heads</caption>
<thead>
<tr class="header">
<th align="left">group</th>
<th align="right">wdim</th>
<th align="right">circum</th>
<th align="right">fbeye</th>
<th align="right">eyehd</th>
<th align="right">earhd</th>
<th align="right">jaw</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">13.5</td>
<td align="right">57.15</td>
<td align="right">19.50</td>
<td align="right">12.5</td>
<td align="right">14.0</td>
<td align="right">11.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">58.42</td>
<td align="right">21.00</td>
<td align="right">12.0</td>
<td align="right">16.0</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">14.5</td>
<td align="right">55.88</td>
<td align="right">19.00</td>
<td align="right">10.0</td>
<td align="right">13.0</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">58.42</td>
<td align="right">20.00</td>
<td align="right">13.5</td>
<td align="right">15.0</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">14.5</td>
<td align="right">58.42</td>
<td align="right">20.00</td>
<td align="right">13.0</td>
<td align="right">15.5</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">14.0</td>
<td align="right">60.96</td>
<td align="right">21.00</td>
<td align="right">12.0</td>
<td align="right">14.0</td>
<td align="right">13.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.0</td>
<td align="right">58.42</td>
<td align="right">19.50</td>
<td align="right">13.5</td>
<td align="right">15.5</td>
<td align="right">13.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.0</td>
<td align="right">58.42</td>
<td align="right">21.00</td>
<td align="right">13.0</td>
<td align="right">14.0</td>
<td align="right">13.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">59.69</td>
<td align="right">20.50</td>
<td align="right">13.5</td>
<td align="right">14.5</td>
<td align="right">12.5</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">59.69</td>
<td align="right">20.50</td>
<td align="right">13.0</td>
<td align="right">15.0</td>
<td align="right">13.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.0</td>
<td align="right">57.15</td>
<td align="right">19.00</td>
<td align="right">14.0</td>
<td align="right">14.5</td>
<td align="right">11.5</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">59.69</td>
<td align="right">21.00</td>
<td align="right">13.0</td>
<td align="right">16.0</td>
<td align="right">12.5</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">16.0</td>
<td align="right">57.15</td>
<td align="right">19.00</td>
<td align="right">14.0</td>
<td align="right">14.5</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">62.23</td>
<td align="right">21.50</td>
<td align="right">14.0</td>
<td align="right">16.0</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">57.15</td>
<td align="right">19.50</td>
<td align="right">13.5</td>
<td align="right">15.0</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">14.0</td>
<td align="right">60.96</td>
<td align="right">20.00</td>
<td align="right">15.0</td>
<td align="right">15.0</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">14.5</td>
<td align="right">58.42</td>
<td align="right">20.00</td>
<td align="right">12.0</td>
<td align="right">14.5</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.0</td>
<td align="right">56.90</td>
<td align="right">19.00</td>
<td align="right">13.0</td>
<td align="right">14.0</td>
<td align="right">12.5</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">59.69</td>
<td align="right">20.00</td>
<td align="right">12.5</td>
<td align="right">14.0</td>
<td align="right">12.5</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.0</td>
<td align="right">57.15</td>
<td align="right">19.50</td>
<td align="right">12.0</td>
<td align="right">14.0</td>
<td align="right">11.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.0</td>
<td align="right">56.90</td>
<td align="right">19.00</td>
<td align="right">12.0</td>
<td align="right">13.0</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">56.90</td>
<td align="right">19.50</td>
<td align="right">14.5</td>
<td align="right">14.5</td>
<td align="right">13.0</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">17.5</td>
<td align="right">63.50</td>
<td align="right">21.50</td>
<td align="right">14.0</td>
<td align="right">15.5</td>
<td align="right">13.5</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">57.15</td>
<td align="right">19.00</td>
<td align="right">13.0</td>
<td align="right">15.5</td>
<td align="right">12.5</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">60.96</td>
<td align="right">20.50</td>
<td align="right">12.0</td>
<td align="right">13.0</td>
<td align="right">12.5</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">60.96</td>
<td align="right">21.00</td>
<td align="right">14.5</td>
<td align="right">15.5</td>
<td align="right">12.5</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">63.50</td>
<td align="right">21.75</td>
<td align="right">14.5</td>
<td align="right">16.5</td>
<td align="right">13.5</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">14.5</td>
<td align="right">58.42</td>
<td align="right">20.50</td>
<td align="right">13.0</td>
<td align="right">16.0</td>
<td align="right">10.5</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">15.5</td>
<td align="right">56.90</td>
<td align="right">20.00</td>
<td align="right">13.5</td>
<td align="right">14.0</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">16.0</td>
<td align="right">60.96</td>
<td align="right">20.00</td>
<td align="right">12.5</td>
<td align="right">14.5</td>
<td align="right">12.5</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.5</td>
<td align="right">59.69</td>
<td align="right">21.10</td>
<td align="right">10.3</td>
<td align="right">13.4</td>
<td align="right">12.4</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.4</td>
<td align="right">59.70</td>
<td align="right">20.00</td>
<td align="right">12.8</td>
<td align="right">14.5</td>
<td align="right">11.3</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.1</td>
<td align="right">59.70</td>
<td align="right">20.20</td>
<td align="right">11.4</td>
<td align="right">14.1</td>
<td align="right">12.1</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">14.3</td>
<td align="right">56.90</td>
<td align="right">18.90</td>
<td align="right">11.0</td>
<td align="right">13.4</td>
<td align="right">11.0</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">14.8</td>
<td align="right">58.00</td>
<td align="right">20.10</td>
<td align="right">9.6</td>
<td align="right">11.1</td>
<td align="right">11.7</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.2</td>
<td align="right">57.50</td>
<td align="right">18.50</td>
<td align="right">9.9</td>
<td align="right">12.8</td>
<td align="right">11.4</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.4</td>
<td align="right">58.00</td>
<td align="right">20.80</td>
<td align="right">10.2</td>
<td align="right">12.8</td>
<td align="right">11.9</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">16.3</td>
<td align="right">58.00</td>
<td align="right">20.10</td>
<td align="right">8.8</td>
<td align="right">13.0</td>
<td align="right">12.9</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.5</td>
<td align="right">57.00</td>
<td align="right">19.60</td>
<td align="right">10.5</td>
<td align="right">13.9</td>
<td align="right">11.8</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.0</td>
<td align="right">56.50</td>
<td align="right">19.60</td>
<td align="right">10.4</td>
<td align="right">14.5</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.5</td>
<td align="right">57.20</td>
<td align="right">20.00</td>
<td align="right">11.2</td>
<td align="right">13.4</td>
<td align="right">12.4</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.5</td>
<td align="right">56.50</td>
<td align="right">19.80</td>
<td align="right">9.2</td>
<td align="right">12.8</td>
<td align="right">12.2</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.7</td>
<td align="right">57.50</td>
<td align="right">19.80</td>
<td align="right">11.8</td>
<td align="right">12.6</td>
<td align="right">12.5</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">14.4</td>
<td align="right">57.00</td>
<td align="right">20.40</td>
<td align="right">10.2</td>
<td align="right">12.7</td>
<td align="right">12.3</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">14.9</td>
<td align="right">54.80</td>
<td align="right">18.50</td>
<td align="right">11.2</td>
<td align="right">13.8</td>
<td align="right">11.3</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">16.5</td>
<td align="right">59.80</td>
<td align="right">20.20</td>
<td align="right">9.4</td>
<td align="right">14.3</td>
<td align="right">12.2</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.5</td>
<td align="right">56.10</td>
<td align="right">18.80</td>
<td align="right">9.8</td>
<td align="right">13.8</td>
<td align="right">12.6</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.3</td>
<td align="right">55.00</td>
<td align="right">19.00</td>
<td align="right">10.1</td>
<td align="right">14.2</td>
<td align="right">11.6</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">14.5</td>
<td align="right">55.60</td>
<td align="right">19.30</td>
<td align="right">12.0</td>
<td align="right">12.6</td>
<td align="right">11.6</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.5</td>
<td align="right">56.50</td>
<td align="right">20.00</td>
<td align="right">9.9</td>
<td align="right">13.4</td>
<td align="right">11.5</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.2</td>
<td align="right">55.00</td>
<td align="right">19.30</td>
<td align="right">9.9</td>
<td align="right">14.4</td>
<td align="right">11.9</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.3</td>
<td align="right">56.50</td>
<td align="right">19.30</td>
<td align="right">9.1</td>
<td align="right">12.8</td>
<td align="right">11.7</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.3</td>
<td align="right">56.80</td>
<td align="right">20.20</td>
<td align="right">8.6</td>
<td align="right">14.2</td>
<td align="right">11.5</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.8</td>
<td align="right">55.50</td>
<td align="right">19.20</td>
<td align="right">8.2</td>
<td align="right">13.0</td>
<td align="right">12.6</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">14.8</td>
<td align="right">57.00</td>
<td align="right">20.20</td>
<td align="right">9.8</td>
<td align="right">13.8</td>
<td align="right">10.5</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.2</td>
<td align="right">56.90</td>
<td align="right">19.10</td>
<td align="right">9.6</td>
<td align="right">13.0</td>
<td align="right">11.2</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">15.9</td>
<td align="right">58.80</td>
<td align="right">21.00</td>
<td align="right">8.6</td>
<td align="right">13.5</td>
<td align="right">11.8</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">15.5</td>
<td align="right">57.30</td>
<td align="right">20.10</td>
<td align="right">9.6</td>
<td align="right">14.1</td>
<td align="right">12.3</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">16.5</td>
<td align="right">58.00</td>
<td align="right">19.50</td>
<td align="right">9.0</td>
<td align="right">13.9</td>
<td align="right">13.3</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">17.3</td>
<td align="right">62.60</td>
<td align="right">21.50</td>
<td align="right">10.3</td>
<td align="right">13.8</td>
<td align="right">12.8</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">14.9</td>
<td align="right">56.50</td>
<td align="right">20.40</td>
<td align="right">7.4</td>
<td align="right">13.0</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">15.4</td>
<td align="right">57.50</td>
<td align="right">19.50</td>
<td align="right">10.5</td>
<td align="right">13.8</td>
<td align="right">11.5</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.3</td>
<td align="right">55.40</td>
<td align="right">19.20</td>
<td align="right">9.7</td>
<td align="right">13.3</td>
<td align="right">11.5</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">14.6</td>
<td align="right">56.00</td>
<td align="right">19.80</td>
<td align="right">8.5</td>
<td align="right">12.0</td>
<td align="right">11.5</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">16.2</td>
<td align="right">56.50</td>
<td align="right">19.50</td>
<td align="right">11.5</td>
<td align="right">14.5</td>
<td align="right">11.8</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">14.6</td>
<td align="right">58.00</td>
<td align="right">19.90</td>
<td align="right">13.0</td>
<td align="right">13.4</td>
<td align="right">11.5</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.9</td>
<td align="right">56.70</td>
<td align="right">18.70</td>
<td align="right">10.8</td>
<td align="right">12.8</td>
<td align="right">12.6</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">14.7</td>
<td align="right">55.80</td>
<td align="right">18.70</td>
<td align="right">11.1</td>
<td align="right">13.9</td>
<td align="right">11.2</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.5</td>
<td align="right">58.50</td>
<td align="right">19.40</td>
<td align="right">11.5</td>
<td align="right">13.4</td>
<td align="right">11.9</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">16.1</td>
<td align="right">60.00</td>
<td align="right">20.30</td>
<td align="right">10.6</td>
<td align="right">13.7</td>
<td align="right">12.2</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.2</td>
<td align="right">57.80</td>
<td align="right">19.90</td>
<td align="right">10.4</td>
<td align="right">13.5</td>
<td align="right">11.4</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">15.1</td>
<td align="right">56.00</td>
<td align="right">19.40</td>
<td align="right">10.0</td>
<td align="right">13.1</td>
<td align="right">10.9</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.9</td>
<td align="right">59.80</td>
<td align="right">20.50</td>
<td align="right">12.0</td>
<td align="right">13.6</td>
<td align="right">11.5</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">16.1</td>
<td align="right">57.70</td>
<td align="right">19.70</td>
<td align="right">10.2</td>
<td align="right">13.6</td>
<td align="right">11.5</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.7</td>
<td align="right">58.70</td>
<td align="right">20.70</td>
<td align="right">11.3</td>
<td align="right">13.6</td>
<td align="right">11.3</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">15.3</td>
<td align="right">56.90</td>
<td align="right">19.60</td>
<td align="right">10.5</td>
<td align="right">13.5</td>
<td align="right">12.1</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.3</td>
<td align="right">56.90</td>
<td align="right">19.50</td>
<td align="right">9.9</td>
<td align="right">14.0</td>
<td align="right">12.1</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">15.2</td>
<td align="right">58.00</td>
<td align="right">20.60</td>
<td align="right">11.0</td>
<td align="right">15.1</td>
<td align="right">11.7</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">16.6</td>
<td align="right">59.30</td>
<td align="right">19.90</td>
<td align="right">12.1</td>
<td align="right">14.6</td>
<td align="right">12.1</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">15.5</td>
<td align="right">58.20</td>
<td align="right">19.70</td>
<td align="right">11.7</td>
<td align="right">13.8</td>
<td align="right">12.1</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.8</td>
<td align="right">57.50</td>
<td align="right">18.90</td>
<td align="right">11.8</td>
<td align="right">14.7</td>
<td align="right">11.8</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">16.0</td>
<td align="right">57.20</td>
<td align="right">19.80</td>
<td align="right">10.8</td>
<td align="right">13.9</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.4</td>
<td align="right">57.00</td>
<td align="right">19.80</td>
<td align="right">11.3</td>
<td align="right">14.0</td>
<td align="right">11.4</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">16.0</td>
<td align="right">59.20</td>
<td align="right">20.80</td>
<td align="right">10.4</td>
<td align="right">13.8</td>
<td align="right">12.2</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.4</td>
<td align="right">57.60</td>
<td align="right">19.60</td>
<td align="right">10.2</td>
<td align="right">13.9</td>
<td align="right">11.7</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">15.8</td>
<td align="right">60.30</td>
<td align="right">20.80</td>
<td align="right">12.4</td>
<td align="right">13.4</td>
<td align="right">12.1</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.4</td>
<td align="right">55.00</td>
<td align="right">18.80</td>
<td align="right">10.7</td>
<td align="right">14.2</td>
<td align="right">10.8</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">15.5</td>
<td align="right">58.40</td>
<td align="right">19.80</td>
<td align="right">13.1</td>
<td align="right">14.5</td>
<td align="right">11.7</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">15.7</td>
<td align="right">59.00</td>
<td align="right">20.40</td>
<td align="right">12.1</td>
<td align="right">13.0</td>
<td align="right">12.7</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">17.3</td>
<td align="right">61.70</td>
<td align="right">20.70</td>
<td align="right">11.9</td>
<td align="right">13.3</td>
<td align="right">13.3</td>
</tr>
</tbody>
</table>
<p>The eigen values of <span class="math inline">\(E^-1H\)</span> are:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chapter8.html#cb50-1"></a>data_group &lt;-<span class="st"> </span><span class="kw">split</span>(footballHeads</span>
<span id="cb50-2"><a href="chapter8.html#cb50-2"></a>[,<span class="dv">2</span><span class="op">:</span><span class="dv">7</span>], footballHeads<span class="op">$</span>group)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="chapter8.html#cb51-1"></a>data_means &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">sapply</span>(data_group, <span class="cf">function</span>(x) {<span class="kw">apply</span>(x, <span class="dv">2</span>, mean)}, <span class="dt">simplify =</span> <span class="st">&#39;data.frame&#39;</span>), <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="chapter8.html#cb52-1"></a>total_means &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">colMeans</span>(footballHeads[,<span class="dv">2</span><span class="op">:</span><span class="dv">7</span>]),<span class="dv">2</span>)</span>
<span id="cb52-2"><a href="chapter8.html#cb52-2"></a>total_means</span></code></pre></div>
<pre><code>##   wdim circum  fbeye  eyehd  earhd    jaw 
##  15.40  58.03  19.91  11.37  13.96  12.00</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="chapter8.html#cb54-1"></a>n &lt;-<span class="st"> </span><span class="kw">dim</span>(footballHeads)[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(footballHeads<span class="op">$</span>group))</span>
<span id="cb54-2"><a href="chapter8.html#cb54-2"></a>n</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="chapter8.html#cb56-1"></a><span class="co"># Nrow: number of dependent variables</span></span>
<span id="cb56-2"><a href="chapter8.html#cb56-2"></a><span class="co"># Ncol: number of dependent variables</span></span>
<span id="cb56-3"><a href="chapter8.html#cb56-3"></a></span>
<span id="cb56-4"><a href="chapter8.html#cb56-4"></a><span class="co"># H Matrix</span></span>
<span id="cb56-5"><a href="chapter8.html#cb56-5"></a>H =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">0</span>, <span class="dt">nrow =</span> (<span class="kw">ncol</span>(footballHeads)<span class="op">-</span><span class="dv">1</span>), <span class="dt">ncol =</span>(<span class="kw">ncol</span>(footballHeads)<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb56-6"><a href="chapter8.html#cb56-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(H)[<span class="dv">1</span>]) {</span>
<span id="cb56-7"><a href="chapter8.html#cb56-7"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i) {</span>
<span id="cb56-8"><a href="chapter8.html#cb56-8"></a>    H[i,j] &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((data_means[i,] <span class="op">-</span><span class="st"> </span>total_means[i]) <span class="op">*</span><span class="st"> </span>(data_means[j,] <span class="op">-</span><span class="st"> </span>total_means[j]))</span>
<span id="cb56-9"><a href="chapter8.html#cb56-9"></a>    H[j,i] &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((data_means[j,] <span class="op">-</span><span class="st"> </span>total_means[j]) <span class="op">*</span><span class="st"> </span>(data_means[i,] <span class="op">-</span><span class="st"> </span>total_means[i]))</span>
<span id="cb56-10"><a href="chapter8.html#cb56-10"></a>  }</span>
<span id="cb56-11"><a href="chapter8.html#cb56-11"></a>}</span>
<span id="cb56-12"><a href="chapter8.html#cb56-12"></a><span class="kw">print</span>(H)</span></code></pre></div>
<pre><code>##         [,1]   [,2]   [,3]    [,4]   [,5]   [,6]
## [1,]   2.184 -7.254 -1.806 -13.302 -6.330 -2.736
## [2,]  -7.254 39.546  8.385  75.114 32.994 10.101
## [3,]  -1.806  8.385  1.863  15.777  7.083  2.418
## [4,] -13.302 75.114 15.777 142.938 62.514 18.693
## [5,]  -6.330 32.994  7.083  62.514 27.618  8.715
## [6,]  -2.736 10.101  2.418  18.693  8.715  3.495</code></pre>
<p>Doing a function for calculating <span class="math inline">\(H\)</span> matrix</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="chapter8.html#cb58-1"></a>cal_H_mat &lt;-<span class="st"> </span><span class="cf">function</span>(grouped_data, groupcol){</span>
<span id="cb58-2"><a href="chapter8.html#cb58-2"></a>  <span class="st">&quot;</span></span>
<span id="cb58-3"><a href="chapter8.html#cb58-3"></a><span class="st">  Computes H (see 6.1): </span></span>
<span id="cb58-4"><a href="chapter8.html#cb58-4"></a><span class="st">  Must have the grouped database, and a column which specifices the groups</span></span>
<span id="cb58-5"><a href="chapter8.html#cb58-5"></a><span class="st">  groupcol: column specifing the group </span></span>
<span id="cb58-6"><a href="chapter8.html#cb58-6"></a><span class="st">  &quot;</span></span>
<span id="cb58-7"><a href="chapter8.html#cb58-7"></a>    <span class="co"># assuming that the group variable is the first</span></span>
<span id="cb58-8"><a href="chapter8.html#cb58-8"></a>    ungrouped_data &lt;-<span class="st"> </span><span class="kw">split</span>(grouped_data[,<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(grouped_data)], grouped_data<span class="op">$</span><span class="st">&quot;group&quot;</span>) </span>
<span id="cb58-9"><a href="chapter8.html#cb58-9"></a>    <span class="co"># calculates the mean by group</span></span>
<span id="cb58-10"><a href="chapter8.html#cb58-10"></a>    data_means &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">sapply</span>(ungrouped_data, <span class="cf">function</span>(x) {<span class="kw">apply</span>(x, <span class="dv">2</span>, mean)}, <span class="dt">simplify =</span> <span class="st">&#39;data.frame&#39;</span>), <span class="dv">2</span>)</span>
<span id="cb58-11"><a href="chapter8.html#cb58-11"></a>    <span class="co"># calculate total means by column</span></span>
<span id="cb58-12"><a href="chapter8.html#cb58-12"></a>    total_means &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">colMeans</span>(grouped_data[,<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(grouped_data)]),<span class="dv">2</span>)</span>
<span id="cb58-13"><a href="chapter8.html#cb58-13"></a>    </span>
<span id="cb58-14"><a href="chapter8.html#cb58-14"></a>    <span class="co"># generates empty matrix</span></span>
<span id="cb58-15"><a href="chapter8.html#cb58-15"></a>    H_dim =<span class="st"> </span><span class="kw">ncol</span>(<span class="kw">as.data.frame</span>(grouped_data)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span> </span>
<span id="cb58-16"><a href="chapter8.html#cb58-16"></a>    H =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">0</span>, <span class="dt">nrow =</span> H_dim, <span class="dt">ncol =</span> H_dim)</span>
<span id="cb58-17"><a href="chapter8.html#cb58-17"></a>    <span class="co"># populate the matrix</span></span>
<span id="cb58-18"><a href="chapter8.html#cb58-18"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(H)[<span class="dv">1</span>]) {</span>
<span id="cb58-19"><a href="chapter8.html#cb58-19"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i) {</span>
<span id="cb58-20"><a href="chapter8.html#cb58-20"></a>        H[i,j] &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((data_means[i,] <span class="op">-</span><span class="st"> </span>total_means[i]) <span class="op">*</span><span class="st"> </span>(data_means[j,] <span class="op">-</span><span class="st"> </span>total_means[j]))</span>
<span id="cb58-21"><a href="chapter8.html#cb58-21"></a>        H[j,i] &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((data_means[j,] <span class="op">-</span><span class="st"> </span>total_means[j]) <span class="op">*</span><span class="st"> </span>(data_means[i,] <span class="op">-</span><span class="st"> </span>total_means[i]))</span>
<span id="cb58-22"><a href="chapter8.html#cb58-22"></a>    }</span>
<span id="cb58-23"><a href="chapter8.html#cb58-23"></a>    }</span>
<span id="cb58-24"><a href="chapter8.html#cb58-24"></a>    </span>
<span id="cb58-25"><a href="chapter8.html#cb58-25"></a>  H_mat &lt;-<span class="st"> </span><span class="kw">round</span>(H, <span class="dv">4</span>)</span>
<span id="cb58-26"><a href="chapter8.html#cb58-26"></a>  <span class="kw">print</span>(H_mat)</span>
<span id="cb58-27"><a href="chapter8.html#cb58-27"></a>}</span></code></pre></div>
<p>Testing the function</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="chapter8.html#cb59-1"></a><span class="kw">cal_H_mat</span>(footballHeads, <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<pre><code>##         [,1]   [,2]   [,3]    [,4]   [,5]   [,6]
## [1,]   2.184 -7.254 -1.806 -13.302 -6.330 -2.736
## [2,]  -7.254 39.546  8.385  75.114 32.994 10.101
## [3,]  -1.806  8.385  1.863  15.777  7.083  2.418
## [4,] -13.302 75.114 15.777 142.938 62.514 18.693
## [5,]  -6.330 32.994  7.083  62.514 27.618  8.715
## [6,]  -2.736 10.101  2.418  18.693  8.715  3.495</code></pre>
<p>Calculating <span class="math inline">\(E\)</span> matrix</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="chapter8.html#cb61-1"></a><span class="co"># E Matrix</span></span>
<span id="cb61-2"><a href="chapter8.html#cb61-2"></a>E =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">0</span>, <span class="dt">nrow =</span> (<span class="kw">ncol</span>(footballHeads)<span class="op">-</span><span class="dv">1</span>), <span class="dt">ncol =</span>(<span class="kw">ncol</span>(footballHeads)<span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb61-3"><a href="chapter8.html#cb61-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(E)[<span class="dv">1</span>]) {</span>
<span id="cb61-4"><a href="chapter8.html#cb61-4"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i) {</span>
<span id="cb61-5"><a href="chapter8.html#cb61-5"></a>    b &lt;-<span class="st"> </span><span class="kw">c</span>() </span>
<span id="cb61-6"><a href="chapter8.html#cb61-6"></a>    <span class="cf">for</span> (k <span class="cf">in</span> data_group) {</span>
<span id="cb61-7"><a href="chapter8.html#cb61-7"></a>      a &lt;-<span class="st"> </span><span class="kw">sum</span>((k[,i] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(k[,i])) <span class="op">*</span><span class="st"> </span>(k[,j] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(k[,j])))</span>
<span id="cb61-8"><a href="chapter8.html#cb61-8"></a>      b &lt;-<span class="st"> </span><span class="kw">append</span>(b, a)</span>
<span id="cb61-9"><a href="chapter8.html#cb61-9"></a>    }</span>
<span id="cb61-10"><a href="chapter8.html#cb61-10"></a>    E[i,j] &lt;-<span class="st"> </span><span class="kw">sum</span>(b)</span>
<span id="cb61-11"><a href="chapter8.html#cb61-11"></a>    E[j,i] &lt;-<span class="st"> </span><span class="kw">sum</span>(b)</span>
<span id="cb61-12"><a href="chapter8.html#cb61-12"></a>  }</span>
<span id="cb61-13"><a href="chapter8.html#cb61-13"></a>}</span>
<span id="cb61-14"><a href="chapter8.html#cb61-14"></a></span>
<span id="cb61-15"><a href="chapter8.html#cb61-15"></a>E &lt;-<span class="st"> </span><span class="kw">round</span>(E,<span class="dv">4</span>)</span>
<span id="cb61-16"><a href="chapter8.html#cb61-16"></a>E</span></code></pre></div>
<pre><code>##         [,1]     [,2]    [,3]     [,4]    [,5]    [,6]
## [1,] 37.2560  50.2812 13.7390   7.2900 10.8360 19.8360
## [2,] 50.2812 275.0151 88.7378  56.7853 29.5855 43.9434
## [3,] 13.7390  88.7378 47.4971   6.6822 11.1873 13.8430
## [4,]  7.2900  56.7853  6.6822 107.2243 27.3833  3.6947
## [5,] 10.8360  29.5855 11.1873  27.3833 53.7710  0.7943
## [6,] 19.8360  43.9434 13.8430   3.6947  0.7943 32.6700</code></pre>
<p>Doing a function for calculating <span class="math inline">\(E\)</span> matrix</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="chapter8.html#cb63-1"></a>cal_E_mat &lt;-<span class="st"> </span><span class="cf">function</span>(grouped_data, groupcol){</span>
<span id="cb63-2"><a href="chapter8.html#cb63-2"></a>  <span class="st">&quot;</span></span>
<span id="cb63-3"><a href="chapter8.html#cb63-3"></a><span class="st">  Computes E (see 6.12): </span></span>
<span id="cb63-4"><a href="chapter8.html#cb63-4"></a><span class="st">  Must have the grouped database, and a column which specifices the groups</span></span>
<span id="cb63-5"><a href="chapter8.html#cb63-5"></a><span class="st">  groupcol: column specifing the group </span></span>
<span id="cb63-6"><a href="chapter8.html#cb63-6"></a><span class="st">  &quot;</span> </span>
<span id="cb63-7"><a href="chapter8.html#cb63-7"></a>    <span class="co"># assuming that the group variable is the first</span></span>
<span id="cb63-8"><a href="chapter8.html#cb63-8"></a>    ungrouped_data &lt;-<span class="st"> </span><span class="kw">split</span>(grouped_data[,<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(grouped_data)], grouped_data<span class="op">$</span><span class="st">&quot;group&quot;</span>) </span>
<span id="cb63-9"><a href="chapter8.html#cb63-9"></a>    </span>
<span id="cb63-10"><a href="chapter8.html#cb63-10"></a>    H_dim =<span class="st"> </span><span class="kw">ncol</span>(<span class="kw">as.data.frame</span>(grouped_data)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span> </span>
<span id="cb63-11"><a href="chapter8.html#cb63-11"></a></span>
<span id="cb63-12"><a href="chapter8.html#cb63-12"></a>    <span class="co"># generates empty matrix</span></span>
<span id="cb63-13"><a href="chapter8.html#cb63-13"></a>    E_dim =<span class="st"> </span><span class="kw">ncol</span>(<span class="kw">as.data.frame</span>(grouped_data)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span> </span>
<span id="cb63-14"><a href="chapter8.html#cb63-14"></a>    E =<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">0</span>, <span class="dt">nrow =</span> H_dim, <span class="dt">ncol =</span> H_dim)</span>
<span id="cb63-15"><a href="chapter8.html#cb63-15"></a>    <span class="co"># populate the matrix</span></span>
<span id="cb63-16"><a href="chapter8.html#cb63-16"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(E)[<span class="dv">1</span>]) {</span>
<span id="cb63-17"><a href="chapter8.html#cb63-17"></a>     <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i) {</span>
<span id="cb63-18"><a href="chapter8.html#cb63-18"></a>        b &lt;-<span class="st"> </span><span class="kw">c</span>() </span>
<span id="cb63-19"><a href="chapter8.html#cb63-19"></a>          <span class="cf">for</span> (k <span class="cf">in</span> ungrouped_data) {</span>
<span id="cb63-20"><a href="chapter8.html#cb63-20"></a>            a &lt;-<span class="st"> </span><span class="kw">sum</span>((k[,i] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(k[,i])) <span class="op">*</span><span class="st"> </span>(k[,j] <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(k[,j])))</span>
<span id="cb63-21"><a href="chapter8.html#cb63-21"></a>            b &lt;-<span class="st"> </span><span class="kw">append</span>(b, a)</span>
<span id="cb63-22"><a href="chapter8.html#cb63-22"></a>          }</span>
<span id="cb63-23"><a href="chapter8.html#cb63-23"></a>      E[i,j] &lt;-<span class="st"> </span><span class="kw">sum</span>(b)</span>
<span id="cb63-24"><a href="chapter8.html#cb63-24"></a>      E[j,i] &lt;-<span class="st"> </span><span class="kw">sum</span>(b)</span>
<span id="cb63-25"><a href="chapter8.html#cb63-25"></a>      }</span>
<span id="cb63-26"><a href="chapter8.html#cb63-26"></a>    }</span>
<span id="cb63-27"><a href="chapter8.html#cb63-27"></a>    </span>
<span id="cb63-28"><a href="chapter8.html#cb63-28"></a>  E_mat &lt;-<span class="st"> </span><span class="kw">round</span>(E, <span class="dv">4</span>)</span>
<span id="cb63-29"><a href="chapter8.html#cb63-29"></a>  </span>
<span id="cb63-30"><a href="chapter8.html#cb63-30"></a>}</span>
<span id="cb63-31"><a href="chapter8.html#cb63-31"></a><span class="co"># Testing the function</span></span>
<span id="cb63-32"><a href="chapter8.html#cb63-32"></a><span class="kw">print</span>(<span class="kw">cal_E_mat</span>(footballHeads, <span class="st">&quot;group&quot;</span>))</span></code></pre></div>
<pre><code>##         [,1]     [,2]    [,3]     [,4]    [,5]    [,6]
## [1,] 37.2560  50.2812 13.7390   7.2900 10.8360 19.8360
## [2,] 50.2812 275.0151 88.7378  56.7853 29.5855 43.9434
## [3,] 13.7390  88.7378 47.4971   6.6822 11.1873 13.8430
## [4,]  7.2900  56.7853  6.6822 107.2243 27.3833  3.6947
## [5,] 10.8360  29.5855 11.1873  27.3833 53.7710  0.7943
## [6,] 19.8360  43.9434 13.8430   3.6947  0.7943 32.6700</code></pre>
<p>Then the two eigenvalues are:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="chapter8.html#cb65-1"></a>EH&lt;-<span class="kw">solve</span>(E)<span class="op">%*%</span>H</span>
<span id="cb65-2"><a href="chapter8.html#cb65-2"></a><span class="kw">round</span>(<span class="kw">eigen</span>(EH)<span class="op">$</span>values,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1.919 0.116 0.000 0.000 0.000 0.000</code></pre>
<p><span class="math display">\[\lambda_1=1.919\]</span>
<span class="math display">\[\lambda_2=0.116\]</span></p>
<p>Function for calculating the eigenvalues <span class="math inline">\(\lambda\)</span>:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="chapter8.html#cb67-1"></a>calc_lambdas &lt;-<span class="st"> </span><span class="cf">function</span>(E_mat, H_mat){</span>
<span id="cb67-2"><a href="chapter8.html#cb67-2"></a>  eig_values &lt;-<span class="st"> </span><span class="kw">solve</span>(E_mat)<span class="op">%*%</span>H_mat</span>
<span id="cb67-3"><a href="chapter8.html#cb67-3"></a>  <span class="kw">round</span>(<span class="kw">eigen</span>(eig_values)<span class="op">$</span>values,<span class="dv">3</span>)</span>
<span id="cb67-4"><a href="chapter8.html#cb67-4"></a>}</span>
<span id="cb67-5"><a href="chapter8.html#cb67-5"></a><span class="co"># Testing the function</span></span>
<span id="cb67-6"><a href="chapter8.html#cb67-6"></a><span class="kw">print</span>(<span class="kw">calc_lambdas</span>(E, H))</span></code></pre></div>
<pre><code>## [1] 1.919 0.116 0.000 0.000 0.000 0.000</code></pre>
<p><strong>Computing the eigenvectors</strong>
The matrix E _ 1 H is not symmetric. Many algorithms for computation of eigen- values and eigenvectors accept only symmetric matrices. In Section 6.1.4, it was shown that the eigenvalues of the symmetric matrix ( U _ 1 ) ’ H U ~ are the same as those of E_ 1 H, where E = U’U is the Cholesky factorization of E. However, an adjustment is needed for the eigenvectors. If b is an eigenvector of ( U _ 1 ) ’ H U ~ , then a = U _ 1 b is an eigenvector of E _ 1 H .</p>
<p><strong>corregir esta parte</strong></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="chapter8.html#cb69-1"></a><span class="co"># obtaining the colesky factorization of E: U&#39;U</span></span>
<span id="cb69-2"><a href="chapter8.html#cb69-2"></a><span class="co"># U &lt;- chol(E)</span></span>
<span id="cb69-3"><a href="chapter8.html#cb69-3"></a><span class="co"># # obtaining the eigenvectors od inv(U)&#39;H*inv(U)</span></span>
<span id="cb69-4"><a href="chapter8.html#cb69-4"></a><span class="co"># trans &lt;- t(solve(U)) %*% H %*% solve(U)</span></span>
<span id="cb69-5"><a href="chapter8.html#cb69-5"></a><span class="co"># </span></span>
<span id="cb69-6"><a href="chapter8.html#cb69-6"></a><span class="co"># eigen_trans &lt;- eigen(trans)</span></span>
<span id="cb69-7"><a href="chapter8.html#cb69-7"></a><span class="co"># b1 &lt;- eigen_trans$vectors[,1]</span></span>
<span id="cb69-8"><a href="chapter8.html#cb69-8"></a><span class="co"># solve(U) %*% b1</span></span></code></pre></div>
<p>The corresponding eigenvectors are <span class="math inline">\(LD1\)</span> and <span class="math inline">\(LD2\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="chapter8.html#cb70-1"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;MASS&quot;</span>)){</span>
<span id="cb70-2"><a href="chapter8.html#cb70-2"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb70-3"><a href="chapter8.html#cb70-3"></a>    <span class="kw">library</span>(MASS)</span>
<span id="cb70-4"><a href="chapter8.html#cb70-4"></a>  }</span>
<span id="cb70-5"><a href="chapter8.html#cb70-5"></a></span>
<span id="cb70-6"><a href="chapter8.html#cb70-6"></a>lda_footballHeads &lt;-<span class="st"> </span><span class="kw">lda</span>(group <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> footballHeads)</span>
<span id="cb70-7"><a href="chapter8.html#cb70-7"></a>lda_footballHeads<span class="op">$</span>scaling</span></code></pre></div>
<pre><code>##                 LD1           LD2
## wdim    0.948423100  1.4067750094
## circum -0.003639865 -0.0005126312
## fbeye  -0.006439599 -0.0286176430
## eyehd  -0.647483088  0.5402700415
## earhd  -0.504360916 -0.3839132257
## jaw    -0.828535064 -1.5288556226</code></pre>
<p><span class="math inline">\(LD1\)</span>:</p>
<p><span class="math display">\[a_1=\begin{pmatrix}
0.948423100 \\
-0.003639865 \\
-0.006439599\\
-0.647483088\\
-0.504360916\\
-0.828535064
\end{pmatrix}\]</span></p>
<p><span class="math inline">\(LD2\)</span>:</p>
<p><span class="math display">\[a_2=\begin{pmatrix}
1.4067750094\\
-0.0286176430\\
0.5402700415\\
-0.3839132257\\
-1.5288556226
\end{pmatrix}\]</span></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="chapter8.html#cb72-1"></a><span class="kw">plot</span>(lda_footballHeads)</span></code></pre></div>
<p><img src="multivariate-statistics-R-code_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>The first eigenvalue accounts for a sustantial proportion of the total:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="chapter8.html#cb73-1"></a><span class="kw">eigen</span>(EH)<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span>(<span class="kw">eigen</span>(EH)<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">+</span><span class="kw">eigen</span>(EH)<span class="op">$</span>values[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 0.9429084</code></pre>
<p>Thus the mean vectors lie largely in one dimension, and one discriminant function suffices to describe most of the separation among the three groups.</p>
</div>
<div id="example-8.4.2." class="section level3" number="8.4.2">
<h3><span class="header-section-number">8.4.2</span> Example 8.4.2.</h3>
<p>For the football data of Table 8.3, we obtain the squared canonical correlation between each of the two discriminant functions and the grouping of the variables.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="chapter8.html#cb75-1"></a><span class="kw">eigen</span>(EH)<span class="op">$</span>values[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 1.919458</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="chapter8.html#cb77-1"></a>r1_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">eigen</span>(EH)<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">eigen</span>(EH)<span class="op">$</span>values[<span class="dv">1</span>])</span>
<span id="cb77-2"><a href="chapter8.html#cb77-2"></a><span class="kw">round</span>(r1_<span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.657</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="chapter8.html#cb79-1"></a>r2_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">eigen</span>(EH)<span class="op">$</span>values[<span class="dv">2</span>]<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">eigen</span>(EH)<span class="op">$</span>values[<span class="dv">2</span>])</span>
<span id="cb79-2"><a href="chapter8.html#cb79-2"></a><span class="kw">round</span>(r2_<span class="dv">2</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.104</code></pre>
</div>
</div>
<div id="standarized-discriminant-functions" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Standarized Discriminant Functions</h2>
<p>In Section 5.5, it was noted that in the two-group case the relative contribution of the y’s to separation of the two groups can best be assessed by comparing the coefficients ar,<span class="math inline">\(r = 1,2,...,p\)</span>, in the discriminant function</p>
<p><span class="math display">\[z=a&#39;y=a_1y_1+a_2y_2+···+ a_py_p.\]</span></p>
<p>However, such comparisons are informative only if the y’s are commensurate, that is, measured on the same scale and with comparable variances. If the y’s are not commensurate, we need coefficients <span class="math inline">\(a_r^*\)</span> that are applicable to standardized variables.</p>
<div id="example-8.5." class="section level3" number="8.5.1">
<h3><span class="header-section-number">8.5.1</span> Example 8.5.</h3>
<p>In Example <span class="math inline">\(8.4.1\)</span>, we obtained the discriminant function coefficient vectors <span class="math inline">\(a_1\)</span> and <span class="math inline">\(a_2\)</span> for the football data of Table <span class="math inline">\(8.3\)</span>. Since <span class="math inline">\(\lambda_1/(\lambda_1+\lambda_2)=0.94\)</span>, we concentrate on <span class="math inline">\(a_1\)</span>. To standarize <span class="math inline">\(a_1\)</span>, we need the within sample standard deviations of the variables. The pooled covariance matrix is given by:</p>
<p><span class="math inline">\(S_{pl}=E/87\)</span></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="chapter8.html#cb81-1"></a>Spl &lt;-<span class="st"> </span>E<span class="op">/</span><span class="dv">87</span></span>
<span id="cb81-2"><a href="chapter8.html#cb81-2"></a>Spl</span></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]       [,4]        [,5]        [,6]
## [1,] 0.4282299 0.5779448 0.1579195 0.08379310 0.124551724 0.228000000
## [2,] 0.5779448 3.1610931 1.0199747 0.65270460 0.340063218 0.505096552
## [3,] 0.1579195 1.0199747 0.5459437 0.07680690 0.128589655 0.159114943
## [4,] 0.0837931 0.6527046 0.0768069 1.23246322 0.314750575 0.042467816
## [5,] 0.1245517 0.3400632 0.1285897 0.31475057 0.618057471 0.009129885
## [6,] 0.2280000 0.5050966 0.1591149 0.04246782 0.009129885 0.375517241</code></pre>
<p>Using the square roots of the diagonal elements of <span class="math inline">\(S_{pl}\)</span>, we obtain:</p>
<p><strong>Nota, los signos están invertidos, por eso por el momento se le agregó un “-” a a1 y a2</strong></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="chapter8.html#cb83-1"></a><span class="co"># digonal elements of Spl</span></span>
<span id="cb83-2"><a href="chapter8.html#cb83-2"></a>diag_sqrt_spl &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">diag</span>(Spl))</span>
<span id="cb83-3"><a href="chapter8.html#cb83-3"></a><span class="co"># from the last example we extract the eigenvectors</span></span>
<span id="cb83-4"><a href="chapter8.html#cb83-4"></a>a1&lt;-<span class="st"> </span><span class="op">-</span>lda_footballHeads<span class="op">$</span>scaling[,<span class="dv">1</span>]</span>
<span id="cb83-5"><a href="chapter8.html#cb83-5"></a><span class="kw">print</span>(<span class="st">&quot;a1&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;a1&quot;</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="chapter8.html#cb85-1"></a><span class="kw">print</span>(a1)</span></code></pre></div>
<pre><code>##         wdim       circum        fbeye        eyehd        earhd          jaw 
## -0.948423100  0.003639865  0.006439599  0.647483088  0.504360916  0.828535064</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="chapter8.html#cb87-1"></a>a2&lt;-<span class="st"> </span><span class="op">-</span>lda_footballHeads<span class="op">$</span>scaling[,<span class="dv">2</span>]</span>
<span id="cb87-2"><a href="chapter8.html#cb87-2"></a><span class="kw">print</span>(<span class="st">&quot;a2&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;a2&quot;</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="chapter8.html#cb89-1"></a><span class="kw">print</span>(a2)</span></code></pre></div>
<pre><code>##          wdim        circum         fbeye         eyehd         earhd 
## -1.4067750094  0.0005126312  0.0286176430 -0.5402700415  0.3839132257 
##           jaw 
##  1.5288556226</code></pre>
<p>using the square roots of the digonal elements of Spl</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="chapter8.html#cb91-1"></a>a1_star &lt;-<span class="st"> </span>a1<span class="op">*</span>diag_sqrt_spl</span>
<span id="cb91-2"><a href="chapter8.html#cb91-2"></a>a1_star</span></code></pre></div>
<pre><code>##         wdim       circum        fbeye        eyehd        earhd          jaw 
## -0.620641211  0.006471484  0.004758091  0.718812156  0.396511561  0.507721826</code></pre>
<p>Thus the fourth, first, sixth and fifth variables contribute de most to separating the groups, in that order. The second and thrid variables are not useful (in the presence of the others) in distinguishing groups.</p>
<p>sorting the vector:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="chapter8.html#cb93-1"></a><span class="kw">sort</span>(a1_star, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>##        eyehd          jaw        earhd       circum        fbeye         wdim 
##  0.718812156  0.507721826  0.396511561  0.006471484  0.004758091 -0.620641211</code></pre>
<p><span class="math display">\[a_1^*=\begin{pmatrix}
0.620641211 \\
-0.006471485\\
-0.004758091\\
-0.718812156\\
-0.396511562\\
-0.507721826
\end{pmatrix}\]</span></p>
</div>
</div>
<div id="test-of-significance" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Test of Significance</h2>
<div id="example-8.6.2" class="section level3" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> Example 8.6.2</h3>
<p>We test the significance of the two discriminant functions obtained in Example <span class="math inline">\(8.4.1.\)</span> for the football data. For the overall test we have, by <span class="math inline">\(8.18\)</span>.</p>
<p>Again, the associated eigenvalues are:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="chapter8.html#cb95-1"></a><span class="co"># compute H</span></span>
<span id="cb95-2"><a href="chapter8.html#cb95-2"></a>H_mat &lt;-<span class="st"> </span><span class="kw">cal_H_mat</span>(footballHeads, <span class="st">&quot;group&quot;</span>)</span></code></pre></div>
<pre><code>##         [,1]   [,2]   [,3]    [,4]   [,5]   [,6]
## [1,]   2.184 -7.254 -1.806 -13.302 -6.330 -2.736
## [2,]  -7.254 39.546  8.385  75.114 32.994 10.101
## [3,]  -1.806  8.385  1.863  15.777  7.083  2.418
## [4,] -13.302 75.114 15.777 142.938 62.514 18.693
## [5,]  -6.330 32.994  7.083  62.514 27.618  8.715
## [6,]  -2.736 10.101  2.418  18.693  8.715  3.495</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="chapter8.html#cb97-1"></a><span class="co">#print(&quot;H matrix&quot;)</span></span>
<span id="cb97-2"><a href="chapter8.html#cb97-2"></a><span class="co">#print(H_mat)</span></span>
<span id="cb97-3"><a href="chapter8.html#cb97-3"></a><span class="co"># compute E</span></span>
<span id="cb97-4"><a href="chapter8.html#cb97-4"></a>E_mat &lt;-<span class="st"> </span><span class="kw">cal_E_mat</span>(footballHeads, <span class="st">&quot;group&quot;</span>)</span>
<span id="cb97-5"><a href="chapter8.html#cb97-5"></a><span class="co">#print(E_mat)</span></span>
<span id="cb97-6"><a href="chapter8.html#cb97-6"></a><span class="co">#print(&quot;E matrix&quot;)</span></span>
<span id="cb97-7"><a href="chapter8.html#cb97-7"></a><span class="co"># eigenvalues</span></span>
<span id="cb97-8"><a href="chapter8.html#cb97-8"></a>eig_values &lt;-<span class="st"> </span><span class="kw">calc_lambdas</span>(E_mat, H_mat)</span>
<span id="cb97-9"><a href="chapter8.html#cb97-9"></a><span class="kw">print</span>(<span class="st">&quot;eigenvalues&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;eigenvalues&quot;</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="chapter8.html#cb99-1"></a><span class="kw">print</span>(<span class="kw">round</span>(eig_values))</span></code></pre></div>
<pre><code>## [1] 2+0i 0+0i 0+0i 0+0i 0+0i 0+0i</code></pre>
<p>Then, we compute <span class="math inline">\(\Lambda_{1}\)</span> just using 1.919 and 0.116:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="chapter8.html#cb101-1"></a>calc_Lambda1 &lt;-<span class="st"> </span><span class="cf">function</span>(eigenvalues){</span>
<span id="cb101-2"><a href="chapter8.html#cb101-2"></a>  Lambda &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb101-3"><a href="chapter8.html#cb101-3"></a>  count =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb101-4"><a href="chapter8.html#cb101-4"></a>  <span class="cf">for</span> (i <span class="cf">in</span> eigenvalues){</span>
<span id="cb101-5"><a href="chapter8.html#cb101-5"></a>    <span class="cf">if</span>(i <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb101-6"><a href="chapter8.html#cb101-6"></a>      Lambda[count] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>i)</span>
<span id="cb101-7"><a href="chapter8.html#cb101-7"></a>    } <span class="cf">else</span>{</span>
<span id="cb101-8"><a href="chapter8.html#cb101-8"></a>      Lambda[count] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb101-9"><a href="chapter8.html#cb101-9"></a>    }</span>
<span id="cb101-10"><a href="chapter8.html#cb101-10"></a>  count =<span class="st"> </span>count <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb101-11"><a href="chapter8.html#cb101-11"></a>  }</span>
<span id="cb101-12"><a href="chapter8.html#cb101-12"></a>  Lambda1 &lt;-<span class="st"> </span><span class="kw">prod</span>(Lambda)</span>
<span id="cb101-13"><a href="chapter8.html#cb101-13"></a>  <span class="kw">as.numeric</span>(Lambda1)</span>
<span id="cb101-14"><a href="chapter8.html#cb101-14"></a>}</span></code></pre></div>
<p>calculate <span class="math inline">\(\Lambda_{1}\)</span>:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="chapter8.html#cb102-1"></a>Lambda1 &lt;-<span class="st"> </span><span class="kw">calc_Lambda1</span>(eig_values)</span>
<span id="cb102-2"><a href="chapter8.html#cb102-2"></a>Lambda1</span></code></pre></div>
<pre><code>## [1] 0.3069741</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="chapter8.html#cb104-1"></a>calc_Lambda2 &lt;-<span class="st"> </span><span class="cf">function</span>(eigenvalues){</span>
<span id="cb104-2"><a href="chapter8.html#cb104-2"></a>  Lambda &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb104-3"><a href="chapter8.html#cb104-3"></a>  count =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb104-4"><a href="chapter8.html#cb104-4"></a>  <span class="cf">for</span> (i <span class="cf">in</span> eigenvalues){</span>
<span id="cb104-5"><a href="chapter8.html#cb104-5"></a>    <span class="cf">if</span>(i <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb104-6"><a href="chapter8.html#cb104-6"></a>      Lambda[count] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>i)</span>
<span id="cb104-7"><a href="chapter8.html#cb104-7"></a>    } <span class="cf">else</span>{</span>
<span id="cb104-8"><a href="chapter8.html#cb104-8"></a>      Lambda[count] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb104-9"><a href="chapter8.html#cb104-9"></a>    }</span>
<span id="cb104-10"><a href="chapter8.html#cb104-10"></a>  count =<span class="st"> </span>count <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb104-11"><a href="chapter8.html#cb104-11"></a>  }</span>
<span id="cb104-12"><a href="chapter8.html#cb104-12"></a>  Lambda2 &lt;-<span class="st"> </span><span class="kw">prod</span>(Lambda[<span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(eig_values)])</span>
<span id="cb104-13"><a href="chapter8.html#cb104-13"></a>  <span class="kw">as.numeric</span>(Lambda2)</span>
<span id="cb104-14"><a href="chapter8.html#cb104-14"></a>}</span></code></pre></div>
<p>calculate <span class="math inline">\(\Lambda_{2}\)</span>:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="chapter8.html#cb105-1"></a>Lambda2 &lt;-<span class="st"> </span><span class="kw">calc_Lambda2</span>(eig_values)</span>
<span id="cb105-2"><a href="chapter8.html#cb105-2"></a>Lambda2</span></code></pre></div>
<pre><code>## [1] 0.8960573</code></pre>
<p>Computing the <span class="math inline">\(\chi^2\)</span> approximation:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="chapter8.html#cb107-1"></a>lambda1_tst &lt;-<span class="st"> </span><span class="cf">function</span>(nvars, ngroups, nrows, Lambda1, <span class="dt">alpha=</span><span class="fl">0.99</span>){</span>
<span id="cb107-2"><a href="chapter8.html#cb107-2"></a>  <span class="st">&quot;</span></span>
<span id="cb107-3"><a href="chapter8.html#cb107-3"></a><span class="st">  nvars: number of variables (p)</span></span>
<span id="cb107-4"><a href="chapter8.html#cb107-4"></a><span class="st">  ngroups: number of groups (k)</span></span>
<span id="cb107-5"><a href="chapter8.html#cb107-5"></a><span class="st">  nrows: number of rows (N)</span></span>
<span id="cb107-6"><a href="chapter8.html#cb107-6"></a><span class="st">  Lambda1: lambda1 statistc</span></span>
<span id="cb107-7"><a href="chapter8.html#cb107-7"></a><span class="st">  alpha: significance level</span></span>
<span id="cb107-8"><a href="chapter8.html#cb107-8"></a><span class="st">  &quot;</span></span>
<span id="cb107-9"><a href="chapter8.html#cb107-9"></a>  p &lt;-<span class="st"> </span>nvars</span>
<span id="cb107-10"><a href="chapter8.html#cb107-10"></a>  k &lt;-<span class="st"> </span>ngroups</span>
<span id="cb107-11"><a href="chapter8.html#cb107-11"></a>  N &lt;-<span class="st"> </span>nrows</span>
<span id="cb107-12"><a href="chapter8.html#cb107-12"></a>  V1 &lt;-<span class="st"> </span><span class="op">-</span>(N <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(p<span class="op">+</span>k))<span class="op">*</span><span class="kw">log</span>(Lambda1)</span>
<span id="cb107-13"><a href="chapter8.html#cb107-13"></a>  </span>
<span id="cb107-14"><a href="chapter8.html#cb107-14"></a>  <span class="co">#lambda1 is distribute as wilk-statitstic with (p-m)(k-m) degrees of freedom (where m=1 for Lambda1)</span></span>
<span id="cb107-15"><a href="chapter8.html#cb107-15"></a>  </span>
<span id="cb107-16"><a href="chapter8.html#cb107-16"></a>  <span class="co"># we can use the cbhi2 approx with p(k-1) df.</span></span>
<span id="cb107-17"><a href="chapter8.html#cb107-17"></a>  critical_valuechi &lt;-<span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>p<span class="op">*</span>(k<span class="dv">-1</span>)) </span>
<span id="cb107-18"><a href="chapter8.html#cb107-18"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;critical value of chi2 with &quot;</span>, p<span class="op">*</span>(k<span class="dv">-1</span>), <span class="st">&quot; degrees of freedom: &quot;</span>, critical_valuechi))</span>
<span id="cb107-19"><a href="chapter8.html#cb107-19"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Value of V1: &quot;</span>, V1))</span>
<span id="cb107-20"><a href="chapter8.html#cb107-20"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Reject the null hipothesis H0?:&quot;</span>, V1 <span class="op">&gt;</span><span class="st"> </span>critical_valuechi))</span>
<span id="cb107-21"><a href="chapter8.html#cb107-21"></a>  </span>
<span id="cb107-22"><a href="chapter8.html#cb107-22"></a>  <span class="kw">print</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb107-23"><a href="chapter8.html#cb107-23"></a>  <span class="kw">print</span>(<span class="st">&quot;*****F approximation&quot;</span>)</span>
<span id="cb107-24"><a href="chapter8.html#cb107-24"></a>  num_t &lt;-<span class="st"> </span>(p)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">^</span>(<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="dv">4</span></span>
<span id="cb107-25"><a href="chapter8.html#cb107-25"></a>  den_t &lt;-<span class="st"> </span>(p)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(k<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">5</span></span>
<span id="cb107-26"><a href="chapter8.html#cb107-26"></a>  t &lt;-<span class="st"> </span><span class="kw">sqrt</span>(num_t<span class="op">/</span>den_t)</span>
<span id="cb107-27"><a href="chapter8.html#cb107-27"></a>  w &lt;-<span class="st"> </span>N <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(p<span class="op">+</span>k)</span>
<span id="cb107-28"><a href="chapter8.html#cb107-28"></a>  df1 &lt;-<span class="st"> </span>(p)<span class="op">*</span>(k<span class="dv">-1</span>)</span>
<span id="cb107-29"><a href="chapter8.html#cb107-29"></a>  df2 &lt;-<span class="st"> </span>w<span class="op">*</span>t <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>((p)<span class="op">*</span>(k<span class="dv">-1</span>) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb107-30"><a href="chapter8.html#cb107-30"></a>  num_F &lt;-<span class="st"> </span>(df2<span class="op">/</span>df1)<span class="op">*</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>Lambda1<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>t))</span>
<span id="cb107-31"><a href="chapter8.html#cb107-31"></a>  den_F &lt;-<span class="st"> </span>(Lambda1<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>t))</span>
<span id="cb107-32"><a href="chapter8.html#cb107-32"></a>  F_stat &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(num_F<span class="op">/</span>den_F)</span>
<span id="cb107-33"><a href="chapter8.html#cb107-33"></a>  </span>
<span id="cb107-34"><a href="chapter8.html#cb107-34"></a>  critical_valueF &lt;-<span class="st"> </span><span class="kw">qf</span>(alpha, df1, df2) </span>
<span id="cb107-35"><a href="chapter8.html#cb107-35"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;critical value of F with vE&quot;</span>, N<span class="op">-</span>k, <span class="st">&quot; and vH: &quot;</span>, (k<span class="dv">-1</span>), <span class="st">&quot;:&quot;</span>, critical_valueF))</span>
<span id="cb107-36"><a href="chapter8.html#cb107-36"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Value of F: &quot;</span>, F_stat))</span>
<span id="cb107-37"><a href="chapter8.html#cb107-37"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;P-value: &quot;</span>, <span class="kw">pf</span>(F_stat, df1, df2, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb107-38"><a href="chapter8.html#cb107-38"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Reject the null hipothesis H0?:&quot;</span>, F_stat <span class="op">&gt;</span><span class="st"> </span>critical_valueF))</span>
<span id="cb107-39"><a href="chapter8.html#cb107-39"></a>  </span>
<span id="cb107-40"><a href="chapter8.html#cb107-40"></a>  </span>
<span id="cb107-41"><a href="chapter8.html#cb107-41"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="chapter8.html#cb108-1"></a>Lambda1 &lt;-<span class="st"> </span><span class="kw">calc_Lambda1</span>(eig_values)</span>
<span id="cb108-2"><a href="chapter8.html#cb108-2"></a>nvars &lt;-<span class="st"> </span><span class="kw">ncol</span>(footballHeads)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb108-3"><a href="chapter8.html#cb108-3"></a>nrows &lt;-<span class="st"> </span><span class="kw">nrow</span>(footballHeads)</span>
<span id="cb108-4"><a href="chapter8.html#cb108-4"></a>ngroups &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(footballHeads<span class="op">$</span>group))</span>
<span id="cb108-5"><a href="chapter8.html#cb108-5"></a></span>
<span id="cb108-6"><a href="chapter8.html#cb108-6"></a></span>
<span id="cb108-7"><a href="chapter8.html#cb108-7"></a><span class="kw">lambda1_tst</span>(nvars, ngroups, nrows, Lambda1, <span class="dt">alpha=</span><span class="fl">0.99</span>)</span></code></pre></div>
<pre><code>## [1] &quot;critical value of chi2 with  12  degrees of freedom:  26.2169673055358&quot;
## [1] &quot;Value of V1:  99.7938202677277&quot;
## [1] &quot;Reject the null hipothesis H0?: TRUE&quot;
## [1] &quot;&quot;
## [1] &quot;*****F approximation&quot;
## [1] &quot;critical value of F with vE 87  and vH:  2 : 2.29485384504251&quot;
## [1] &quot;Value of F:  11.0000728016944&quot;
## [1] &quot;P-value:  6.58284166213314e-16&quot;
## [1] &quot;Reject the null hipothesis H0?: TRUE&quot;</code></pre>
<p>Testing the second discriminant function using a general function. We can replace m by 2 which is the default value.</p>
<p>Define a general function for Lambda m</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="chapter8.html#cb110-1"></a>calc_Lambdam &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">m=</span><span class="dv">2</span>, eigenvalues){</span>
<span id="cb110-2"><a href="chapter8.html#cb110-2"></a>  Lambda &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb110-3"><a href="chapter8.html#cb110-3"></a>  count =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb110-4"><a href="chapter8.html#cb110-4"></a>  <span class="cf">for</span> (i <span class="cf">in</span> eigenvalues){</span>
<span id="cb110-5"><a href="chapter8.html#cb110-5"></a>    <span class="cf">if</span>(i <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>){</span>
<span id="cb110-6"><a href="chapter8.html#cb110-6"></a>      Lambda[count] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>i)</span>
<span id="cb110-7"><a href="chapter8.html#cb110-7"></a>    } <span class="cf">else</span>{</span>
<span id="cb110-8"><a href="chapter8.html#cb110-8"></a>      Lambda[count] &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb110-9"><a href="chapter8.html#cb110-9"></a>    }</span>
<span id="cb110-10"><a href="chapter8.html#cb110-10"></a>  count =<span class="st"> </span>count <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb110-11"><a href="chapter8.html#cb110-11"></a>  }</span>
<span id="cb110-12"><a href="chapter8.html#cb110-12"></a>  Lambdam &lt;-<span class="st"> </span><span class="kw">prod</span>(Lambda[m<span class="op">:</span><span class="kw">length</span>(eig_values)])</span>
<span id="cb110-13"><a href="chapter8.html#cb110-13"></a>  <span class="kw">as.numeric</span>(Lambdam)</span>
<span id="cb110-14"><a href="chapter8.html#cb110-14"></a>}</span></code></pre></div>
<p>Testing the function:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="chapter8.html#cb111-1"></a>eig_values &lt;-<span class="st"> </span><span class="kw">calc_lambdas</span>(E_mat, H_mat)</span>
<span id="cb111-2"><a href="chapter8.html#cb111-2"></a><span class="co">#eig_values</span></span>
<span id="cb111-3"><a href="chapter8.html#cb111-3"></a></span>
<span id="cb111-4"><a href="chapter8.html#cb111-4"></a>Lambda2 &lt;-<span class="st"> </span><span class="kw">calc_Lambdam</span>(<span class="dt">m=</span><span class="dv">2</span>, eig_values)</span>
<span id="cb111-5"><a href="chapter8.html#cb111-5"></a>Lambda2</span></code></pre></div>
<pre><code>## [1] 0.8960573</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="chapter8.html#cb113-1"></a>lambdam_tst &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">m=</span><span class="dv">2</span>, nvars, ngroups, nrows, Lambdam, <span class="dt">alpha=</span><span class="fl">0.99</span>){</span>
<span id="cb113-2"><a href="chapter8.html#cb113-2"></a>  <span class="st">&quot;</span></span>
<span id="cb113-3"><a href="chapter8.html#cb113-3"></a><span class="st">  m: # discriminant </span></span>
<span id="cb113-4"><a href="chapter8.html#cb113-4"></a><span class="st">  nvars: number of variables (p)</span></span>
<span id="cb113-5"><a href="chapter8.html#cb113-5"></a><span class="st">  ngroups: number of groups (k)</span></span>
<span id="cb113-6"><a href="chapter8.html#cb113-6"></a><span class="st">  nrows: number of rows (N)</span></span>
<span id="cb113-7"><a href="chapter8.html#cb113-7"></a><span class="st">  Lambdam: lambdam statistc</span></span>
<span id="cb113-8"><a href="chapter8.html#cb113-8"></a><span class="st">  alpha: significance level</span></span>
<span id="cb113-9"><a href="chapter8.html#cb113-9"></a><span class="st">  &quot;</span></span>
<span id="cb113-10"><a href="chapter8.html#cb113-10"></a>  p &lt;-<span class="st"> </span>nvars</span>
<span id="cb113-11"><a href="chapter8.html#cb113-11"></a>  k &lt;-<span class="st"> </span>ngroups</span>
<span id="cb113-12"><a href="chapter8.html#cb113-12"></a>  N &lt;-<span class="st"> </span>nrows</span>
<span id="cb113-13"><a href="chapter8.html#cb113-13"></a>  Vm &lt;-<span class="st"> </span><span class="op">-</span>(N <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(p<span class="op">+</span>k))<span class="op">*</span><span class="kw">log</span>(Lambdam)</span>
<span id="cb113-14"><a href="chapter8.html#cb113-14"></a>  </span>
<span id="cb113-15"><a href="chapter8.html#cb113-15"></a>  <span class="co"># lambdam is distribute as wilk-statitstic with (p-m+1)*(k-m) degrees of freedom </span></span>
<span id="cb113-16"><a href="chapter8.html#cb113-16"></a>  </span>
<span id="cb113-17"><a href="chapter8.html#cb113-17"></a>  <span class="co"># we can use the cbhi2 approx with p(k-1) df.</span></span>
<span id="cb113-18"><a href="chapter8.html#cb113-18"></a>  <span class="kw">print</span>(<span class="st">&quot;*****Chi2 approximation&quot;</span>)</span>
<span id="cb113-19"><a href="chapter8.html#cb113-19"></a>  critical_value &lt;-<span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>(p<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(k<span class="op">-</span>m))</span>
<span id="cb113-20"><a href="chapter8.html#cb113-20"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;critical value of chi2 with &quot;</span>, (p<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(k<span class="op">-</span>m), <span class="st">&quot; degrees of freedom: &quot;</span>, critical_value))</span>
<span id="cb113-21"><a href="chapter8.html#cb113-21"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Value of Vm: &quot;</span>, Vm))</span>
<span id="cb113-22"><a href="chapter8.html#cb113-22"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;reject the null hipothesis H0:&quot;</span>, Vm <span class="op">&gt;</span><span class="st"> </span>critical_value))</span>
<span id="cb113-23"><a href="chapter8.html#cb113-23"></a>  </span>
<span id="cb113-24"><a href="chapter8.html#cb113-24"></a>  </span>
<span id="cb113-25"><a href="chapter8.html#cb113-25"></a>  <span class="kw">print</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb113-26"><a href="chapter8.html#cb113-26"></a>  <span class="kw">print</span>(<span class="st">&quot;*****F approximation&quot;</span>)</span>
<span id="cb113-27"><a href="chapter8.html#cb113-27"></a>  num_t &lt;-<span class="st"> </span>(p<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="op">-</span>m)<span class="op">^</span>(<span class="dv">2</span>) <span class="op">-</span><span class="st"> </span><span class="dv">4</span></span>
<span id="cb113-28"><a href="chapter8.html#cb113-28"></a>  den_t &lt;-<span class="st"> </span>(p<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>(k<span class="op">-</span>m)<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">5</span></span>
<span id="cb113-29"><a href="chapter8.html#cb113-29"></a>  t &lt;-<span class="st"> </span><span class="kw">sqrt</span>(num_t<span class="op">/</span>den_t)</span>
<span id="cb113-30"><a href="chapter8.html#cb113-30"></a>  w &lt;-<span class="st"> </span>N <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(p<span class="op">+</span>k)</span>
<span id="cb113-31"><a href="chapter8.html#cb113-31"></a>  df1 &lt;-<span class="st"> </span>(p<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(k<span class="op">-</span>m)</span>
<span id="cb113-32"><a href="chapter8.html#cb113-32"></a>  df2 &lt;-<span class="st"> </span>w<span class="op">*</span>t <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>((p<span class="op">-</span>m<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(k<span class="op">-</span>m) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb113-33"><a href="chapter8.html#cb113-33"></a>  num_F &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>Lambdam<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>t))<span class="op">*</span>df2</span>
<span id="cb113-34"><a href="chapter8.html#cb113-34"></a>  den_F &lt;-<span class="st"> </span>(Lambdam<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>t))<span class="op">*</span>df1</span>
<span id="cb113-35"><a href="chapter8.html#cb113-35"></a>  F_stat &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(num_F<span class="op">/</span>den_F)</span>
<span id="cb113-36"><a href="chapter8.html#cb113-36"></a></span>
<span id="cb113-37"><a href="chapter8.html#cb113-37"></a>  critical_valueF &lt;-<span class="st"> </span><span class="kw">qf</span>(alpha, df1, df2) </span>
<span id="cb113-38"><a href="chapter8.html#cb113-38"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;critical value of F with vE&quot;</span>, N<span class="op">-</span>k, <span class="st">&quot; and vH: &quot;</span>, (k<span class="dv">-1</span>), <span class="st">&quot;:&quot;</span>, critical_valueF))</span>
<span id="cb113-39"><a href="chapter8.html#cb113-39"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Value of F: &quot;</span>, F_stat))</span>
<span id="cb113-40"><a href="chapter8.html#cb113-40"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;P-value: &quot;</span>, <span class="kw">pf</span>(F_stat, df1, df2, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)))</span>
<span id="cb113-41"><a href="chapter8.html#cb113-41"></a>  <span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;Reject the null hipothesis H0?:&quot;</span>, F_stat <span class="op">&gt;</span><span class="st"> </span>critical_valueF))</span>
<span id="cb113-42"><a href="chapter8.html#cb113-42"></a>  </span>
<span id="cb113-43"><a href="chapter8.html#cb113-43"></a>  </span>
<span id="cb113-44"><a href="chapter8.html#cb113-44"></a>}</span></code></pre></div>
<p>Test for Lambda 2</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="chapter8.html#cb114-1"></a>Lambda2 &lt;-<span class="st"> </span><span class="kw">calc_Lambdam</span>(<span class="dt">m=</span><span class="dv">2</span>, eig_values)</span>
<span id="cb114-2"><a href="chapter8.html#cb114-2"></a>nvars &lt;-<span class="st"> </span><span class="kw">ncol</span>(footballHeads)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb114-3"><a href="chapter8.html#cb114-3"></a>nrows &lt;-<span class="st"> </span><span class="kw">nrow</span>(footballHeads)</span>
<span id="cb114-4"><a href="chapter8.html#cb114-4"></a>ngroups &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(footballHeads<span class="op">$</span>group))</span>
<span id="cb114-5"><a href="chapter8.html#cb114-5"></a>m &lt;-<span class="st"> </span><span class="dv">2</span> <span class="co"># second discriminant</span></span>
<span id="cb114-6"><a href="chapter8.html#cb114-6"></a><span class="kw">lambdam_tst</span>(<span class="dt">m=</span><span class="dv">2</span>, nvars, ngroups, nrows, Lambda2, <span class="dt">alpha=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## [1] &quot;*****Chi2 approximation&quot;
## [1] &quot;critical value of chi2 with  5  degrees of freedom:  11.0704976935164&quot;
## [1] &quot;Value of Vm:  9.27394800454559&quot;
## [1] &quot;reject the null hipothesis H0: FALSE&quot;
## [1] &quot;&quot;
## [1] &quot;*****F approximation&quot;
## [1] &quot;critical value of F with vE 87  and vH:  2 : 2.32447320379092&quot;
## [1] &quot;Value of F:  1.9256&quot;
## [1] &quot;P-value:  0.0987198325042634&quot;
## [1] &quot;Reject the null hipothesis H0?: FALSE&quot;</code></pre>
</div>
</div>
<div id="interpretation-of-discriminant-functions" class="section level2" number="8.7">
<h2><span class="header-section-number">8.7</span> Interpretation of Discriminant Functions</h2>
</div>
<div id="scatter-plots" class="section level2" number="8.8">
<h2><span class="header-section-number">8.8</span> Scatter Plots</h2>
<div id="example-8.8." class="section level3" number="8.8.1">
<h3><span class="header-section-number">8.8.1</span> Example 8.8.</h3>
</div>
</div>
<div id="stepwise-selection-of-variables" class="section level2" number="8.9">
<h2><span class="header-section-number">8.9</span> Stepwise Selection of Variables</h2>
<div id="example-8.9." class="section level3" number="8.9.1">
<h3><span class="header-section-number">8.9.1</span> Example 8.9.</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter9.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/C1587S/EMV-ejercicios/edit/master/07-chapter8.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["multivariate-statistics-R-code.pdf", "multivariate-statistics-R-code.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
